<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>VBScript to Rule IE</title><meta name="description" content="SANS have published a report on VBScript malware and related things. The report was mentioned  on ha.ckers.org which was followed by a small discussion on various ways of injecting VBScript, executing statements, etc."><meta property="name" content="VBScript to Rule IE"><meta itemprop="name" content="VBScript to Rule IE"><meta property="description" content="SANS have published a report on VBScript malware and related things. The report was mentioned  on ha.ckers.org which was followed by a small discussion on various ways of injecting VBScript, executing statements, etc."><meta itemprop="description" content="SANS have published a report on VBScript malware and related things. The report was mentioned  on ha.ckers.org which was followed by a small discussion on various ways of injecting VBScript, executing statements, etc."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fvbscript-to-rule-ie%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fvbscript-to-rule-ie%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/vbscript-to-rule-ie/"><meta property="og:title" content="VBScript to Rule IE"><meta property="og:description" content="SANS have published a report on VBScript malware and related things. The report was mentioned  on ha.ckers.org which was followed by a small discussion on various ways of injecting VBScript, executing statements, etc."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fvbscript-to-rule-ie%2F?w=1024"><meta name="twitter:title" content="VBScript to Rule IE"><meta name="twitter:description" content="SANS have published a report on VBScript malware and related things. The report was mentioned  on ha.ckers.org which was followed by a small discussion on various ways of injecting VBScript, executing statements, etc."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fvbscript-to-rule-ie%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">VBScript to Rule IE</h1><div class="date">Fri, 16 Mar 2007 10:36:09 GMT</div><div class="author">by
<a href="/members/pdp.html">pdp</a></div><div id="post-content"><p>SANS have published a <a href="http://isc.sans.org/diary.html?storyid=2397">report</a> on VBScript malware and related things. The report was <a href="http://ha.ckers.org/blog/20070315/javascript-xss-is-conduit-for-viruses/">mentioned</a>  on ha.ckers.org which was followed by a small <a href="http://ha.ckers.org/blog/20070315/javascript-xss-is-conduit-for-viruses/#comments">discussion</a> on various ways of injecting VBScript, executing statements, etc.</p>
<p>Most of you probably know what VBScript is. For sure, it is not the most popular option among web application developers because it works on Internet Explorer only. However, it is perhaps the perfect solution for injecting malicious code (XSS) inside dynamically generated web pages via a server side script or DOM. I have used VBScript in the past, and I must say that although some web applications successfully sanitize JavaScript they fail to do the same with VBScript. &quot;Internet Explorer is still the most popular browser in the world.&quot;</p>
<p>If you haven&#39;t played with VBScript in the past, expect to see a language which is quite similar to Ruby. It is lite and easy to use. One particular difference between VBScript and JavaScript is that the later terminates each statement with semicolon. VBScript cannot do that, which means that in theory you shouldn&#39;t be able to make one-liners like in JavaScript. That&#39;s not true.</p>
<p>In a few simple steps you can put several lines of VBScript code in a single line. For example, use the following URL in your Internet Explorer two show two <code>alert</code> boxes (<code>MsgBox</code> in VBScript).</p>
<pre><code class="language-visualbasic">[vbscript:Execute(chr(77) &amp; chr(115) &amp; chr(103) &amp; chr(66) &amp; chr(111) &amp; chr(120) &amp; chr(40) &amp; chr(34) &amp; chr(66) &amp; chr(108) &amp; chr(97) &amp; chr(34) &amp; chr(41) &amp; chr(13) &amp; chr(10) &amp; chr(77) &amp; chr(115) &amp; chr(103) &amp; chr(66) &amp; chr(111) &amp; chr(120) &amp; chr(40) &amp; chr(34) &amp; chr(66) &amp; chr(108) &amp; chr(97) &amp; chr(34) &amp; chr(41))](vbscript:Execute(chr(77) &amp; chr(115) &amp; chr(103) &amp; chr(66) &amp; chr(111) &amp; chr(120) &amp; chr(40) &amp; chr(34) &amp; chr(66) &amp; chr(108) &amp; chr(97) &amp; chr(34) &amp; chr(41) &amp; chr(13) &amp; chr(10) &amp; chr(77) &amp; chr(115) &amp; chr(103) &amp; chr(66) &amp; chr(111) &amp; chr(120) &amp; chr(40) &amp; chr(34) &amp; chr(66) &amp; chr(108) &amp; chr(97) &amp; chr(34) &amp; chr(41)))</code></pre>
<p>This is probably the safest way to do this although with the help of some URL encoding magic you can achieve similar result. Notice that each line is connected with <code>chr(13) &amp; chr(10)</code>, which is the familiar LF CR sequence.</p>
<blockquote>
<p>You cannot execute VBScript on <strong>about:blank</strong> in Internet Explorer 7. To test the expression, go to some random page and then place the code in your address bar.</p>
</blockquote>
<p>Very often, web applications sanitize URLs that start with the keyword <code>javascript:</code> and leaves everything else. If you use the <code>vbscript:</code> protocol you can bypass this restriction, which creates a XSS exploitable condition. This is one type of scenario and be sure that you can do a lot more then that. VBScript has access to DOM as well. For example, you can access <strong>Document.cookie</strong> and <strong>Document.location</strong>. You can do XML HTTP requests and do almost everything you can think of.</p>
<blockquote>
<p>Long story short, it is important to know about VBScript and its capabilities because as long Internet Explorer supports it and you are planning to support Internet Explorer, you have to deal with it. Do not implement black listing XSS filters. They can all be bypassed with a few tricks. All I want to say is that VBSript is here to stay and it will be widely used to bypass secure XSS filters. Be aware of it, and be prepared.</p>
</blockquote>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ff7d0cd31f3e8a78777398ee3e6394b5?s=256&amp;d=retro" alt="Aviv"><span class="post-comment-author">Aviv</span><div class="post-comment-content">The equivalent for the javascript's semicolon (;) in vbscript is a colon (:).
Even though I wasn't able to use it directly in the address bar (at-least on my Vista's IE7), it worked in the Execute statement instead of the CrLf chars.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">cool, I didn't know about that. thanks.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5e0f595cbc8f1811233adce10ac6c5d3?s=256&amp;d=retro" alt="Awesome AnDrEw"><span class="post-comment-author">Awesome AnDrEw</span><div class="post-comment-content">I've been utilizing VBScript since 2001 knowing full well it only renders in Internet Explorer, which as pointed out in the above article is still the most popular browser. Another thing to be noted about VBScript is its case insensitivity when it comes to statements. What sucks about VBScript though is that all variables remain variants (I believe they remain that way even after appending them with an abbreviation such as "$" for strings, "%" for integers, and so forth) even with Option Explicit (which forces you to declare variables).</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Awesome, you know what people say about VBScript and in particular VBasic: once you learn it you programming mindset will be crippled for life. That, of course, is a joke. :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/f912d9140c6c3a05c195adfa1824096b?s=256&amp;d=retro" alt="Dnupter"><span class="post-comment-author">Dnupter</span><div class="post-comment-content">it is so cool. i just want to know more</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2022 <a href=""></a>. All rights reserved.</p></footer></body></html>