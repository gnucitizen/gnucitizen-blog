<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>New Technique To Perform Universal Website Hijacking</title><meta name="description" content="I'm really excited that HITBSecConf2008 Malaysia is coming up soon: end of October to be precise. I highly recommend our readers to attend such event, as it's organized by one of the finest security event crews I have ever dealt with. There are tons of talks I want to attend, which I will cover in another post. The GNUCITIZEN team would like to thank the Hack in the Box (HITB) staff for inviting us to the Malaysia edition of the conference, making this the second time pdp and I will speak at HITBSecConf. The HITBSecConf crew includes Dhillon, geek00l, spoonfork, Belinda, Prabu, ruFI0 and Amy among others. Thank you guys, we're really humbled by your invitation."><meta property="name" content="New Technique To Perform Universal Website Hijacking"><meta itemprop="name" content="New Technique To Perform Universal Website Hijacking"><meta property="description" content="I'm really excited that HITBSecConf2008 Malaysia is coming up soon: end of October to be precise. I highly recommend our readers to attend such event, as it's organized by one of the finest security event crews I have ever dealt with. There are tons of talks I want to attend, which I will cover in another post. The GNUCITIZEN team would like to thank the Hack in the Box (HITB) staff for inviting us to the Malaysia edition of the conference, making this the second time pdp and I will speak at HITBSecConf. The HITBSecConf crew includes Dhillon, geek00l, spoonfork, Belinda, Prabu, ruFI0 and Amy among others. Thank you guys, we're really humbled by your invitation."><meta itemprop="description" content="I'm really excited that HITBSecConf2008 Malaysia is coming up soon: end of October to be precise. I highly recommend our readers to attend such event, as it's organized by one of the finest security event crews I have ever dealt with. There are tons of talks I want to attend, which I will cover in another post. The GNUCITIZEN team would like to thank the Hack in the Box (HITB) staff for inviting us to the Malaysia edition of the conference, making this the second time pdp and I will speak at HITBSecConf. The HITBSecConf crew includes Dhillon, geek00l, spoonfork, Belinda, Prabu, ruFI0 and Amy among others. Thank you guys, we're really humbled by your invitation."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fnew-technique-to-perform-universal-website-hijacking%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fnew-technique-to-perform-universal-website-hijacking%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/new-technique-to-perform-universal-website-hijacking/"><meta property="og:title" content="New Technique To Perform Universal Website Hijacking"><meta property="og:description" content="I'm really excited that HITBSecConf2008 Malaysia is coming up soon: end of October to be precise. I highly recommend our readers to attend such event, as it's organized by one of the finest security event crews I have ever dealt with. There are tons of talks I want to attend, which I will cover in another post. The GNUCITIZEN team would like to thank the Hack in the Box (HITB) staff for inviting us to the Malaysia edition of the conference, making this the second time pdp and I will speak at HITBSecConf. The HITBSecConf crew includes Dhillon, geek00l, spoonfork, Belinda, Prabu, ruFI0 and Amy among others. Thank you guys, we're really humbled by your invitation."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fnew-technique-to-perform-universal-website-hijacking%2F?w=1024"><meta name="twitter:title" content="New Technique To Perform Universal Website Hijacking"><meta name="twitter:description" content="I'm really excited that HITBSecConf2008 Malaysia is coming up soon: end of October to be precise. I highly recommend our readers to attend such event, as it's organized by one of the finest security event crews I have ever dealt with. There are tons of talks I want to attend, which I will cover in another post. The GNUCITIZEN team would like to thank the Hack in the Box (HITB) staff for inviting us to the Malaysia edition of the conference, making this the second time pdp and I will speak at HITBSecConf. The HITBSecConf crew includes Dhillon, geek00l, spoonfork, Belinda, Prabu, ruFI0 and Amy among others. Thank you guys, we're really humbled by your invitation."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fnew-technique-to-perform-universal-website-hijacking%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">New Technique To Perform Universal Website Hijacking</h1><div>Sat, 20 Sep 2008 14:56:05 GMT</div><div id="post-content"><p>I&#39;m really excited that <a href="http://conference.hackinthebox.org/hitbsecconf2008kl/">HITBSecConf2008 Malaysia</a> is coming up soon: end of October to be precise. I highly recommend our readers to attend such event, as it&#39;s organized by one of the finest security event crews I have ever dealt with. There are tons of talks I want to attend, which I will cover in another post. The GNUCITIZEN team would like to thank the Hack in the Box (HITB) staff for inviting us to the Malaysia edition of the conference, making this the second time pdp and I will speak at HITBSecConf. The HITBSecConf crew includes Dhillon, <a href="http://geek00l.blogspot.com/">geek00l</a>, <a href="http://mel.icious.net/">spoonfork</a>, Belinda, Prabu, <a href="http://geeks.serverfreak.biz/rufi0/blog/">ruFI0</a> and Amy among others. Thank you guys, we&#39;re really humbled by your invitation.</p>
<p>I will be delivering the updated version of my <a href="http://conference.hackinthebox.org/hitbsecconf2008kl/?page_id=186">Cracking into Embedded Devices and Beyond!</a> presentation, which will include a quite special - i.e.: unusual - 0day vulnerability which I have successfully reported via <a href="http://www.zerodayinitiative.com/">Zero Day Initiative</a>.</p>
<h2 id="the-0day-vuln">The 0day Vuln</h2>
<p>Well, I cannot give full details on the vulnerability at this moment, due to ZDI&#39;s advisory not being published yet. I&#39;m planning to release the full details for the first time on <a href="http://conference.hackinthebox.org/hitbsecconf2008kl/agenda.htm">30th October</a> at HITBSecConf2008 Malaysia. However, there are a few things I can tell you for the moment being. First of all, the affected system is an embedded device, which is quite obvious by reading the name of my presentation. More precisely, the vulnerability affects appliances of a well-known firewall vendor.</p>
<p>Usually, web cross-domain vulnerabilities, affect either a server-side service/application, or client-side software. For instance, we might have a cross-domain vulnerability on the target site itself (i.e.: XSS/HTML injection), or on a client-side component present on the victim&#39;s user component. i.e.: web browser itself or web browser plugin. In the case of my finding however, the targeted website can still be hijacked even if the site is NOT vulnerable to XSS, and even if the client-side software on the victim&#39;s computer is not vulnerable to any cross-domain vulnerability.</p>
<p>In this case, the attacker exploits a vulnerability which doesn&#39;t affect the targeted website, nor the software installed on the victim user&#39;s computer. Instead, the attacker exploits a vulnerability on the firewall appliance in charge of &quot;protecting&quot; the corporate user. Additionally, the cross-domain vulnerability is of <em>universal</em> nature, which means that any website can be hijacked as long as the victim user&#39;s connection is &quot;protected&quot; by a firewall appliance of the affected vendor in question.</p>
<p>In summary, by exploiting this vulnerability the attacker:</p>
<ul>
<li>can hijack ANY website. i.e.: steal session IDs, inject non-legitimate HTML content, and other evil goodness</li>
<li>doesn&#39;t need to find any XSS on the website he/she wants to hijack</li>
<li>doesn&#39;t need to find any vulnerability on software present on the victim user&#39;s computer</li>
</ul>
<p>There is virtually nothing the victim user can do to protect against this attack if his/her connection is &quot;protected&quot; by a firewall appliance affected by this vulnerability. There are other factors that make this vulnerability quite special, but as I said, I can&#39;t give too many details for now. All in all, this finding is a good reminder that our online security not only depends on end-point systems such as the client and server that have established a connection, but also all the hops/devices in between!</p>
</div><div id="post-comments"><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="N"><span>N</span><div class="post-comment-content">cisco pix?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="randomer"><span>randomer</span><div class="post-comment-content">I bet it's Agnitum Outpost firewall.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="ax0n"><span>ax0n</span><div class="post-comment-content">From a responsible disclosure standpoint, I would much rather have gotten the name of a product family than a list of bad stuff that this vulnerability exposes users to. Now I have to sit around wondering if any of the firewall appliances I've deployed are "the one" and throw extra wide-spectrum effort at the problem despite if I'm actually affected or not.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="NurBo"><span>NurBo</span><div class="post-comment-content">why tell us about something if your not going to share thats like saying heres some new shoes but you can't wear them.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">There will never be a good way of disclosing vulnerabilities! At least we try to give you the heads up that an issue exists. The more inform you are the better decisions you can make.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian 'pagvac' Pastor"><span>Adrian 'pagvac' Pastor</span><div class="post-comment-content">guys, as I said I can't provide full details at this point, even though I would love to! I simply wanted to share what I could regarding the new material which I will present at HITBSecConf Malaysia.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="FilipM"><span>FilipM</span><div class="post-comment-content">@NurBo: At least Adrian is taking the appropriate steps after finding vulnerabilities, instead of abusing (or even selling!) them. 

But I am concerned. If Adrian found this one, who else found the same? And when? Did someone already abused any of my systems? We'll know after HITBSecConf Malaysia...</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian 'pagvac' Pastor"><span>Adrian 'pagvac' Pastor</span><div class="post-comment-content">@FlipM: we shouldn't turn selling a vulnerability into a synonym for irresponsible disclosure. There are several *responsible* vulnerability disclosure programs which pay researchers. ZDI for instance is the one I used, which reported the vulnerability I found to the vendor. Of course, the details will only be available once a fix is released.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="ax0n"><span>ax0n</span><div class="post-comment-content">I'd not think listing the vendor would fall into the realm "irresponsible disclosure" and I understand that disclosure is tricky business, and selling vulnerabilities is NOT always a bad thing. 

I've deployed many different solutions for customers, so there's a good chance I have a client whose dick is hanging in the breeze because of this.  I just don't know which one(s). HITBSecConf is a long ways off. And people wonder why I get 15 hours of sleep per week.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="FilipM"><span>FilipM</span><div class="post-comment-content">You're right, I should have been more clear. I ment selling it to irresponsible groups or individuals who have some bad intentions with it. 

What about my concern? I know it's possibly impossible to answer correct, but if you have to make a guess, what are the chances that this vuln is already found (and abused) by someone else? 
Without revealing the details on howto, is there a way to check if someone has been a victim of the vuln? Or are there no traces at all? 
As you can notice, you post scared the sh*t out of me   :oÞ</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian 'pagvac' Pastor"><span>Adrian 'pagvac' Pastor</span><div class="post-comment-content">Sure there is always a possibility that someone else can find the same vulnerability. I wouldn't be so naive to think I'm the only one who found it. 

However, I must warn you that this vuln is a *weird one*. In fact I discovered it by pure accident. I'm planning to explain what lead me to discover it at HITBSecConf, because it's actually kind of a funny story ;)</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="ax0n"><span>ax0n</span><div class="post-comment-content">I know some of my favorite vuln finds are serendipitous ones. That's always awesome.

On a side note, your finding wouldn't happen to have anything to do with the huge pile of Cisco advisories that went out today, would it?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian 'pagvac' Pastor"><span>Adrian 'pagvac' Pastor</span><div class="post-comment-content">@ax0n: no, my finding is not related with those advisories you mentioned.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="maxdj"><span>maxdj</span><div class="post-comment-content">Hi, Is it by chance related to Web security gateway software (Web filtering), aka Internet content-control ?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian 'pagvac' Pastor"><span>Adrian 'pagvac' Pastor</span><div class="post-comment-content">@maxdj: can't comment on any details yet unfortunately :(</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2019 <a href=""></a>. All rights reserved.</p></footer></body></html>