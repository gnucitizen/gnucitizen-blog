<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>UPnP The Saga Continues</title><meta name="description" content="This post is a quick introduction to some other UPnP related issues. Yes, we have been targeting UPnP in the last couple of weeks mainly because is a big problem many people have forgotten or don't know about."><meta property="name" content="UPnP The Saga Continues"><meta itemprop="name" content="UPnP The Saga Continues"><meta property="description" content="This post is a quick introduction to some other UPnP related issues. Yes, we have been targeting UPnP in the last couple of weeks mainly because is a big problem many people have forgotten or don't know about."><meta itemprop="description" content="This post is a quick introduction to some other UPnP related issues. Yes, we have been targeting UPnP in the last couple of weeks mainly because is a big problem many people have forgotten or don't know about."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fupnp-the-saga-continues%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fupnp-the-saga-continues%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/upnp-the-saga-continues/"><meta property="og:title" content="UPnP The Saga Continues"><meta property="og:description" content="This post is a quick introduction to some other UPnP related issues. Yes, we have been targeting UPnP in the last couple of weeks mainly because is a big problem many people have forgotten or don't know about."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fupnp-the-saga-continues%2F?w=1024"><meta name="twitter:title" content="UPnP The Saga Continues"><meta name="twitter:description" content="This post is a quick introduction to some other UPnP related issues. Yes, we have been targeting UPnP in the last couple of weeks mainly because is a big problem many people have forgotten or don't know about."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fupnp-the-saga-continues%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">UPnP The Saga Continues</h1><div class="date">Sun, 20 Jan 2008 20:35:27 GMT</div><div class="author">by pdp</div><div id="post-content"><p>This post is a quick introduction to some other UPnP related issues. Yes, we have been targeting UPnP in the last couple of weeks mainly because is a big problem many people have forgotten or don&#39;t know about.</p>
<p>We&#39;ve already <a href="/blog/hacking-with-upnp-universal-plug-and-play">covered</a> what UPnP is and how it works in most basic form. We&#39;ve also <a href="/blog/bt-home-flub-pwnin-the-bt-home-hub-5">showed</a> how it can be exploited with nothing more but a simple XSS on your home router. Then we&#39;ve <a href="/blog/hacking-the-interwebs">improved</a> upon our techniques with the so-called <a href="/blog/flash-upnp-attack-faq">Flash UPnP hack</a>. But what we have deliberately left out from the picture is that, in many cases, UPnP is remotely exploitable without interaction required from the victim and all the attackers need to know is the IP address of the exploitable device. DUH!</p>
<p>In the course of the past several weeks we&#39;ve been exploring Google through the <a href="http://johnny.ihackstuff.com/ghdb.php">Google Hacking Database</a> and the <a href="http://johnny.ihackstuff.com/forums/">Johnny.Ihackstuff.Com Forums</a>. With their help we manged to discover hundreds of devices that are visible on the Web and can be accessed to from the browser. After countless of hours in research, we manged to find the locations of the UPnP description files and from there the UPnP control points which can be exploited with one-shot attack from the comfort of the attacker&#39;s chair. &quot;Is that good?&quot; Not good at all.</p>
<p>Why on first place these devices are indexed by Google? And why on earth someone would allow UPnP across the Web? We have some ideas why the situation is so. First of all, we believe that some IP addresses have been used for hosting legitimate sites which Google and other Search Engines have indexed successfully. Then these IP addresses has been put back into rotation for DSL users. Due to the fact that the devices hooked on these IP addresses listen on any HTTP port, Google and friends have continued spidering their services. And this is pretty much the reason why they are there. However, it is more interesting to know why they allow communication on HTTP ports which are UPnP enabled. This unfortunately can be explained with the following: <strong>Bad Administration and lack of understandings!</strong></p>
<p>So there you go! Try it yourself and you will see that the number of devices that export UPnP services across the Web is pretty high. It is a matter of visiting the Google Hacking Database or the Forums in order to get lists, and also to find out the locations of the UPnP descriptions. And form that point on the possibilities are endless.</p>
<p><em>It shouldn&#39;t be that simple! This is another reason to verify that UPnP is switched off!</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/2fa599c05ae9e243f6e0d043cc67ef32?s=256&amp;d=retro" alt="AJ"><span class="post-comment-author">AJ</span><div class="post-comment-content">Is the attack directed at the ip address of your LAN interface or a multicast address., and if so would changing the default addresses give any protection</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">AJ,

has nothing to do with LAN or multicast addresses. The attack is directed to devices that have public IP addresses and UPnP enabled on public HTTP ports.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/2fa599c05ae9e243f6e0d043cc67ef32?s=256&amp;d=retro" alt="AJ"><span class="post-comment-author">AJ</span><div class="post-comment-content">The proof-of-concept that is shown goes after the known ip address of the router.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">AJ, I seriously do not understand what you are trying to say. In the previous posts we showed how to exploit UPnP on most routers as most devices have such facilities but only available for the local network. In this post we warn that there are many externally facing devices that has UPnP functionalities enabled as well. The first scenario requires the browser to perform the request since the attacker does not have local access. The second scenario provides the attacker with the ability to send the right type of require straight to the device without the need of any convoluted attack setup.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/4afbc87dbffd84f20a6f13a9cd9f633d?s=256&amp;d=retro" alt="iilab"><span class="post-comment-author">iilab</span><div class="post-comment-content">Is that true?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/3d2a2032d9c6fddbd0cbe92e5976a9a5?s=256&amp;d=retro" alt="Markus"><span class="post-comment-author">Markus</span><div class="post-comment-content">Why you dont send a email to them? Maybe they change it then</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/91eb90c2c8e3694a2f8b75390b13e3ef?s=256&amp;d=retro" alt="Avee"><span class="post-comment-author">Avee</span><div class="post-comment-content">My Thomson WL780i resolves http&#58;//speedtouch/ to the router itself. No need to find out its IP-Address.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">yes, as well as BT Home Hub is just http&#58;//api.home and most routers will respond to http&#58;//home</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>