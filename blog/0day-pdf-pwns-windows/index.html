<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>0day PDF pwns Windows</title><meta name="description" content="&gt; I am closing the season with the following HIGH Risk vulnerability: Adobe Acrobat/Reader PDF documents can be used to compromise your Windows box. Completely!!! Invisibly and unwillingly!!! All it takes is to open a PDF document or stumble across a page which embeds one."><meta property="name" content="0day PDF pwns Windows"><meta itemprop="name" content="0day PDF pwns Windows"><meta property="description" content="&gt; I am closing the season with the following HIGH Risk vulnerability: Adobe Acrobat/Reader PDF documents can be used to compromise your Windows box. Completely!!! Invisibly and unwillingly!!! All it takes is to open a PDF document or stumble across a page which embeds one."><meta itemprop="description" content="&gt; I am closing the season with the following HIGH Risk vulnerability: Adobe Acrobat/Reader PDF documents can be used to compromise your Windows box. Completely!!! Invisibly and unwillingly!!! All it takes is to open a PDF document or stumble across a page which embeds one."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2F0day-pdf-pwns-windows%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2F0day-pdf-pwns-windows%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/0day-pdf-pwns-windows/"><meta property="og:title" content="0day PDF pwns Windows"><meta property="og:description" content="&gt; I am closing the season with the following HIGH Risk vulnerability: Adobe Acrobat/Reader PDF documents can be used to compromise your Windows box. Completely!!! Invisibly and unwillingly!!! All it takes is to open a PDF document or stumble across a page which embeds one."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2F0day-pdf-pwns-windows%2F?w=1024"><meta name="twitter:title" content="0day PDF pwns Windows"><meta name="twitter:description" content="&gt; I am closing the season with the following HIGH Risk vulnerability: Adobe Acrobat/Reader PDF documents can be used to compromise your Windows box. Completely!!! Invisibly and unwillingly!!! All it takes is to open a PDF document or stumble across a page which embeds one."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2F0day-pdf-pwns-windows%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">0day PDF pwns Windows</h1><div>Thu, 20 Sep 2007 13:03:33 GMT</div><div id="post-content"><blockquote>
<p>I am closing the season with the following <strong>HIGH</strong> Risk vulnerability: Adobe Acrobat/Reader PDF documents can be used to compromise your Windows box. Completely!!! Invisibly and unwillingly!!! All it takes is to open a PDF document or stumble across a page which embeds one.</p>
</blockquote>
<p>The issue is quite <strong>critical</strong> given the fact that PDF documents are in the core of today&#39;s modern business. This and the fact that it may take a while for Adobe to fix their closed source product, are the reasons why I am not going to publish any POCs. You have to take my word for it. The POCs will be released when an update is available.</p>
<blockquote>
<p>Adobe&#39;s representatives can contact me from the usual <a href="http://www.gnucitizen.org/contact">place</a>. My advise for you is not to open any PDF files (locally or remotely). Other PDF viewers might be vulnerable too. The issues was verified on Windows XP SP2 with the latest Adobe Reader 8.1, although previous versions are also affected.</p>
</blockquote>
<p><em>A formal summary and conclusion of the recent <strong>GNUCITIZEN</strong>&#39;s bug hunt to be expected soon.</em></p>
</div><div id="post-comments"><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content"><em>btw, the vulnerability is more severe then the <a href="http://www.gnucitizen.org/blog/0day-quicktime-pwns-firefox" rel="nofollow">QTL QuickTime issue</a>.</em></div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="nigel mellish"><span>nigel mellish</span><div class="post-comment-content">Preview on OS X still OK then? not trying to be snarky. really want to know.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">nigel mellish,

should be... I will try later when I have access to a Mac.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Xinstict"><span>Xinstict</span><div class="post-comment-content">We love your POCs. Why after update:)</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="DaveOJ"><span>DaveOJ</span><div class="post-comment-content">Assuming that this impacts standalone PDF documents, not just those opened through a browser?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Awesome AnDrEw"><span>Awesome AnDrEw</span><div class="post-comment-content">Can't wait to see how this works, PDP. It seems like everyday you have a new concept or issue to present.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Ben"><span>Ben</span><div class="post-comment-content">I wonder if this explains that strange password-protected pdf I got from some random person this morning.  I did open it using Preview (running MacOS X 10.4 here), although using a guest account that wasn't an administrator account.  Turned out to be yet anther stupid pyramid scheme...</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">DaveOJ, it affects both... embeded and standalone.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Grant"><span>Grant</span><div class="post-comment-content">If one views an altered Adobe file with an alternate reader (e.g. Fox-It), does this still work?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">Grant, the exploit works although it is less severe.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Geo"><span>Geo</span><div class="post-comment-content">pdp, any way to block it prior to adobe releasing a patch? It took them 2 months to patch the one I found that resulted in 7.08, heck it could be christmas before they do yours. 

Be nice if there was something we could do in the mean time to avoid being vuln to this.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="/nul"><span>/nul</span><div class="post-comment-content">Nice work, as always, pdp. Just one question: does it work if JavaScript is disabled in Acrobat Reader?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="le$$er"><span>le$$er</span><div class="post-comment-content">"Less Severe" 

Either you own the box or you don't, how is it "less severe?"</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="imipak"><span>imipak</span><div class="post-comment-content">I too would be interested to hear how my preferred alternative PDF viewers hold up (Xpdf, Ghostscript, Kpdf et al.) ..? If there were a PoC I'd test myself, but in the circs I can only ask...</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="BK"><span>BK</span><div class="post-comment-content">Nice... you've been on a tear lately!  Can't wait to see the details!

Billy (BK) Rios</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="GiantCrazy"><span>GiantCrazy</span><div class="post-comment-content">Any of the open source PDF readers affected too?  I hate the phone home-i-ness of Acrobat, so I went with Foxit instead.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="nobody"><span>nobody</span><div class="post-comment-content">3 of the last 4 releases have had "pwns" in the title. :S</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content"><em>The vulnerability affects Windows XP SP2 with IE7 and Adobe Reader 8.1, 8.0 and 7. Windows Vista users are not affected.</em> Here is a harmless demonstration of the issue:

<iframe class="video" src="//www.youtube.com/embed/R_mv49Sdeok" frameborder="0" allowfullscreen></iframe>

You can also download this video from <a href="http://www.gnucitizen.org/static/blog/2007/09/poc.wmv" rel="nofollow">here</a> or <a href="http://www.gnucitizen.org/static/blog/2007/09/poc.divx" rel="nofollow">here</a>. The PDF issue is officially confirmed by Adobe's team. Foxit is vulnerable as well, although the user is required to interact with the document in order to launch the exploit.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="weweje"><span>weweje</span><div class="post-comment-content">This seems to explain why a wide PDF-attached spam campain had spread around last month. http://sophos.com/pressoffice/news/articles/2007/08/pdf-spam.html</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Roach"><span>Roach</span><div class="post-comment-content">I, too, would be interested in learning whether certain alternatives are affected as well. In my case, Sumatra, as in the Portable Sumatra version available from portableapps.com</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Thor Larholm"><span>Thor Larholm</span><div class="post-comment-content">This is a little light on the details, but based on the video I would take a wild guess and think that you are using Object Codebase to launch the calculator and notepad. http://www.greymagic.com/security/advisories/gm001-ie/ has a nice example of this that requires no scripting, but does require you to render the HTML inside the My Computer zone. This would fit in well with Adobe Acrobat Reader being able to render HTML snippets and also not having set the FEATURE_LOCALMACHINE_LOCKDOWN flag.

A yes or no to the above would be nice, so I don't have to reproduce this myself (lazy me ;)</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">Thor, this is not the issue although now when u r mentioning it, it might be a good idea to check it out.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Bruce"><span>Bruce</span><div class="post-comment-content">This is very serious, I wont like a bit that opening my PDF format credit card statement ensures that $1000 is debited by an online transaction. This is scary, shucks!!

thanks pdp</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="James"><span>James</span><div class="post-comment-content">Cmon fricken show us some code! or post that pdf file so we can reverse it</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian Pastor"><span>Adrian Pastor</span><div class="post-comment-content">pdp,

remember to mention that it also works on win2k3 fully patched. I can definitely see some administrators accessing a malicious PDF file from a shared folder which compromises the server when running it on the win2k3 box.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="David Kierznowski"><span>David Kierznowski</span><div class="post-comment-content">pdp, simple and very effective, nice.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Vincent"><span>Vincent</span><div class="post-comment-content">Very nice that you found this bug. I don't open any PDF!</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Mark"><span>Mark</span><div class="post-comment-content">Information is a bit sparse right now.  Is IE the only browser affected?

Thanks,
Mark</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Charles"><span>Charles</span><div class="post-comment-content">Could this vulnerability be propagated via a web page?  E.g., a coupon page with code hidden it it, that gets the user to print to a pdf file, which when then opened triggers the vulnerability?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="packetracer"><span>packetracer</span><div class="post-comment-content">Two questions:

1) When a Adobe confirmed the bug, did they give a timeline for releasing the fix?

2) Can you please not release details until a week (or two) _after_ the Adobe update is available?  This week or two gives corporate IT guys time to update, and stay ahead of game.

Many thanks!</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="swhx7"><span>swhx7</span><div class="post-comment-content">Based on the greymagic link [ http://www.greymagic.com/security/advisories/gm001-ie/ ] it is clear there is an exploit with Activex, though I am not sure it is the only one or the same one that pdp is reporting.

My result with the Greymagic POC on Windows 2000 was that the asp file, downloaded and opened locally, would start calc.exe when opened with IE but not when opened with Seamonkey. This is with Active X totally turned off in 4 IE zones but probably still on in the 5th zone which I have not made visible. (Note, i do not use browser plugins and do not have Adobe installed, so it was clearly the Active X.)

pdp, will you at least say whether what you've found is the same as or different than the greymagic POC? This would help with user protection.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="swhx7"><span>swhx7</span><div class="post-comment-content">Apologies, I see my question was already answered in the reply to Thor. So the new vuln is a different one.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">packetracer, adobe confirmed the bug privately. the bug was also confirmed by several friends and well known security researchers who had access to the exploit.

swhx7, the bug is different.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="OmegaJunior"><span>OmegaJunior</span><div class="post-comment-content">This will still affect user accounts without administration privileges, I assume, but hopefully within the privileges range of the logged-in user? Only administrators will risk having their system taken over?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Suma"><span>Suma</span><div class="post-comment-content">Why don't you upload the pdf?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="herbalist"><span>herbalist</span><div class="post-comment-content">I understand your reasons for not releasing details or a usable sample of this exploit, though it would sure be nice to have one for testing. In your video, the demo launches calculator. Can this exploit be effectively neutralized with a HIPS and restricting parent-child dependency settings?

Rick</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Quadro"><span>Quadro</span><div class="post-comment-content">Is the interaction required to launch the exploit in Foxit something that appears normal or not?  In other words, is it something that doesn't usually happen?  A video of the interaction required would be nice if you can provide it.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Crack"><span>Crack</span><div class="post-comment-content">Hahah what a owner 

http://www.marketwatch.com/quotes/adbe</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="tsw"><span>tsw</span><div class="post-comment-content">pdp, could you post a regex that can detect PDFs that contain the vulnerability at least? This would allow us to block incoming attachments and uploads without necessarily giving away the exploit itself...</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="swhx7"><span>swhx7</span><div class="post-comment-content">The fact that it works in Foxit as well as Adobe reader implies that it relies on a flaw in Windows, not just Adobe's reader.

I'm interpreting "interaction" in Foxit as something more than just opening a PDF. If this is correct, then Foxit can be a safe alternative for now if used with care.

The interaction referred to could be either something with Javascript or clicking a link (any other possibilities? form?). In my version of Foxit, at least up to v.2 I think, Javascript is an optional add-on, not installed by default.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Somewhat_Concerned"><span>Somewhat_Concerned</span><div class="post-comment-content">Does the exploit look for a local file path, a remote file path, or both? At least knowing that much, I can write some IPS rules.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="severity"><span>severity</span><div class="post-comment-content">The demo video simply executes executables already existing on the local machine with no command line arguments. To me, this is more of a nuisance, than a security issue. 

However, if an attacker could execute arbitrary commands with arbitrary command line arguments, then that would be interesting. 

Does your exploit allow for arbitrary command line arguments? If so, could you post a PoC loading c:\boot.ini in notepad.exe to prove it?

Or could you explain the security implication of running calc.exe, notepad.exe, or any other common executable in Windows without command line arguments?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">severity, arbitrary commands options can be passed but to be honest with you, don't need them. There are ways attackers to execute far more dangerous things then simple commands.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="hackathology"><span>hackathology</span><div class="post-comment-content">pdp is the facilitator, he starts something cool and create a hype. I definitely cant wait to see this.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="tombstone"><span>tombstone</span><div class="post-comment-content">Hi pdp, do you know when the patch will be out? The vulnerability that you discovered is vital to one of my demo. Would appreciate it if you know when the patch is out so that I can take a look at the POC.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="MustLive"><span>MustLive</span><div class="post-comment-content">Pdp, nice find! Interesting vulnerability and video.

Waiting for detailed information about it.

You said it works in Acrobat (as shown in video) and in browser. What difference and can you make video (in browser demonstration)? And what browsers are vulnerable (and what Acrobat/Reader/plugin versions except Adobe Reader 8.1).

About video: it is harmless one, but you can make harmful video :-). To show all possibility of this hole and to make people (and Adobe guys) to be more aware of danger of this vulnerability. You can make "format c:" demonstration ;-). Make it in VM environment (it will be harmless and easier for you and will be bright demonstration of the hole).</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="MadScientist"><span>MadScientist</span><div class="post-comment-content">Any update from Adobe on a patch? I'd at least like to see a public acknowledgment that they are fixing it...</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="PDP11"><span>PDP11</span><div class="post-comment-content">Hi guys,

Is The fix out already ? 

It's funny, but before I read about this PDF vulnerability, a while back, I was thinking is that possible ?  maybe I was just being creatively thinking lol as no one really expect a "text file" be a vehicle for madness !

Note: I've been always PDP11 :) just a coincidence  PDP</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">PDP11, not yet... according to my contacts in Adobe, the patch will be available at the end of this month.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="codepupil"><span>codepupil</span><div class="post-comment-content">Can you confirm if this work around will work?
http://www.adobe.com/support/security/advisories/apsa07-04.html</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="/nul"><span>/nul</span><div class="post-comment-content">IMHO, with Adobe bulletin, it became obvious that this is an URI handler bug. Mitigation reg key (cDefaultLaunchURLPerms) speaks for itself :)

It seems like mailto: handler is by default set to "automatic" launch in Adobe Acrobat/Reader (reg value=2).</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">codepupil, I need to verify this. There are a few more issues that make the exploit functional and complete.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="tigre"><span>tigre</span><div class="post-comment-content">Hi, isn't the point here that only  pdf's of unknown origib could be suspicious? Most pdf's are from legitimate providers and so you must mean spam that comes with a pdf. So can normal pdf's even be infected with whatever the exploit is? Or are we talking abour PDF"S FROM SUSPICIOUS SOURCES ONLY HERE OR ALL PDF'S ?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="codepupil"><span>codepupil</span><div class="post-comment-content">PDP, Thanks I've deployed the workaround just in case. 

Tigre: It would seem to me the bigger issue is  someone embedding this pdf in webpages or in html emails but I may be wrong...</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="thorin"><span>thorin</span><div class="post-comment-content">I have a hard time believing that "XP with IE7" is the only vulnerable combination. Especially when you're example video doesn't seem to depend on IE at all.

Has anyone tested on Win2K? XP w/ IE 6? other</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="MadScientist"><span>MadScientist</span><div class="post-comment-content">I'm with thorin - a whole shitload of companies who aren't running IE7 have just removed all their mitigations based on that announcement, but I'm not convinced. pdp, can you please confirm that Adobe's workaround really solved the problem that you found? Thanks.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">More information on the issue can be found <a href="http://blogs.technet.com/msrc/archive/2007/10/10/msrc-blog-additional-details-and-background-on-security-advisory-943521.aspx " rel="nofollow">here</a> and <a href="http://www.microsoft.com/technet/security/advisory/943521.mspx" rel="nofollow">here</a>. Adobe has released advisory over <a href="http://www.adobe.com/support/security/advisories/apsa07-04.html" rel="nofollow">here</a>. Successful exploitation of the PDF issue relays on a few other things.

Microsoft has no other choice but to patch up the issue just to satisfy the community, even though this may not by entirely their problem. First of all developers should not really trust the user input and pass it to a function that they don't fully understand. Now, some of you may criticize me for this statement, but do we blame PHP or ASP for the SQL Injections that your software has? No! Why should anyone pass something that does not look like a URL into a function that expects URLs?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="thorin"><span>thorin</span><div class="post-comment-content">Thanks pdp that technet blog article was great.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian"><span>Adrian</span><div class="post-comment-content">Thanks. 

For those who are against the idea of publishing this vulnerability. Their concerns are understood. People just don't like being helpless. To make an analogy, I would imagine that we shouldn't talk about AIDS because we didn't find a cure for it; we shouldn't broadcast news of Burma because we can't help the people there.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="MadScientist"><span>MadScientist</span><div class="post-comment-content">Adrian: not the best analogy since AIDS is rampant in the wild and many people are working on stopping it, so we need to talk about it. With the PDF vulnerability, it is still contained.

I'm a big fan of full disclosure *if the vendor is unresponsive* as a means to increase pressure for a solution. If I can find a vulnearbility, so can many others, so we need a fix. But if the vendor has acknowledged and is working towards a 'cure', give them time before unleashing the madness.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Picco"><span>Picco</span><div class="post-comment-content">Why can't we have an example of this vurnerability ?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="cyanid-E"><span>cyanid-E</span><div class="post-comment-content">hi 

there is my PoC: http://security.fedora-hosting.com/0day/pdf/pdf_poc.pdf

there is ugly description: http://security.fedora-hosting.com/0day/pdf/pdf_poc.txt

thank you, pdp :)

regards,
cyanid-E</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="helloworld"><span>helloworld</span><div class="post-comment-content">Hi There

There's a direct exploitation of this vuln without any prompt,advertise,or whatever. we can reevaluate the XSS criticity vector with these kind of PoC. http://aviv.raffon.net/ (news = Back from the dead)

regards.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="laurent.gaffiÃ©"><span>laurent.gaffiÃ©</span><div class="post-comment-content">Hi guys

i guess we can rename your PoC from remote unless than locally now! nice find btw keep it up dude ;)

regards laurent gaffiÃ©</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="ricko"><span>ricko</span><div class="post-comment-content">This is a great tutorial thanks!2</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Nms"><span>Nms</span><div class="post-comment-content">Hi there!

@helloworld&amp;laurent.gaffiÃ© : just rename your pdf file, say test.pdf, to test.fdf ... Opens external Acrobat with IE7 and prompt an open dialog with FF. Enjoy ;)

Cheers</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Deeprunner"><span>Deeprunner</span><div class="post-comment-content">Very Informative and I see We still can't get along apparently, oh well.  But, being obviously on the lower end of the knowledge curve in this arena...Can any of you human beings tell me what you think of this link's usefullness regarding these kind of issues? -Vegas</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="XT12D"><span>XT12D</span><div class="post-comment-content">Bad analogy, Adrian, A better one would be, "Why not hand out vials of HIV tainted blood in the hopes that some freelance doctor will find a cure?"</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="ggman"><span>ggman</span><div class="post-comment-content">@cyanid-E

I opened your pdf on a linux system
via:

1. adobe firefox plugin
2. adobe reader 8.1.1 ("Adobe strongly recommends upgrading to Adobe Reader 8.1.1")

and evolution offered me to send an email to guys with really strange email adresses:

1. "windows/system32/calc.exe" 
2. test%.. 

- quite scary -</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Sally"><span>Sally</span><div class="post-comment-content">This explains why spammers have now switched to sending their emails with a PDF attachment. Usually the PDF attachment contains an embedded image of a stock quote or something stupid like that. Lately I have been openning these out of curiousity but it seems we should not.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Sally"><span>Sally</span><div class="post-comment-content">Have you all noticed that the spammer's choice of delivery has become PDF attachments?

The attached PDF usually contains stock quotes.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Onlinespiele"><span>Onlinespiele</span><div class="post-comment-content">Are there any reactions from Adobe?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="CG"><span>CG</span><div class="post-comment-content">now that all the patches are out are you going to release some more details?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Moose"><span>Moose</span><div class="post-comment-content">Does this affect Windows XP w/ Service Pack 3?

Thanks</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2019 <a href=""></a>. All rights reserved.</p></footer></body></html>