<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Holes In Embedded Devices Authentication Bypass (pt 2)</title><meta name="description" content="Usually, when accessing a web interface of an appliance, the user is prompted to enter a password if not authenticated already. This could be done via a HTML form on the login page or a basic HTTP authentication prompt (among other methods)."><meta property="name" content="Holes In Embedded Devices Authentication Bypass (pt 2)"><meta itemprop="name" content="Holes In Embedded Devices Authentication Bypass (pt 2)"><meta property="description" content="Usually, when accessing a web interface of an appliance, the user is prompted to enter a password if not authenticated already. This could be done via a HTML form on the login page or a basic HTTP authentication prompt (among other methods)."><meta itemprop="description" content="Usually, when accessing a web interface of an appliance, the user is prompted to enter a password if not authenticated already. This could be done via a HTML form on the login page or a basic HTTP authentication prompt (among other methods)."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-2%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-2%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/holes-in-embedded-devices-authentication-bypass-pt-2/"><meta property="og:title" content="Holes In Embedded Devices Authentication Bypass (pt 2)"><meta property="og:description" content="Usually, when accessing a web interface of an appliance, the user is prompted to enter a password if not authenticated already. This could be done via a HTML form on the login page or a basic HTTP authentication prompt (among other methods)."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-2%2F?w=1024"><meta name="twitter:title" content="Holes In Embedded Devices Authentication Bypass (pt 2)"><meta name="twitter:description" content="Usually, when accessing a web interface of an appliance, the user is prompted to enter a password if not authenticated already. This could be done via a HTML form on the login page or a basic HTTP authentication prompt (among other methods)."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-2%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Holes In Embedded Devices Authentication Bypass (pt 2)</h1><div class="date">Fri, 15 Feb 2008 17:18:09 GMT</div><div class="author">by
pagvac</div><div id="post-content"><p>Usually, when accessing a web interface of an appliance, the user is prompted to enter a password if not authenticated already. This could be done via a HTML form on the login page or a basic HTTP authentication prompt (among other methods).</p>
<p>Let&#39;s call the <strong>authentication stage: A</strong>. Once, the admin user enters a username/password combination, the device checks the provided combination against credentials stored in its internal configuration. Let&#39;s call this <strong>password checking procedure: B</strong>. After authenticating with the correct credentials, the admin user would be presented with a menu which offers all the administrative functionalities available. Let&#39;s call any of these <strong>administrative URLs: C</strong>.</p>
<h2 id="a-to-c-attacks-a-k-a-knowledge-of-post-authentication-urls">&quot;A-to-C&quot; Attacks a.k.a. Knowledge Of &quot;post-authentication&quot; URLs</h2>
<p>The problem is that the authentication mechanism of some embedded devices is so poor, that when an unauthenticated user requests a URL that would usually only be available after logging in, the device won&#39;t even ask for a password. This is due to the &gt;logic of the authentication algorithm which assumes that if the requested URL is part of the administrative menu, then the user must have provided a valid username/password combination already. Instead, the device should check if the user is in fact authenticated with every single HTTP request (i.e.: via session IDs).</p>
<p>The result is devastating as the attacker can completely bypass the authentication and perform tasks with full administrative privileges by simply accessing certain URLs.</p>
<p>One could argue that the real problem is that the developers of the vulnerable web interface made the naive assumption that an attacker would never be able to guess the URL path of an administrative page. However, we all know there are several ways an attacker could have knowledge of such URLs. The following are just some examples:</p>
<ul>
<li><strong>By sniffing cleartext HTTP traffic</strong> between the admin user and the target device (the attacker would most likely be located in the same local subnet as the admin user in this attack)</li>
<li><strong>By bruteforcing administrative URLs</strong> (admin URLs are sometimes highly-guessable such as <code>/WAN.html</code> - for WAN settings)</li>
<li><strong>By learning about a A-to-C auth bypass vulnerability</strong> via public or private vulnerability research</li>
<li><strong>By looking up support information</strong> on the vendor&#39;s site (i.e.: manuals)</li>
</ul>
<p>The following is the pseudocode of the authentication algorithm of a device that blindly trusts the user when requesting administrative URLs:</p>
<ol>
<li>Prompt user for admin username and password</li>
<li>Check if provided credentials match internal configuration</li>
<li>If so, then provide access to administrative menu (no more auth checks are performed after this)</li>
<li>Else prompt user for admin username and password again</li>
</ol>
<p>It is recommended that you check devices in your network for this kind of issue. Remember, the <a href="/blog/router-hacking-challenge">router hacking challenge</a> hasn&#39;t finished yet, so keep the bugs coming! For those stuck who don&#39;t know what else to check besides XSS and CSRF you might be interested in <a href="/blog/holes-in-embedded-devices-authentication-bypass-pt-1">reading</a>  <a href="/blog/holes-in-embedded-devices-ip-based-session-management">the previous</a> &quot;<a href="/blog/holes-in-embedded-devices-binary-state-session-management">Holes in Embedded Devices</a>&quot; <a href="/blog/holes-in-embedded-devices-desynchronized-service-acting-as-backdoor">posts</a>.</p>
<p>By the way, the &quot;Holes in Embedded Devices&quot; posts is an ongoing series of posts, so stay tuned!</p>
</div></div></article><footer id="footer"><p>Copyright &copy; 2024 <a href=""></a>. All rights reserved.</p></footer></body></html>