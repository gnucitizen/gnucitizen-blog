<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ASX Plus ClickOnce - Dangerous Combination</title><meta name="description" content="Over the last couple of days there was a surge of stories related to the recent drive-by-download malware attacks against Macs and PCs. The attacks are nothing more but social engineering attempts which try to trick the victim into installing the malicious program on the victims' machines. This approach is very simple but, as you can see, quite effective. In this post I would like to draw your attention on a variation of these types of attacks which work for Windows environments with Microsoft Media Player 9 or earlier and .NET 2 or later installed."><meta property="name" content="ASX Plus ClickOnce - Dangerous Combination"><meta itemprop="name" content="ASX Plus ClickOnce - Dangerous Combination"><meta property="description" content="Over the last couple of days there was a surge of stories related to the recent drive-by-download malware attacks against Macs and PCs. The attacks are nothing more but social engineering attempts which try to trick the victim into installing the malicious program on the victims' machines. This approach is very simple but, as you can see, quite effective. In this post I would like to draw your attention on a variation of these types of attacks which work for Windows environments with Microsoft Media Player 9 or earlier and .NET 2 or later installed."><meta itemprop="description" content="Over the last couple of days there was a surge of stories related to the recent drive-by-download malware attacks against Macs and PCs. The attacks are nothing more but social engineering attempts which try to trick the victim into installing the malicious program on the victims' machines. This approach is very simple but, as you can see, quite effective. In this post I would like to draw your attention on a variation of these types of attacks which work for Windows environments with Microsoft Media Player 9 or earlier and .NET 2 or later installed."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fasx-plus-clickonce-dangerous-combination%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fasx-plus-clickonce-dangerous-combination%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/asx-plus-clickonce-dangerous-combination/"><meta property="og:title" content="ASX Plus ClickOnce - Dangerous Combination"><meta property="og:description" content="Over the last couple of days there was a surge of stories related to the recent drive-by-download malware attacks against Macs and PCs. The attacks are nothing more but social engineering attempts which try to trick the victim into installing the malicious program on the victims' machines. This approach is very simple but, as you can see, quite effective. In this post I would like to draw your attention on a variation of these types of attacks which work for Windows environments with Microsoft Media Player 9 or earlier and .NET 2 or later installed."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fasx-plus-clickonce-dangerous-combination%2F?w=1024"><meta name="twitter:title" content="ASX Plus ClickOnce - Dangerous Combination"><meta name="twitter:description" content="Over the last couple of days there was a surge of stories related to the recent drive-by-download malware attacks against Macs and PCs. The attacks are nothing more but social engineering attempts which try to trick the victim into installing the malicious program on the victims' machines. This approach is very simple but, as you can see, quite effective. In this post I would like to draw your attention on a variation of these types of attacks which work for Windows environments with Microsoft Media Player 9 or earlier and .NET 2 or later installed."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fasx-plus-clickonce-dangerous-combination%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">ASX Plus ClickOnce - Dangerous Combination</h1><div class="date">Mon, 05 Nov 2007 12:52:02 GMT</div><div class="author">by
<a href="/members/pdp.html">pdp</a></div><div id="post-content"><p>Over the last couple of days there was a surge of stories related to the recent drive-by-download malware attacks against Macs and PCs. The attacks are nothing more but social engineering attempts which try to trick the victim into installing the malicious program on the victims&#39; machines. This approach is very simple but, as you can see, quite effective. In this post I would like to draw your attention on a variation of these types of attacks which work for Windows environments with Microsoft Media Player 9 or earlier and .NET 2 or later installed.</p>
<p>Do you remember back in the days when attackers were spreading malware as part of fake Windows IE patches attached to simple emails? These attacks were very successful and they have evolved since then. Today, you are more likely to see them as part of sites which offer you free games, free software, or ask you to upgrade to the latest version of a particular product. Sometimes, they ask you to enhance your default video player with some additional plugins, as it is the case with the recent Mac attacks. If you don&#39;t do that, then you cannot see the video. It is a simple as that.</p>
<p>Video formats are very powerful tools in the hands of not that skilled but dedicated attackers. Simply put, people like watching videos. I&#39;ve talked about video format attacks before (QTL, MOV, MPGs, etc, etc, etc) and in particular covered the <a href="/blog/backdooring-windows-media-files">ASX file format</a> and the dangerous applications it can be used for. Having my previous posts in mind, I would like to quickly draw your attention on how attackers can combine ASX files with something like .NET ClickOnce and come up with a very believable attack which will work. But first, let&#39;s see what ClickOnce is. From <a href="http://en.wikipedia.org/wiki/ClickOnce">Wikipedia</a>:</p>
<blockquote>
<p>ClickOnce is a Microsoft technology for deploying Windows Forms or Windows Presentation Foundation-based software, also called Smart clients. ClickOnce is only available in .NET 2.0 and later. A less advanced technique can be obtained with the Microsoft Updater Application Block. It is similar to Java Web Start for the Java Platform.</p>
</blockquote>
<p>I guess most of you already know where I am going with this post. I mentioned before that the ASX file format allows you to embed HTML pages within the video. These pages are known as <code>HTMLView</code>. When the victim opens the ASX file, Microsoft Windows Media Player will download the <code>HTMLView</code> page and load it within the player&#39;s chrome. At that point the victim will be presented with a screen which informs that there was a problem with previewing the video and they must allow Media Player to go and look for the plugin that is required. When the victim approves the action, a Microsoft ClickOnce application is launched. Due to the fact that these applications have very Microsoft-ish installation window and require only one action to get installed, the victim will be tricked into allowing the setup to continue. After all, Windows does prompt you very often when you want to install unsigned drivers or simply allow application to get off your personal Firewall. So, users are used to these kind of messages.</p>
<p>Once the application is installed the attacker will have the desired access on that system. There are some additional steps that needs to be performed in order to make the attack as smooth as possible but I will keep these private for now. Nevertheless, you should be able to get the point. Check out the <a href="/files/2007/11/clickonce-poc.asx">POC</a> which provides you with a very basic idea of how the attack works. The POC is very rough, I must say, but it is enough to illustrate the problem in its most basic form.</p>
<p><em>This type of attacks are by far the simplest. They simply do not require any sort of technical expertise. Nevertheless, you should not take them lightly. Simple things like this do work and it is part of GNUCITIZEN ideology to start open discussion on their potential impact. Just keep them in mind next time.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5e0f595cbc8f1811233adce10ac6c5d3?s=256&amp;d=retro" alt="Awesome AnDrEw"><span class="post-comment-author">Awesome AnDrEw</span><div class="post-comment-content">The POC points to a nonexistent file, but I understand what you're going for. I always enjoy the way people seem to figure out how to integrate these types of issues to totally mislead others into accepting potentially harmful files.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/002eefa2175786221e0011b78be465dd?s=256&amp;d=retro" alt="is there a fix?"><span class="post-comment-author">is there a fix?</span><div class="post-comment-content">Could you get a list of systems/trails/paths that are effected or changed.To my honest opinion the least knowledgeable should get free help and improvement suggestions respectable.Let's not forget not all of 50%er's brainpower got that HIGH!My alzheimers has me forgetting much and not knowing what I learned at early stages let just call it a curse and the tragedy of it is you know its coming.Does it speed up or all at once.Wow I wondered off again. hee! hee! 

I removed my WMplayer classic and the yoshidi codecs.Restored back to "WmPlayer.10"</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/21bca55e31165e145d027285eed1202b?s=256&amp;d=retro" alt="swarup"><span class="post-comment-author">swarup</span><div class="post-comment-content">Thanks PDP for this article. My system can be exploited if I use WM player to open the poc.asx file. What if I use Winamp or some other media palyer to open this file? does it have same amount of risk.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">swarup, if you are using a different player then you might be protected but don't take my words for granted since I haven't investigated that yet. Though, the feature that I used in this post is mostly Windows Media Player related.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2022 <a href=""></a>. All rights reserved.</p></footer></body></html>