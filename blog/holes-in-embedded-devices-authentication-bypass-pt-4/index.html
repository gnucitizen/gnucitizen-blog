<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Holes In Embedded Devices Authentication Bypass (pt 4)</title><meta name="description" content="This kind of authentication bypass bug can go easily undetected during a security assessment if not enough attention is paid. In order to understand this type of vulnerability, we need to be familiar with settings pages available on devices' web interface that allow the admin user to modify settings."><meta property="name" content="Holes In Embedded Devices Authentication Bypass (pt 4)"><meta itemprop="name" content="Holes In Embedded Devices Authentication Bypass (pt 4)"><meta property="description" content="This kind of authentication bypass bug can go easily undetected during a security assessment if not enough attention is paid. In order to understand this type of vulnerability, we need to be familiar with settings pages available on devices' web interface that allow the admin user to modify settings."><meta itemprop="description" content="This kind of authentication bypass bug can go easily undetected during a security assessment if not enough attention is paid. In order to understand this type of vulnerability, we need to be familiar with settings pages available on devices' web interface that allow the admin user to modify settings."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-4%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-4%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/holes-in-embedded-devices-authentication-bypass-pt-4/"><meta property="og:title" content="Holes In Embedded Devices Authentication Bypass (pt 4)"><meta property="og:description" content="This kind of authentication bypass bug can go easily undetected during a security assessment if not enough attention is paid. In order to understand this type of vulnerability, we need to be familiar with settings pages available on devices' web interface that allow the admin user to modify settings."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-4%2F?w=1024"><meta name="twitter:title" content="Holes In Embedded Devices Authentication Bypass (pt 4)"><meta name="twitter:description" content="This kind of authentication bypass bug can go easily undetected during a security assessment if not enough attention is paid. In order to understand this type of vulnerability, we need to be familiar with settings pages available on devices' web interface that allow the admin user to modify settings."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-4%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Holes In Embedded Devices Authentication Bypass (pt 4)</h1><div class="date">Tue, 26 Feb 2008 16:37:36 GMT</div><div class="author">by
pagvac</div><div id="post-content"><p>This kind of authentication bypass bug can go easily undetected during a security assessment if not enough attention is paid. In order to understand this type of vulnerability, we need to be familiar with settings pages available on devices&#39; web interface that allow the admin user to modify settings.</p>
<p>Administrative web interfaces have different sections/menus available to logged-in administrators. Each section is just a HTML page with a form designed to make configuration changes. For instance, web interfaces of Internet gateways usually have pages such as WAN, LAN, WLAN, SNMP, UPnP, change password, firewall settings and so on. In summary, each page allows changing different types of settings. </p>
<p>Let&#39;s assume that such settings pages are password-protected correctly. So if a given settings page can only be accessed with the admin password, does that mean that changing settings cannot be done by attackers who don&#39;t know the admin password? Actually, in some cases, it&#39;s possible to change such settings after all! Let&#39;s see why. As it&#39;s been said before, each settings page is nothing else than a HTML form (usually accompanied by some JavaScript). However, if we pay attention to the form&#39;s action attribute, we sometimes see that the parameter names and values (located in input tags) within the page form are actually submitted to a URL (usually a CGI script) <em>different</em> to the current one.</p>
<p>So the question to ask ourselves is: is the actual HTTP request that performs a configuration change (usually a POST request) password-protected? If not, that would mean that the attacker can perform administrative changes, even if the settings page is password-protected!</p>
<p>A good <a href="https://chatbotkit.com/examples">example</a> of this type of vulnerability is the authentication bypass <a href="http://www.securityfocus.com/archive/1/442452/30/0/threaded">found</a> on Linksys WRT54G by Ginsu Rabbit. Although the vulnerable firmware (version 1.00.9) requires a password to view any settings page, it doesn&#39;t protect the CGI script that processes the configuration changes.</p>
<p>For instance, requesting the wireless settings page prompts the user to enter the admin username and password (if not authenticated already):</p>
<pre><code>GET /wireless.htm HTTP/1.1
Host: 192.168.0.1
Connection: close

Unfortunately, changing the wireless settings parameters which are processed by the Security.tri server-side program does not require a password! For instance, the following POST request disables the wireless encryption without requiring the admin password:

POST /Security.tri HTTP/1.1
Host: 192.168.0.1
Content-Length: 24
Connection: close

SecurityMode=0&amp;layout=en

In summary, the problem is that /wireless.htm _is_ password protected while /Security.tri is _not_. Terrible mistake!

Another good example is the authentication bypass found on Belkin Wireless G router F5D7230-4 by loftgaia during the [Router Hacking Challenge](/blog/router-hacking-challenge/) we organized with the [Hacker Webzine](http://www.0x000000.com/?i=508). History repeats itself again: the setting pages are password-protected but not the server-side program that handles the configuration changes. In the proof of concept provided by loftgaia we can see that the DNS settings page /setup_dns.stm is properly password-protected but changing the DNS settings is possible without a password since the /cgi-bin/setup_dns.exe program is publicly available (not password protected).

The following example is the POST request that changes the primary and secondary DNS servers to `1.1.1.1` and `2.2.2.2`, thus the attacker can fully own domain resolutions of all the users that are part of the network handled by the vulnerable Belkin device:

POST /cgi-bin/setup_dns.exe
Host: 192.168.2.1
Connection: close
Referer: http://192.168.2.1/setup_dns.stm
Content-Length: 94

page=setup_dns&amp;logout=&amp;dns1_1=1&amp;dns1_2=1&amp;dns1_3=1&amp;dns1_4=1&amp;dns2_1=2&amp;dns2_2=2&amp;dns2_3=2&amp;dns2_4=2</code></pre></div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/94941a06331f4aff885f34f0e099e712?s=256&amp;d=retro" alt="C4"><span class="post-comment-author">C4</span><div class="post-comment-content">@Adrian Pastor

Good article, deffintley good to know and another thing to check/lookout for on home routers.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">Thanks for the feedback C4. I'm sure that if everyone checked their devices' web interface for this type of auth bypass, many devices would be found to be vulnerable!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/0167f880df81b3301d51444696d8728c?s=256&amp;d=retro" alt="ikkuhqhp"><span class="post-comment-author">ikkuhqhp</span><div class="post-comment-content">is there a good application for crafting packets on windows, since that seems to be the best way of trying these "hacks"?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b7d4ae90b574bd0ee6e3c4e01e192998?s=256&amp;d=retro" alt="Martin Theiler"><span class="post-comment-author">Martin Theiler</span><div class="post-comment-content">Even i would like to get some more knowledge on setting up home or institutional routers. Anybody up for a link?</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2025 <a href=""></a>. All rights reserved.</p></footer></body></html>