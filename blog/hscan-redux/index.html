<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>HScan Redux</title><meta name="description" content="Inspired by Michal Zalewski's recent Firefox bug hunt, I decided to give it a go and see what I can come up with. We all know how vulnerable Firefox and other browsers are. This is the reason why I am not particularly interested in finding specific browser bugs."><meta property="name" content="HScan Redux"><meta itemprop="name" content="HScan Redux"><meta property="description" content="Inspired by Michal Zalewski's recent Firefox bug hunt, I decided to give it a go and see what I can come up with. We all know how vulnerable Firefox and other browsers are. This is the reason why I am not particularly interested in finding specific browser bugs."><meta itemprop="description" content="Inspired by Michal Zalewski's recent Firefox bug hunt, I decided to give it a go and see what I can come up with. We all know how vulnerable Firefox and other browsers are. This is the reason why I am not particularly interested in finding specific browser bugs."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhscan-redux%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhscan-redux%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/hscan-redux/"><meta property="og:title" content="HScan Redux"><meta property="og:description" content="Inspired by Michal Zalewski's recent Firefox bug hunt, I decided to give it a go and see what I can come up with. We all know how vulnerable Firefox and other browsers are. This is the reason why I am not particularly interested in finding specific browser bugs."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhscan-redux%2F?w=1024"><meta name="twitter:title" content="HScan Redux"><meta name="twitter:description" content="Inspired by Michal Zalewski's recent Firefox bug hunt, I decided to give it a go and see what I can come up with. We all know how vulnerable Firefox and other browsers are. This is the reason why I am not particularly interested in finding specific browser bugs."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhscan-redux%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">HScan Redux</h1><div class="date">Fri, 23 Feb 2007 12:28:43 GMT</div><div class="author">by pdp</div><div id="post-content"><p>Inspired by <a href="http://lcamtuf.coredump.cx/">Michal Zalewski</a>&#39;s recent Firefox bug hunt, I decided to give it a go and see what I can come up with. We all know how vulnerable Firefox and other browsers are. This is the reason why I am not particularly interested in finding specific browser bugs.</p>
<p>This vulnerability is not a reworked version of <a href="http://jeremiahgrossman.blogspot.com/2006/08/i-know-where-youve-been.html">Jeremiah Grossman history hack</a>. It is completely different and it should be treated as a new issue. The peculiar thing about this vulnerability is that it tells you which URLs you have attended during the current browser session (the last time you opened your browser). I am not sure how useful this really is.</p>
<p>Keep in mind that attackers can abuse this vulnerability to extract valuable information about your browsing habits. Attackers can also use this hack to precisely detect whether you are logged into your router management interface, for example. This hack can also be used to detect your router type and version as well. Based on this information, attackers might be able to compromise the integrity of your network.</p>
<p><em>The POC is located <a href="/files/2007/02/hscan-redux-poc.htm">here</a>. If all checks show up as <strong>NOT visited</strong>, then visit one of the listed URLs and retest again.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt=".mario"><span class="post-comment-author">.mario</span><div class="post-comment-content">This is a very interesting approach of history stealing! I didn't know about the about:cache-entry directive. I guess i will spend some time the next days to check what other about: directives are available and maybe exploitable...

Great find!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">.mario about:cache is actually a protocol to access Firefox internal cache information. There are a few other about: directives. about:mozilla is fun.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="duk"><span class="post-comment-author">duk</span><div class="post-comment-content">Firefox 2.0.0.2 is also vulnerable</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt=".mario"><span class="post-comment-author">.mario</span><div class="post-comment-content">What about XHRing the URL about:cache?device=disk and parsing out all URLs from the response body via regex? Then you'd have a complete history theft - guess i have to test that tomorrow.

BTW, it's .mario with an o...</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">sorry man, fixed it. I am almost certain that you cannot read about:cache with XMLHttpRequest.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt=".mario"><span class="post-comment-author">.mario</span><div class="post-comment-content">Thanx ;) I did a little quick test and from what i acn say it is hard to impossible. I will give it a deeper look tomorrow.

I used it on a jquery featured site trying this:

<pre><code>$.get('about:cache?device=disk', function(response){alert(response);});</code></pre></div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="-am"><span class="post-comment-author">-am</span><div class="post-comment-content">Works on FF 1.5.0.9/WinXP. Good catch :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">It works on Mac OS 10.4.8 Firefox 2.0.0.1 too.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="dusoft"><span class="post-comment-author">dusoft</span><div class="post-comment-content">Does not work for Firefox 2.0.0.1 under Linux</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adriaan"><span class="post-comment-author">Adriaan</span><div class="post-comment-content">Indeed. Does not work under gentoo linux, 2.0.0.1.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Jordan"><span class="post-comment-author">Jordan</span><div class="post-comment-content">Doesn't work for me, OS X, FF 2.0.0.1 but it's probably SafeCache or SafeHistory blocking it.

http://safecache.com/
http://safehistory.com/</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="MustLive"><span class="post-comment-author">MustLive</span><div class="post-comment-content">Don't work in my Mozilla 1.7.7 :P (and in old version of Firefox).

Old version browsers rulez! :-) Want to save your history - use old school browsers.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="mozzio"><span class="post-comment-author">mozzio</span><div class="post-comment-content">No surprise, any version of the Mozilla browsers with NoScript installed is immune.

http://noscript.net</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>