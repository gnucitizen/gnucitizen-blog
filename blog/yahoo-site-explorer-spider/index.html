<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Yahoo Site Explorer Spider</title><meta name="description" content="Here you go. On this page you will find a POC of a client-side spider that is based on the top of Yahoo Site Explorer `PageData` service which you can read more about from this page."><meta property="name" content="Yahoo Site Explorer Spider"><meta itemprop="name" content="Yahoo Site Explorer Spider"><meta property="description" content="Here you go. On this page you will find a POC of a client-side spider that is based on the top of Yahoo Site Explorer `PageData` service which you can read more about from this page."><meta itemprop="description" content="Here you go. On this page you will find a POC of a client-side spider that is based on the top of Yahoo Site Explorer `PageData` service which you can read more about from this page."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fyahoo-site-explorer-spider%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fyahoo-site-explorer-spider%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/yahoo-site-explorer-spider/"><meta property="og:title" content="Yahoo Site Explorer Spider"><meta property="og:description" content="Here you go. On this page you will find a POC of a client-side spider that is based on the top of Yahoo Site Explorer `PageData` service which you can read more about from this page."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fyahoo-site-explorer-spider%2F?w=1024"><meta name="twitter:title" content="Yahoo Site Explorer Spider"><meta name="twitter:description" content="Here you go. On this page you will find a POC of a client-side spider that is based on the top of Yahoo Site Explorer `PageData` service which you can read more about from this page."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fyahoo-site-explorer-spider%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Yahoo Site Explorer Spider</h1><div class="date">Sun, 15 Jul 2007 21:47:10 GMT</div><div class="author">by pdp</div><div id="post-content"><p>Here you go. On this page you will find a <a href="/files/2007/07/spider.htm">POC</a> of a client-side spider that is based on the top of Yahoo Site Explorer <code>PageData</code> service which you can read more about from <a href="http://developer.yahoo.com/search/siteexplorer/V1/pageData.html">this</a> page.</p>
<p>I&#39;ve being talking about client-side spiders for quite some time now over <a href="/blog/traversing-the-web">here</a> and <a href="/blog/javascript-spider/">here</a> and I even came up with POC based on Yahoo Pipes for my OWASP presentation on &quot;Advanced Web Hacking Reveled&quot;, which you can find over <a href="/blog/6th-owasp-conference/">there</a>.</p>
<p>Web spiders in particular are nothing interesting. They have been with us for quite some time now and there is no point of discussing what they can do. Though, spiders are the first step towards a successful web attack. Obviously, in order to find the weaknesses within a web application, first of all we have to enumerate all entry points. This is where we launch spiders. Sometimes spiders are semi-automatic or completely automatic and may contain attack payloads.</p>
<p>There are plenty of wormish spiders around over the Web, but most of them require server-side support. Fortunately for us or perhaps not, this is no longer the case when it comes to AJAX technologies and the fast developing world of Web2.0. Today, it is possible to write spiders that are completely client-side based, i.e. written entirely in JavaScript.</p>
<p>&quot;But how is that possible? I though JavaScript cannot access pages outside of the current origin. Is that a browser bug?&quot; Nope! This is not a browser bug. It is a feature of the Web. In my case, I am using Yahoo to provide me with an index of resources crowed by theirs and Google&#39;s spiders. This index is provided as a JSON service. Here is a description of what the service does:</p>
<blockquote>
<p>The Page Data service allows you to retrieve information about the subpages in a domain or beneath a path that exist within the Yahoo! index. <a href="http://developer.yahoo.com/search/siteexplorer/V1/pageData.html">Yahoo Developer</a></p>
</blockquote>
<p>&quot;This is great but how can attackers use this service?&quot; Well the most obvious way to make use of Yahoo Site Explorer service is in the situations where attackers want to find bugs in other sites in real time. Billy Hoffman and I have presented several real life scenarios how XSS vulnerabilities can be found almost automatically from withing the client without the support from a server side technology. This is somewhat dangerous because worms can be written entirely with client-side languages such as JavaScript or ActionScrpt, which way cooler than using boring general purpose languages.</p>
<p>You see, worms are often quite stupid in nature. They propagate either too fast or too slow. Very often, they are static and attack from specific IP ranges. During the first stage, we are able see a raise of particular type of traffic that originates from a particular geographical region. In order to stop further propagation, we can simply block the malicious traffic based on the worm signature. Game Over for the worm. The good guys win!</p>
<p>The spider that I wrote is anything by malicious. It just spiders. However, keep in mind that it will take no time to make it equipped with the latest client-side and server-side exploits. So, here is the spider&#39;s source code:</p>
<pre><code>[/files/2007/07/spider.js](/files/2007/07/spider.js)

_and this is how I use it:_

[/files/2007/07/spider-init.js](/files/2007/07/spider-init.js)</code></pre><p><em>Keep in mind that this spider is ultra fast. It does only several connects in order to obtain the entire directory structure of the targeted website. You can launch the POC from <a href="/files/2007/07/spider.htm">here</a>.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/1d95d2324345e3dd2e41d6066cc1b492?s=256&amp;d=retro" alt="David Kierznowski"><span class="post-comment-author">David Kierznowski</span><div class="post-comment-content">Nice proof of concept. I agree, the speed of this spider and the depth option is awesome! Only a technical question, but can we call this a web spider as it doesn't really spider the site but rather fetches pages already indexed by Yahoo?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Interesting question. I am not quite sure, I must say. From my prospective, it is still a spider. However, what name do you think will suit best for a tool like this one?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/1d95d2324345e3dd2e41d6066cc1b492?s=256&amp;d=retro" alt="David Kierznowski"><span class="post-comment-author">David Kierznowski</span><div class="post-comment-content">Yahoo calls it "Site Explorer" :) however, its interesting to me that the service supports a ping and update feature, so maybe web spider is just fine.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">You are right. Although I seriously doubt that Yahoo will craw the pinged website right away, more likely it will schedule it for some latter point, attackers that are interested in particular sites can ping for updates constantly thus ensuring that Yahoo has the latest index.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">nice one pdp. I'm really impressed by the speed of the results! Couldn't believe it! damn you, you got me excited about this, even though I have other exciting toys to play with on my todo list :)

Regarding the name I would call it a "passive spider", since it doesn't actually visit the target site, which makes it more ideal from the cracker's perspective.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">heh, I am working on another one which allows you to perform XSS scans right from the browser.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/060a68a5bccbda542386f67cbaa90012?s=256&amp;d=retro" alt="Antonio Vivaldi"><span class="post-comment-author">Antonio Vivaldi</span><div class="post-comment-content">I only got excited until I read the code.  I need a JS spider that actually HITS the site (not fetches pages from a pre-spidered list of yahoo's).

The Web 2.0 world needs a new JS spider to handle link-checking, perf stats and a host of other things.  AJAX components and DHTML screw every spider that is not based on JS and a DOM.

Where can we go?  Has anyone written a true JS and DOM based spider (like a FF plug in) that actually spiders???</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">it is not possible to construct true AJAX spider. Same Origin Policies apply.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2021 <a href=""></a>. All rights reserved.</p></footer></body></html>