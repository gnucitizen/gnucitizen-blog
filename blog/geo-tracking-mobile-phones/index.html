<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>GEO-tracking Mobile Phones</title><meta name="description" content="For those of you who haven't got the time to catch up with some of the latest developments around all-mighty iPhone, I highly recommend H. D. Moore's Cracking the iPhone series where he explains how to crack open the device with the well known libtiff vulnerability that was affecting the Sony's PSP, but with a twist. In this post I am going to introduce you a technique for GEO-tracking the iPhone, or any other mobile phone, after successful exploitation. Keep in mind that all you are going to see is a general description of an attack scenario. I am still waiting for my iPhone, so I haven't coded anything for it yet."><meta property="name" content="GEO-tracking Mobile Phones"><meta itemprop="name" content="GEO-tracking Mobile Phones"><meta property="description" content="For those of you who haven't got the time to catch up with some of the latest developments around all-mighty iPhone, I highly recommend H. D. Moore's Cracking the iPhone series where he explains how to crack open the device with the well known libtiff vulnerability that was affecting the Sony's PSP, but with a twist. In this post I am going to introduce you a technique for GEO-tracking the iPhone, or any other mobile phone, after successful exploitation. Keep in mind that all you are going to see is a general description of an attack scenario. I am still waiting for my iPhone, so I haven't coded anything for it yet."><meta itemprop="description" content="For those of you who haven't got the time to catch up with some of the latest developments around all-mighty iPhone, I highly recommend H. D. Moore's Cracking the iPhone series where he explains how to crack open the device with the well known libtiff vulnerability that was affecting the Sony's PSP, but with a twist. In this post I am going to introduce you a technique for GEO-tracking the iPhone, or any other mobile phone, after successful exploitation. Keep in mind that all you are going to see is a general description of an attack scenario. I am still waiting for my iPhone, so I haven't coded anything for it yet."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fgeo-tracking-mobile-phones%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fgeo-tracking-mobile-phones%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/geo-tracking-mobile-phones/"><meta property="og:title" content="GEO-tracking Mobile Phones"><meta property="og:description" content="For those of you who haven't got the time to catch up with some of the latest developments around all-mighty iPhone, I highly recommend H. D. Moore's Cracking the iPhone series where he explains how to crack open the device with the well known libtiff vulnerability that was affecting the Sony's PSP, but with a twist. In this post I am going to introduce you a technique for GEO-tracking the iPhone, or any other mobile phone, after successful exploitation. Keep in mind that all you are going to see is a general description of an attack scenario. I am still waiting for my iPhone, so I haven't coded anything for it yet."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fgeo-tracking-mobile-phones%2F?w=1024"><meta name="twitter:title" content="GEO-tracking Mobile Phones"><meta name="twitter:description" content="For those of you who haven't got the time to catch up with some of the latest developments around all-mighty iPhone, I highly recommend H. D. Moore's Cracking the iPhone series where he explains how to crack open the device with the well known libtiff vulnerability that was affecting the Sony's PSP, but with a twist. In this post I am going to introduce you a technique for GEO-tracking the iPhone, or any other mobile phone, after successful exploitation. Keep in mind that all you are going to see is a general description of an attack scenario. I am still waiting for my iPhone, so I haven't coded anything for it yet."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fgeo-tracking-mobile-phones%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">GEO-tracking Mobile Phones</h1><div class="date">Thu, 18 Oct 2007 11:11:47 GMT</div><div class="author">by pdp</div><div id="post-content"><p>For those of you who haven&#39;t got the time to catch up with some of the latest developments around all-mighty iPhone, I highly recommend <a href="http://www.metasploit.com/">H. D. Moore</a>&#39;s <a href="http://blog.metasploit.com/2007/10/cracking-iphone-part-21.html">Cracking the iPhone</a> series where he explains how to crack open the device with the well known libtiff vulnerability that was affecting the Sony&#39;s PSP, but with a twist. In this post I am going to introduce you a technique for GEO-tracking the iPhone, or any other mobile phone, after successful exploitation. Keep in mind that all you are going to see is a general description of an attack scenario. I am still waiting for my iPhone, so I haven&#39;t coded anything for it yet.</p>
<p>Before we dive into the subject I would like to clarify what I mean by saying <strong>GEO-tracking</strong>. The prefix <em>geo</em> comes from the Greek word <em>ge_, meaning Earth, ground or island. Therefore, _Geography</em> (<em>geo</em> and <em>graphia</em> &quot;writing&quot;) is the study of the features of the Earth. In that respect, _geo-_tracking is nothing more but the science behind tracking/mapping objects in motion on a map. Thus, in this post we are going to discuss a technique for pinpointing mobile phones in motion on a map and as such follow their owner&#39;s behavior.</p>
<p>The obvious way of tracking an already exploited phone is by means of GPS (Global Positioning System). Correct! However, given the fact that most mobile phones do not posses this feature, including the iPhone, we need to leave it for now and find something else that will give us to one degree or another a similar result. As you probably know, mobile phones are also known as cellulars, an old name (technology) which refers to circuit-switched voice telephone communication via cellular radio channels. Speaking generally, phones connect to cell phone towers. The density/availability of these towers affect the strength/availability of the signal your mobile phone gets. Keep in mind that I am very general here.</p>
<p>At any given moment your mobile phone has the geographical coordinates of the current cell phone tower it is connected to. These coordinates are represented by four numbers: <strong>cellid</strong> (The identifier of the cellular tower), <strong>lac</strong> (The Location Area Code), <strong>mnc</strong> (The Mobile Network Code) and <strong>mcc</strong> (The Mobile Country Code). You probably see where I am going with this.</p>
<p>When a mobile phone is in motion, it will switch between different cells and such ensuring continuous signal. The cellid, lac, mnc and mcc numbers will also change. If we record these numbers when a change occurs, we will have the history of the areas that phone has visited. These numbers can be translated into geographical coordinates by using any of the available public services. My personal <strong>free</strong> favorite is Yahoo&#39;s <a href="http://developer.yahoo.com/yrb/zonetag/locatecell.html">ZoneTag</a> Cell Location API. A simple request to the service looks like this:</p>
<pre><code>[http://zonetag.research.yahooapis.com/services/rest/V1/cellLookup.php?apptoken=ZoneTagDemoToken&amp;**cellid**=48627380&amp;**lac**=201&amp;**mnc**=15&amp;**mcc**=234](http://zonetag.research.yahooapis.com/services/rest/V1/cellLookup.php?apptoken=ZoneTagDemoToken&amp;cellid=48627380&amp;lac=201&amp;mnc=15&amp;mcc=234)

The above request will result into a XML document with information about the location of the cell phone tower. In my case, this is Hammersmith, London:

&lt;rsp stat=&quot;ok&quot;&gt;
    &lt;Location&gt;
        &lt;Country cell=&quot;current&quot; source=&quot;user&quot;&gt;**United Kingdom**&lt;/Country&gt;
    &lt;/Location&gt;
    &lt;Location&gt;
        &lt;Country cell=&quot;current&quot; source=&quot;generic&quot;&gt;**United Kingdom**&lt;/Country&gt;
        &lt;City cell=&quot;current&quot; source=&quot;generic&quot;&gt;**Hammersmith**&lt;/City&gt;
    &lt;/Location&gt;
&lt;/rsp&gt;</code></pre><p>Notice that the information is not very specific. Depending on the quality of the database, you will get more or less information about the cell. But you get the idea.</p>
<p>If the attacker continuously captures the information given from the cell phone towers, she will be able to tell the location of the mobile by guessing the area or doing some crazy computation geometry (triangulation) as described by this <a href="http://www.ncg.knaw.nl/Publicaties/Groen/pdf/44VanOosterom.pdf">paper</a>. This information can be placed on a map which tracks the mobile phone and predicts the direction. For that purpose, the attacker can use something like Google Maps API or preferably Microsoft&#39;s Live Maps Birds Eye 3D view as shown on the video bellow:</p>
<iframe class="video" src="//www.youtube.com/embed/r4L4T1pUZUU" frameborder="0" allowfullscreen></iframe>

<p>In some cases the attacker could combine the information obtained from the cell phone towers and the GPS (if there is any) in order to get even more accurate information about the current position of the mobile phone. This technique can be applied on any other phone and can be trivially automated for Blackberries using their development SDK.</p>
<h3 id="detection-and-prevention">Detection and Prevention</h3>
<p>If you are not technically familiar with your phone, there is not much you can do to protect yourself from these kinds of stuff. However, you might be able to detect their behavior. If your mobile phone is constantly running out of power or it is always worm, this is a good indicator that something malicious is going on in the background. It is recommended that you inform your mobile phone provider about your observations and keep away from the device for a while even if this means that you cannot enjoy your brand new iPhone. Your privacy should be above all other things.</p>
<p><em>I hope that the post was interesting. Let me know if you have any other ideas or suggestions.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/44c5e290ccf283471210752d0b1ed6df?s=256&amp;d=retro" alt="djteller"><span class="post-comment-author">djteller</span><div class="post-comment-content">I smell a new Payload :)

Reverse Shell, Bind Shell, Geo-Tracker :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/9ea891f23f0d65a97a81598c84c6eb6e?s=256&amp;d=retro" alt="HD"><span class="post-comment-author">HD</span><div class="post-comment-content">This is how you do it on the iPhone:
http://iphone-wireless.googlecode.com/svn/trunk/CellStumbler/</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">nice one, so now all you need is a way to get this information out on a regular basis and you have a bug!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">Definitely a payload worth it including on a exploit. 

However, I can also see legitimate purposes for this. For instance, why pay a commercial service to track you mobile (in case it gets stolen or you want your family to know where you are), when you can code a small application which retrieves the cell data and translates it to a geographical location using a web service? 

Just another application of this technique worth it considering.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/413f6c5268f39e1b195c24ac02b49c4a?s=256&amp;d=retro" alt="Griflet"><span class="post-comment-author">Griflet</span><div class="post-comment-content">Hello GNUcitizens,

I enjoy a lot all your ideas and your work. Personally, I'd love to track my phone without the use of a GPS. I'd like to instantly see my track on gmaps on my mobile. I would also like to add exif data with the approx. coords. to the snapshots I take with it. Can you show us the way?

Keep up the creativity and art flowing,
Guillaume</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/a2728f91bcbe3460f0e15fe4ef263dfe?s=256&amp;d=retro" alt="Anon"><span class="post-comment-author">Anon</span><div class="post-comment-content">There used to be a related hack for the Motorola E1 Rokr phone, involving a modified copy of iTunes. It knew which SIM was supposed to be in the phone; if the SIM changed (i.e. it was stolen, and the SIM replaced) it would start silently SMS'ing a user-definable list of numbers with the current cell tower details (and obviously its new phone number).</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Here is a video that describes the same technique but in a bit more visual way, of course, without too much of tech information:

<div class="screen"><object width="425" height="355"><param name="movie" value="//www.youtube.com/v/v6gqipmbcok&rel=1&border=0"></param><param name="wmode" value="transparent"></param><embed src="//www.youtube.com/v/v6gqipmbcok&rel=1&border=0" type="application/x-shockwave-flash" wmode="transparent" width="425" height="355"></embed></object></div></div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2021 <a href=""></a>. All rights reserved.</p></footer></body></html>