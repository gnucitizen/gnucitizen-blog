<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>JavaScript Visited Link Scanner</title><meta name="description" content="This is a technique which I learned from Jeremiah Grossman and his presentation on JavaScript malware. Please, keep all the credits for this finding to Jeremiah."><meta property="name" content="JavaScript Visited Link Scanner"><meta itemprop="name" content="JavaScript Visited Link Scanner"><meta property="description" content="This is a technique which I learned from Jeremiah Grossman and his presentation on JavaScript malware. Please, keep all the credits for this finding to Jeremiah."><meta itemprop="description" content="This is a technique which I learned from Jeremiah Grossman and his presentation on JavaScript malware. Please, keep all the credits for this finding to Jeremiah."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fjavascript-visited-link-scanner%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fjavascript-visited-link-scanner%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/javascript-visited-link-scanner/"><meta property="og:title" content="JavaScript Visited Link Scanner"><meta property="og:description" content="This is a technique which I learned from Jeremiah Grossman and his presentation on JavaScript malware. Please, keep all the credits for this finding to Jeremiah."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fjavascript-visited-link-scanner%2F?w=1024"><meta name="twitter:title" content="JavaScript Visited Link Scanner"><meta name="twitter:description" content="This is a technique which I learned from Jeremiah Grossman and his presentation on JavaScript malware. Please, keep all the credits for this finding to Jeremiah."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fjavascript-visited-link-scanner%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">JavaScript Visited Link Scanner</h1><div class="date">Tue, 15 Aug 2006 20:50:51 GMT</div><div class="author">by pdp</div><div id="post-content"><p>This is a technique which I learned from <a href="http://jeremiahgrossman.blogspot.com/">Jeremiah Grossman</a> and his presentation on JavaScript malware. Please, keep all the credits for this finding to Jeremiah.</p>
<p>The <a href="/files/2006/08/visitedlinkscanner.js">POC</a> presented here is my improved version of the POC presented in BlackHat. I made it work in IE6, IE7, Firefox and Opera. My main challenge was IE6. IE6 is very nasty when dealing with dynamically generated style sheets. However, these can be easy solved by reusing the current style sheet. If you are interested how it works just read the source code. It is worth mentioning that the IE bug was also fixed in <a href="/blog/attackapi">AttackAPI</a>.</p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d4bb81c0798269a57e1b6dcec17971c4?s=256&amp;d=retro" alt="Kalyani"><span class="post-comment-author">Kalyani</span><div class="post-comment-content">Wow, the code looks awesome, but is there any way that I store all the visited pages to a text document. I need it for my project.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Well, you need a server that will handle all the gathered data and then store it into a simple text file. You can use PHP or any other scripting language for this purpose.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/30214950c4a81efba1551dc0c0706221?s=256&amp;d=retro" alt="Nadav"><span class="post-comment-author">Nadav</span><div class="post-comment-content">Hi, I have tested this javascript-visited-link-scanner on several computers that have IE7 installed. Unfortuantly it didn't worked. Am i doing something wrong, Or this a known problem with this java script scanner?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/45e4cc6f720ec3b67b56959c9599188d?s=256&amp;d=retro" alt="jk"><span class="post-comment-author">jk</span><div class="post-comment-content">what is this use for?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">jk, it is useful if you want to detect where the user has been before arriving on the malicious site.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/003a01f8feba47addb0ad9f5b1ab2139?s=256&amp;d=retro" alt="alf"><span class="post-comment-author">alf</span><div class="post-comment-content">Your demo doesn't work in Safari. (the approach works, though)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">alf, that might be the case. keep in mind though that the latest stuff are inside <a href="http://www.gnucitizen.org/blog/attackapi" rel="nofollow">AttackAPI</a>.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d4bb81c0798269a57e1b6dcec17971c4?s=256&amp;d=retro" alt="kalyani"><span class="post-comment-author">kalyani</span><div class="post-comment-content">Hey, I looked at java script, can you explain me where are you stealing the history from, I didn't get the trick</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/199578653ce0a86a110305701a2c7536?s=256&amp;d=retro" alt="dude1"><span class="post-comment-author">dude1</span><div class="post-comment-content">yeah no go in ie6 windows for me... kind of pissed I didn't test it on the site beforehand. :(</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">the technique has been improved drastically since its discovery. You should be able to find better code in AttackAPI. Nevertheless, the current version of AttackAPI is a bit broken. I will try to fix it at some point in the future when I have got some time.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>