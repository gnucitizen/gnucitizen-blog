<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>OpenID - A Security Story</title><meta name="description" content="The other day Eugene Tsyrklevich has pinged me about his talk on OpenID security in regards to my article on Identity2.0 security issues that we face today. Eugene has presented an co-authored his research with Vlad Tsyrklevich at this year's BlackHat US. You can get the slides from over here and read the whitepaper from over there."><meta property="name" content="OpenID - A Security Story"><meta itemprop="name" content="OpenID - A Security Story"><meta property="description" content="The other day Eugene Tsyrklevich has pinged me about his talk on OpenID security in regards to my article on Identity2.0 security issues that we face today. Eugene has presented an co-authored his research with Vlad Tsyrklevich at this year's BlackHat US. You can get the slides from over here and read the whitepaper from over there."><meta itemprop="description" content="The other day Eugene Tsyrklevich has pinged me about his talk on OpenID security in regards to my article on Identity2.0 security issues that we face today. Eugene has presented an co-authored his research with Vlad Tsyrklevich at this year's BlackHat US. You can get the slides from over here and read the whitepaper from over there."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fopenid-a-security-story%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fopenid-a-security-story%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/openid-a-security-story/"><meta property="og:title" content="OpenID - A Security Story"><meta property="og:description" content="The other day Eugene Tsyrklevich has pinged me about his talk on OpenID security in regards to my article on Identity2.0 security issues that we face today. Eugene has presented an co-authored his research with Vlad Tsyrklevich at this year's BlackHat US. You can get the slides from over here and read the whitepaper from over there."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fopenid-a-security-story%2F?w=1024"><meta name="twitter:title" content="OpenID - A Security Story"><meta name="twitter:description" content="The other day Eugene Tsyrklevich has pinged me about his talk on OpenID security in regards to my article on Identity2.0 security issues that we face today. Eugene has presented an co-authored his research with Vlad Tsyrklevich at this year's BlackHat US. You can get the slides from over here and read the whitepaper from over there."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fopenid-a-security-story%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">OpenID - A Security Story</h1><div class="date">Mon, 20 Aug 2007 10:15:48 GMT</div><div class="author">by
<a href="/members/pdp.html">pdp</a></div><div id="post-content"><p>The other day Eugene Tsyrklevich has pinged me about his talk on OpenID security in regards to my <a href="/blog/identity-20-security">article</a> on Identity2.0 security issues that we face today. Eugene has presented an co-authored his research with Vlad Tsyrklevich at this year&#39;s BlackHat US. You can get the slides from over <a href="https://www.blackhat.com/presentations/bh-usa-07/Tsyrklevich/Presentation/bh-usa-07-tsyrklevich.pdf">here</a> and read the whitepaper from over <a href="https://www.blackhat.com/presentations/bh-usa-07/Tsyrklevich/Whitepaper/bh-usa-07-tsyrklevich-WP.pdf">there</a>.</p>
<p>To summarize, the following issues are present with the current implementation of OpenID:</p>
<ul>
<li><strong>Phishing Attacks</strong> - this is probably the biggest concern when dealing with OpenID. Users may be tricked into providing their credentials to 3rd-party websites.</li>
<li><strong>Man-in-the-middle Attacks</strong> - the connection is negotiated over DH (Diffie-Hellman) which is subjected to interception attacks. Ensure that you are using HTTPS.</li>
<li><strong>Replay Attacks</strong> - the URL from the relaying party can be sniffed, unless over HTTPS, and as such being replayed. This is not that critical since if the attacker can sniff the wire(less) they can as easily wait for the authentication to complete and then steal the session identifier.</li>
<li><strong>CSRF Attacks</strong> - once the user is logged in, attackers might be able to execute a series of CSRF (Cross-site request forgery) attacks against the identity provider or other sites where the user is logged in. &quot;OpenID makes authentication easer so why don&#39;t we login everywhere?&quot;</li>
<li><strong>XSS Attacks</strong> - once the user is logged in attackers might be able to execute a series of XSS (Cross-site scripting) attacks against the identity provider, in which case they will be able to hijack the entire on-line use presence, or other sides, in which case the attacker will be able to gain access to the session. &quot;Again, OpenID makes authentication easer so why don&#39;t we login everywhere, at the same time? Sounds like a good idea!&quot;</li>
<li><strong>Miscellaneous Attacks</strong> - all other types of Web Attacks are applicable to OpenID clients and servers. The only difference is that the result may turn to be quite nasty.</li>
</ul>
<p>Other then that, OpenID is a great idea. It works and it scales quite well. However, make sure that you are protected against the above mentioned attacks. I would suggest for browser vendors to include builtin security features such as HTTPS should be enforced by default, CSRF against the identity provider domain should not be possible, etc. This can be accomplished with quite simple plugin for Firefox. Any takers?</p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/129b6f1bf6c627d5ca57779bd15ea649?s=256&amp;d=retro" alt="Jordan"><span class="post-comment-author">Jordan</span><div class="post-comment-content">I imagine a variant of this greasemonkey script would work:

http://userscripts.org/scripts/show/1404

At least for forcing HTTPS.  CSRF against identity provider domain requires a bit more thought.  For example -- aren't the open id pictures stored on their domain?  And surely we want to allow linking to the domain in general.  Separating out which requests are potentially malicious CSRF would require all "action" urls to be obvious on the domain.  To be honest, I haven't looked at Open ID yet to know whether that's the case.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7f5964ed9f043821b46150632596ed9a?s=256&amp;d=retro" alt="Gareth Heyes"><span class="post-comment-author">Gareth Heyes</span><div class="post-comment-content">I did a bit of OpenID security testing and I found many providers open to CSRF attacks. I found a exploit against MyOpenID and helped many others fix their problems. But I'm still not confident in OpenID security and providers need to up their game if it is to be ever considered for real world usage.

My exploit can be found here, if anyone finds it interesting:-
http://www.thespanner.co.uk/2007/06/29/openid-security-issues/</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Jordan, yes preventing CSRF is not an easy task. I personally don't know how this can be secured at browser level. Therefore, we need to relay on the remote website being responsible enough to take the necessary actions. The script you've provided is good but I was thinking is for the browser having the ability to detect the OpenID provider and force it in there.

Gareth, yes OpenID systems are full of CSRF today. It is not even funny. I don't know what developers were thinking when developing these systems. Thanks for the link.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7f5964ed9f043821b46150632596ed9a?s=256&amp;d=retro" alt="Gareth Heyes"><span class="post-comment-author">Gareth Heyes</span><div class="post-comment-content">@pdp

CSRF can be secured with form tokens and random page names. If the attacker doesn't know what the script is called then he can't perform a CSRF.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Gareth, yes of course, but what I meant is preventing CSRF on browser level... otherwise we relay on the external site getting their security model right.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/80d7b8935b953dabd63268177b7981f6?s=256&amp;d=retro" alt="Ronald"><span class="post-comment-author">Ronald</span><div class="post-comment-content">Indeed PDP, that is the biggest problem. Because the end-user is at risk here not the site owner persee. And I've pondered this question for a long time. Preventing it from happening in the browser is next to impossible. If we sitch to a different browser model we could potentially solve it.

I have ideas, but they are only ideas.

One of them is to sign all external content that is being requested. If it's unsigned it fails to load and thereby it prevents CSRF minimaly. The thing is, how do you sign it? if the browser must sign it, it must know the sites key. And there you have a key management problem.

Another idea is to disallow any Javascript inclusion below the head tag -which is the toughest to control in case of an XSS- therby making sure all Javascript inclusions are only done in the head, and they may not be dymanically be altered: so signing them is an option.

So I have a couple of hints &amp; clues, no absolute awnser. There is a lot to be investigated in this area.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Ronald, I see what u mean. However, I would rather not start with certificates and stuff. It will make it too damn difficult to work it. I cannot see this happening. Moreover, Web2.0 mashups wont fit into tis model. There must be something else... or maybe not. Maybe the Web is just screwed up from day one and this is how it will remain forever.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/426d0a0dcc1d942d2ac3addcf406c671?s=256&amp;d=retro" alt="mario"><span class="post-comment-author">mario</span><div class="post-comment-content">OpenID is not an authentication protocol. It is meant solely for homepage URL verification. It's not user-friendly and was never meant as generic login scheme for the web. It restricts itself to the technical experienced, so you can practically rule out phishing scams. The other security gaps might be troublesome, but hey, I see you are running Wordpress anyhow...</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2022 <a href=""></a>. All rights reserved.</p></footer></body></html>