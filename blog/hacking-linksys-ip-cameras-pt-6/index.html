<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Hacking Linksys IP Cameras (pt 6)</title><meta name="description" content="&gt; This article is a continuation of the following GNUCITIZEN articles: here, here, here, here and here."><meta property="name" content="Hacking Linksys IP Cameras (pt 6)"><meta itemprop="name" content="Hacking Linksys IP Cameras (pt 6)"><meta property="description" content="&gt; This article is a continuation of the following GNUCITIZEN articles: here, here, here, here and here."><meta itemprop="description" content="&gt; This article is a continuation of the following GNUCITIZEN articles: here, here, here, here and here."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-linksys-ip-cameras-pt-6%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-linksys-ip-cameras-pt-6%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-6/"><meta property="og:title" content="Hacking Linksys IP Cameras (pt 6)"><meta property="og:description" content="&gt; This article is a continuation of the following GNUCITIZEN articles: here, here, here, here and here."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-linksys-ip-cameras-pt-6%2F?w=1024"><meta name="twitter:title" content="Hacking Linksys IP Cameras (pt 6)"><meta name="twitter:description" content="&gt; This article is a continuation of the following GNUCITIZEN articles: here, here, here, here and here."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-linksys-ip-cameras-pt-6%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Hacking Linksys IP Cameras (pt 6)</h1><div class="date">Wed, 24 Feb 2010 07:18:29 GMT</div><div class="author">by pagvac</div><div id="post-content"><blockquote>
<p>This article is a continuation of the following GNUCITIZEN articles: <a href="/blog/hacking-linksys-ip-cameras-pt-1/">here</a>, <a href="/blog/hacking-linksys-ip-cameras-pt-2/">here</a>, <a href="/blog/hacking-linksys-ip-cameras-pt-3/">here</a>, <a href="/blog/hacking-linksys-ip-cameras-pt-4/">here</a> and <a href="/blog/hacking-linksys-ip-cameras-pt-5/">here</a>.</p>
</blockquote>
<p>As we know, there are several ways one could go about hunting for IP cameras on the net. The slowest way would be to portscan random IP addresses for certain ports and programmatically detect if the web interface of a given camera was available on the open ports found. This method definitely works, but it can be very time consuming as it consists of scanning random IP addresses hoping that we&#39;ll eventually come across the type of device we&#39;re interested in.</p>
<p>The second method, which would be much faster in finding our target devices, would be to use a <a href="http://www.google.co.uk/search?ie=UTF-8&amp;q=inurl:/img/vr.htm">search engine</a> and query content that is unique to our target devices (e.g.: URLs, HTML title). This method, popularized by <a href="http://www.hackersforcharity.org/ghdb/?function=summary&amp;cat=18">GHDB</a> is simple and effective. The only issue I find with this strategy is that many of these IP cameras found happen to respond very slowly. This is probably due to other curious individuals running the same searches and accessing the same cameras.</p>
<p>The third method which would allow you to find more hidden Linksys IP cameras (i.e.: not cached by search engines a.k.a. the <a href="http://www.ericdigests.org/2002-2/hidden.htm">hidden web</a>), would consist of bruteforcing subdomains within dynamic domain names (DDNS) used by our target devices (Linksys IP cameras in this case). For instance, the following are some of the dynamic domain names supported by the WVC54GCA and WVC80N Linksys IP camera models:</p>
<ul>
<li><code>linksys-cam.com</code></li>
<li><code>mylinksyscamera.com</code></li>
<li><code>mylinksyshome.com</code></li>
<li><code>mylinksyscam.com</code></li>
<li><code>mylinksysview.com</code></li>
<li><code>linksysremotecam.com</code></li>
<li><code>linksysremoteview.com</code></li>
<li><code>linksyshomemonitor.com</code></li>
</ul>
<h3 id="camera-discovery-process-through-subdomain-bruteforcing">Camera discovery process through subdomain bruteforcing</h3>
<p>We first save the aforementioned domains in a file, <code>doms</code> in this case. Then we use <a href="http://code.google.com/p/dnsmap/">dnsmap</a> to bruteforce subdomains for each of the domains included in <code>doms</code>.</p>
<p>Using dnsmap&#39;s built-in wordlist:</p>
<pre><code>$ for i in `cat doms`;do dnsmap $i -r ~/ -i 64.14.13.199,216.39.81.84&amp;done;</code></pre><p>Using a user-supplied wordlist, <code>wordlist_TLAs.txt</code> in this case, which is a three-letter acronym wordlist included with dnsmap v0.30:</p>
<pre><code>$ for i in `cat doms`;do dnsmap $i -w wordlist_TLAs.txt -r ~/ -i 64.14.13.199,216.39.81.84&amp;done;</code></pre><p>NOTE: dnsmap&#39;s <code>-i</code> option allows ignoring user-supplied IP addresses from the results. In this case, 64.14.13.199 and 216.39.81.84 belong to the <a href="http://www.tzo.com/">DDNS service provider</a>, and would therefore be regarded as false positives in this case (we&#39;re only interested in IP cameras setup by their respective owners after all). For more info on how to use dnsmap, checkout the <a href="http://code.google.com/p/dnsmap/source/browse/trunk/README.txt">README</a> file.</p>
<p>We then parse the IP addresses of the subdomains discovered by dnsmap:</p>
<pre><code>$ grep \# dnsmap*.txt | awk &#39;{print $4}&#39; | sort | uniq &gt; ips.txt</code></pre><p>Next, we scan for ports that could potentially be used by a Linksys IP camera web server. In this case, we choose TCP ports 80, 1024 and 1025 as candidates:</p>
<pre><code>$ sudo nmap -v -T4 -n -P0 -sS -p80,1024,1025 -iL ips.txt -oA nmap_http_ports.`date +%Y-%m-%d-%H%M%S`</code></pre><p>This leaves us with a lot of discovered services, but we don&#39;t quite yet know which of them correspond to actual Linksys IP cameras web interfaces. There are many ways to fingreprint the web server of a Linksys IP camera. In this case we chose to create our own <a href="http://freeworld.thc.org/thc-amap/">amap</a> response signature, and then scan the open ports with amap.</p>
<p>Before amap is capable of identifying our target Linksys IP cams, the following response signature needs to be added to <code>appdefs.resp</code>, and amap then needs to be recompiled. Otherwise amap won&#39;t take the new signature into account:</p>
<pre><code>http-linksys-cam::tcp::^HTTP/.*\nServer: thttpd/.*Accept-Ranges: bytes.*WVC</code></pre><p>Please note that the previous amap response signature was only tested against the WVC54GCA and WVC80N Linksys IP camera models. So I&#39;m not sure if it will work against other models. You&#39;ve been warned!</p>
<p>Once recompiled, amap can be used to identify Linksys IP cameras from nmap&#39;s open ports results. </p>
<pre><code>$ amap -i nmap_http_ports.2010-02-22-102001.gnmap -R -S -o amap_results.`date +%Y-%m-%d-%H%M%S`</code></pre><p>We finally parse the IP addresses and open ports for all discovered Linksys IP cameras:</p>
<pre><code>$ grep http-linksys-cam amap_results.2010-02-22-102253 | awk &#39;{print $3}&#39; | cut -d \/ -f1
x.x.167.245:1024
x.x.228.231:1025
x.x.228.231:80
x.x.64.22:80
x.x.206.70:1024
x.x.31.4:1024
x.x.164.28:1024
_[snip]_</code></pre><p>At this point we have accomplished the task of creating a list of Linksys IP cameras without resorting to search engines or scanning random IP addresses. In order to discover more Linksys cameras, a more comprehensive wordlist would need to be used with dnsmap.</p>
<p>Of course, even further automation would be possible. For instance, an attacker may wish to programmatically identify which Linksys cameras from the previous list allowing video viewing to unauthenticated users:</p>
<pre><code class="language-bash">$ amapfile=amap_results.2010-02-22-102253; <span class="keyword">for</span> i <span class="keyword">in</span> `grep http-linksys-cam <span class="variable">$amapfile</span> | awk <span class="string">'{print $3}'</span> | cut -d \/ -f1`;<span class="keyword">do</span> url=<span class="string">"http://<span class="variable">$i</span>/img/main.cgi?next_file=main.htm"</span>; <span class="keyword">if</span> curl --connect-timeout 2 -s -I --url <span class="variable">$url</span> | grep ^<span class="string">"HTTP/1.1 501"</span>&gt;/dev/null;<span class="keyword">then</span> <span class="built_in">echo</span> <span class="variable">$url</span>;<span class="keyword">fi</span>;<span class="keyword">done</span>;
x.x.206.70:1024/img/main.cgi?next_file=main.htm
x.x.105.221:1024/img/main.cgi?next_file=main.htm
x.x.105.221:80/img/main.cgi?next_file=main.htm
x.x.181.195:1024/img/main.cgi?next_file=main.htm
x.x.243.154:1024/img/main.cgi?next_file=main.htm
x.x.243.154:1025/img/main.cgi?next_file=main.htm
x.x.30.196:1025/img/main.cgi?next_file=main.htm
_[snip]_</code></pre>
<p><em>In addition to automatically checking for anonymous video viewing on all cameras found, other tasks such as checking for default credentials (<code>admin</code>/<code>admin</code>) could also be scripted, although this will NOT be included in this post (or any other at GNUCITIZEN).</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/dbc9fe4f18aab307d580ef292b294426?s=256&amp;d=retro" alt="raven"><span class="post-comment-author">raven</span><div class="post-comment-content">What an awesome and innovative discovery method.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c59b1fbcf86370469862f4961d07b275?s=256&amp;d=retro" alt="packet_viper"><span class="post-comment-author">packet_viper</span><div class="post-comment-content">Now seeing that I have found several of these that have no password, isn't it possible to upload another piece of firmware and use this as an access point into a business or homes network? You know like DMS linux or a usb version of backtrack to continue an attack from there.  This is coming from a Pen-Tester and I am just curious at this point seeing as to how my brain is just running @ 1k a minute.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/0367b81839d31a5fa3d7bea79ef71b9e?s=256&amp;d=retro" alt="pagvac"><span class="post-comment-author">pagvac</span><div class="post-comment-content">@packet_viper: the camera's firmware is open source and available on the linksys site. so in theory you could modify the firmware and upload your own customized version.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/29debdfb33457d4ff7a01be81c94af89?s=256&amp;d=retro" alt="what"><span class="post-comment-author">what</span><div class="post-comment-content">I've written a simple Perl script that uses an HTTP method to accomplish the same thing a while back. It's very interesting to see someone else go at these cameras. I found a few in people's living rooms, and with IE/ActiveX, you can hear sound. Very creepy, and I am sure this breaks wiretapping laws, so I will say I did it for educational purposes only and not to monitor anyone.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/40fb2a4f6c88ac008a80b3ab235167c3?s=256&amp;d=retro" alt="Paul"><span class="post-comment-author">Paul</span><div class="post-comment-content">Anyone could tell me where I could find source code for WVC54GCA v 1.1, I really can't find it anywhere.

Thanks !</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/93ce59ea9096936b695d975bf4096e53?s=256&amp;d=retro" alt="Longpoke"><span class="post-comment-author">Longpoke</span><div class="post-comment-content">If there is an upload firmware button you can upload firmware. As long as there is no digital signature (that's properly validated) you can upload your own modified firmware.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/27e52d3e4e67cd0afc696d5680872aee?s=256&amp;d=retro" alt="L0RE"><span class="post-comment-author">L0RE</span><div class="post-comment-content">Hi,

I like Linux , I like it more open. If you would like to try http://rapidshare.com/files/424551784/WVC54GCA.bin No Warranty, you are self responsible for any Action.... usw.... Its now 1.1.01 Firmware  with Telnet enabled root password is toor for this firmware any comments are Welcome</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>