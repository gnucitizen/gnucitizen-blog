<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>BT Home Flub - Pwnin the BT Home Hub</title><meta name="description" content="OK, let me get to the point. The BT Home Hub, which is probably the most popular home router in the UK, is susceptible to critical vulnerabilities."><meta property="name" content="BT Home Flub - Pwnin the BT Home Hub"><meta itemprop="name" content="BT Home Flub - Pwnin the BT Home Hub"><meta property="description" content="OK, let me get to the point. The BT Home Hub, which is probably the most popular home router in the UK, is susceptible to critical vulnerabilities."><meta itemprop="description" content="OK, let me get to the point. The BT Home Hub, which is probably the most popular home router in the UK, is susceptible to critical vulnerabilities."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fbt-home-flub-pwnin-the-bt-home-hub%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fbt-home-flub-pwnin-the-bt-home-hub%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub/"><meta property="og:title" content="BT Home Flub - Pwnin the BT Home Hub"><meta property="og:description" content="OK, let me get to the point. The BT Home Hub, which is probably the most popular home router in the UK, is susceptible to critical vulnerabilities."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fbt-home-flub-pwnin-the-bt-home-hub%2F?w=1024"><meta name="twitter:title" content="BT Home Flub - Pwnin the BT Home Hub"><meta name="twitter:description" content="OK, let me get to the point. The BT Home Hub, which is probably the most popular home router in the UK, is susceptible to critical vulnerabilities."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fbt-home-flub-pwnin-the-bt-home-hub%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">BT Home Flub - Pwnin the BT Home Hub</h1><div class="date">Mon, 08 Oct 2007 16:41:42 GMT</div><div class="author">by pagvac</div><div id="post-content"><p>OK, let me get to the point. The <a href="http://en.wikipedia.org/wiki/BT_Home_Hub">BT Home Hub</a>, which is probably the most popular home router in the UK, is susceptible to critical vulnerabilities.</p>
<p>BT&#39;s plan is to sneak one of these boxes into every UK home. Not only does the BT Home Hub support broadband but also VoIP (BT Broadband Talk), <a href="http://en.wikipedia.org/wiki/Generic_Access_Network">UMA</a> mobile telephony (<a href="http://en.wikipedia.org/wiki/BT_Fusion">BT Fusion</a>), and digital TV (<a href="http://www.btvision.bt.com/vision/index.htm">BT Vision</a>). Additionally BT will give users the option to use their BT Home Hub to join <a href="http://blog.wired.com/gadgets/2007/10/fon-and-bt-in-i.html">FON</a>, a community-shared Wi-Fi. An unofficial source has reported us that there are <em>2+ million BT Home Hub users</em> in the UK.</p>
<p>If you&#39;re thinking: &quot;well I&#39;m not based in the UK so this research doesn&#39;t concern me&quot;, then think again! The BT Home Hub is just a Thomson/Alcatel <a href="http://ugolini.com.au/speedtouch/routers/7G/GENERIC%20DOCUMENTATION/Picture/7G.jpg">Speedtouch 7G</a> router. Furthermore, the vulnerabilities we found are most likely present in other Speedtouch models due to code reuse (more on that later).</p>
<p>So what can we do? Well, we can fully own the router remotely. At the moment we have three demo exploits which do the following:</p>
<ul>
<li>enable backdoor in order to control the router remotely</li>
<li>disable wireless completely (can only be re-enabled if the user is technically capable)</li>
<li>steal the WEP/WPA key</li>
</ul>
<p>Of course there other other attacks you could launch! We can hijack any action with full admin privileges or steal any info returned by a router&#39;s page. This means evilness of the exploits are only limited by the attacker&#39;s imagination. Other examples of evil attacks include evesdropping VoIP conversations (change &#39;sip config primproxyaddr&#39; statement in config file), stealing VoIP credentials, exposing internal hosts on the DMZ, change the DNS settings for stealing online banking credentials, disable auto updates (change <code>cwmp.ini</code> section in config file), etc ...</p>
<p>The only requirement for the router to be owned is that a victim user visits a (malicious) website. The good news is that our exploits do NOT require knowledge of the admin password! How can that be? Well, we rely on a authentication bypass bug we discovered!</p>
<p>Even though I&#39;ve been the owner of a BT Home Hub for quite a while, I never bothered to try to find vulnerabilities in it. However, on the last <a href="http://dc4420.org/">dc4420</a> meeting, after I gave a talk on <a href="http://www.procheckup.com/Vulnerability_Axis_2100_research.pdf">breaking into Axis cameras</a>, some of the guys there inspired me to research the BT Home Hub. After poking with it for a while, pdp and I couldn&#39;t believe how vulnerable the web interface of the device was! I remember pdp sarcastically saying: &quot;wow, it&#39;s really locked down man!&quot;, We discovered issues such as:</p>
<ul>
<li>authentication bypass (any admin action can be made without username/password!)</li>
<li>system-wide CSRF</li>
<li>several persistent XSS</li>
<li>several non-persistent XSS</li>
<li>privilege escalation</li>
</ul>
<p>We&#39;re now in the process of contacting BT and Thomson. However, I don&#39;t have high hopes for BT. Last year, I <a href="http://unknown.pentester.googlepages.com/bt-voyager-unauth-access.txt">found</a> a way to dump the BT Voyager 2091&#39;s config file without credentials. Even though I forwarded them my findings they never responded at all.</p>
<iframe class="video" src="//www.youtube.com/embed/i4tkM3UtF1Y" frameborder="0" allowfullscreen></iframe>

<p><em>Enjoy the demo video which was kindly prepared by pdp. We misspelled some words on the chat conversation, so please forgive us! In the video, the attacker social-engineers the victim to visit a malicious website. The malicious website in turn enables remote assistance on the victim&#39;s router with a password chosen by the attacker. After that, the attacker gains full privileges to the router remotely, and steals the config file and WEP key.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">here comes the stage6 video: http://stage6.divx.com/user/gnucitizen/video/1722388/BT-Home-Flub</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/375c0284a6efd8899f2bc69dbf99d6e3?s=256&amp;d=retro" alt="Hubert"><span class="post-comment-author">Hubert</span><div class="post-comment-content">Nice work. A configuration interface that's not web-based at all, like on my Apple Airport Extreme router might be a good idea after all.

The web and telnet interface on the Thomson router I've used was better designed and had more features than those I've seen on Belkin and Netgear devices, but obviously they have some work to do towards making it secure.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/cf3ff7853a134bfba57f96be896b037a?s=256&amp;d=retro" alt="devloop"><span class="post-comment-author">devloop</span><div class="post-comment-content">Hi guys ! I found a similar vulnerability in a modem/router provided by one of our ISP in France (Neuf Telecom)

The router got a web administration interface WITHOUT password-protection and it's vulnerable to CSRF and a persistent XSS.

Intruders can create NAT rules, change WEP/WPA encryption and password, activate/deactivate the hotspot or steal the credentials for the PPoA connection :p

But the router is very basic so it's not possible to change DNS servers or stuff like that.

Article here (in french): http://devloop.lyua.org/blog/index.php?2007/09/23/468-la-securite-de-la-neufbox-4</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7a73c170a64a3f5b5477cde76feb39d9?s=256&amp;d=retro" alt="phill"><span class="post-comment-author">phill</span><div class="post-comment-content">I have a home hub. Is there anything I can do to stop this? Is there a port I can close or something?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">phill, at the moment I don't think that there is a way to protect yourself from this type of attack at router level. You need to upgrade as soon as BT releases an update.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/23463b99b62a72f26ed677cc556c44e8?s=256&amp;d=retro" alt="memals"><span class="post-comment-author">memals</span><div class="post-comment-content">phill: just do not visit any maliciouss websites.
easy ;)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/127018260c84206ff23de0c314db4487?s=256&amp;d=retro" alt="Mark Kent"><span class="post-comment-author">Mark Kent</span><div class="post-comment-content">Hi Adrian,

Please send me any details you have, and I'll aim to get them to the right people in BT.

Best regards,
Mark Kent</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">phill,

If you are a fan of Firefox extensions, NoScript filters cross-site POST requests from untrusted to trusted sites. This protection should avoid someone exploiting your router if properly configured.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/20576f636feeb1a41b30d9f090ab2e24?s=256&amp;d=retro" alt="zip"><span class="post-comment-author">zip</span><div class="post-comment-content">Nice music, who is the artist ?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/10468ad8d146df7dc85e4f8c51ef542e?s=256&amp;d=retro" alt="blah"><span class="post-comment-author">blah</span><div class="post-comment-content">What's the point of the post other then to promote yourself? Users of this modem have no work around let alone patch.

"However, I don't have high hopes for BT" Obviously you didn't learn from your previous experience. If you releas code they'll fix it. By making your... annoucement you've given enough direction for people with malicious intent to find what you have. But you know all this.

zip; the tune is a... Spanish? version of, the girl from ipanema.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/72d98cbf017621a2440026135969c992?s=256&amp;d=retro" alt="robadams"><span class="post-comment-author">robadams</span><div class="post-comment-content">Caetano Veloso - Garota de Ipanema. Lovin' it</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/6b16c4e55cd0b1a9054c38d336f8dc8d?s=256&amp;d=retro" alt="vijay"><span class="post-comment-author">vijay</span><div class="post-comment-content">Interesting research. Btw you can disable remote assistance if you follow the instructions at the following site: http://baldric.net/2007/01/22/bt-home-hub-and-the-gpl/ 

to get "root privileges" then under [ mlpuser.ini ] and delete "defremadmin=enabled" or better yet:
just delete the tech user completely. You could also change the RAS port under [ system_raccess.ini ] although you wouldn't gain much.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">btw, I forgot to give thanks to Jan Fry for testing the vulnerabilities on the Thomson/Alcatel's Speedtouch 780 (provided by BeThere in the UK). 

zip, the song is Brazilian I believe (sung in Portuguese).

blah, I don't think there is anything wrong with publishing vulnerability research, especially when it's independent and unpaid. 

The good news is we have been in touch with some technical people from BT who are in the process of verifying the vulnerabilities we found.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/1e537fa4eeaf5358adbd3a6e92e1f9dd?s=256&amp;d=retro" alt="Taffy"><span class="post-comment-author">Taffy</span><div class="post-comment-content">I dout BT will do anything .. as they already have a   bad reputation with this kind of stuff</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/6bb4ba2dd74e93656b857c9397b29db4?s=256&amp;d=retro" alt="antivirustaneja"><span class="post-comment-author">antivirustaneja</span><div class="post-comment-content">Nice work...bt if you release the code as well only then they'll do as quickly as they can ....moreover hereafter they can't ignore your research.......</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b98c01ec66a379144347eeb1cbdc9520?s=256&amp;d=retro" alt="DavidB"><span class="post-comment-author">DavidB</span><div class="post-comment-content">I know there are supposed to be some malicious sites that have cross-scripting to perform attacks on machines/routers.  Does anyone have a list of these as I'd like to put some additional rules into my firewalls to prevent access to these sites?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">DavidB,

That would be very unfeasible. Probably the closest thing you can do to that is using a black-list database from some popular web content filtering proxy software.

I mean, the malicious JS that exploits your router could be anywhere such as in a free .googlepages.com webpage.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7e8241dcea25a2f0c5673668bf496287?s=256&amp;d=retro" alt="John"><span class="post-comment-author">John</span><div class="post-comment-content">I've been looking into the BT homehub recently, I'm interested to see how secure the remote desktop facility is.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/70212aaf094cb8b1b057b5b1fed8d59b?s=256&amp;d=retro" alt="1337"><span class="post-comment-author">1337</span><div class="post-comment-content">Any exploits for Software version: 6.2.6.B ? These Homehubs really are weak.  A padlock from poundland is more secure!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">1337:

The CSRF, XSS and double-slash auth bypass are still there on version 6.2.6.B.

For instance, although version 6.2.6.B has now password-protected the page that shows the WEP/WPA, it's still possible to access it *without* authenticating by ending the URL with 2 slashes: 
http://192.168.1.254/cgi/b/_wli_/seccfg//

Try it on your Home Hub. It should work. This means that people can still steal your WEP/WPA key by scraping the previous URL through one of the many XSS vulns still present on version 6.2.6.B.

However, version 6.2.6.B has added lots of restrictions such as disabling telnet, remote assistance and worst of all: the config file is now encrypted/obfuscated!: http://192.168.1.254/cgi/b/backup/user.ini//

However, I have not checked if uploading a clear-text version of the config file still works.  If so, you could still mod your own Home Hub without restrictions by simply editing user.ini.

Check out our other 'Pwnin the BT Home Hub' posts for more info:

http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub-2
http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub-3
http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub-4</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5ce24e5343ee7322441f158307547419?s=256&amp;d=retro" alt="cephalopod"><span class="post-comment-author">cephalopod</span><div class="post-comment-content">er... wouldn't a simple change of the homehub LAN IP prevent these hacks?!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">nope, it will make it slightly more complicated but in general it wont prevent anything.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5ce24e5343ee7322441f158307547419?s=256&amp;d=retro" alt="cephalopod"><span class="post-comment-author">cephalopod</span><div class="post-comment-content">looking at the majority of the XSS vulnerabilities, they make use of 192.168.1.254 in the javascript - so surely it'll prevent script kiddies exercising that?

how about combining that with deleting the tech user aswell... would that prevent all bar the UPnP vulnerability?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">the only way to prevent UPnP based attacks is to disable UPnP on your router. On some router models this is not trivial at all and sometimes even impossible.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b22ced65c9b5101206db662305122188?s=256&amp;d=retro" alt="lahtib"><span class="post-comment-author">lahtib</span><div class="post-comment-content">The song is "Girl From Ipanema" by Stan Getz...it's American, not portuguese or brazilian.  Great post!</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2021 <a href=""></a>. All rights reserved.</p></footer></body></html>