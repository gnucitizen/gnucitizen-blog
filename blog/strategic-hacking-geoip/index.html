<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Strategic Hacking GEOIP</title><meta name="description" content="Not that long time ago, ap and I did a good play around with GEOIP: ip to country, country to ip mappings, geo locating the IP addresses from the Holy See, etc (yep we've done that). Nothing major, really! We find this topic quite interesting and largely educational, especially around the methodologies and tricks that we have developed in order to find the IP ranges/blocks of entire countries."><meta property="name" content="Strategic Hacking GEOIP"><meta itemprop="name" content="Strategic Hacking GEOIP"><meta property="description" content="Not that long time ago, ap and I did a good play around with GEOIP: ip to country, country to ip mappings, geo locating the IP addresses from the Holy See, etc (yep we've done that). Nothing major, really! We find this topic quite interesting and largely educational, especially around the methodologies and tricks that we have developed in order to find the IP ranges/blocks of entire countries."><meta itemprop="description" content="Not that long time ago, ap and I did a good play around with GEOIP: ip to country, country to ip mappings, geo locating the IP addresses from the Holy See, etc (yep we've done that). Nothing major, really! We find this topic quite interesting and largely educational, especially around the methodologies and tricks that we have developed in order to find the IP ranges/blocks of entire countries."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fstrategic-hacking-geoip%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fstrategic-hacking-geoip%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/strategic-hacking-geoip/"><meta property="og:title" content="Strategic Hacking GEOIP"><meta property="og:description" content="Not that long time ago, ap and I did a good play around with GEOIP: ip to country, country to ip mappings, geo locating the IP addresses from the Holy See, etc (yep we've done that). Nothing major, really! We find this topic quite interesting and largely educational, especially around the methodologies and tricks that we have developed in order to find the IP ranges/blocks of entire countries."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fstrategic-hacking-geoip%2F?w=1024"><meta name="twitter:title" content="Strategic Hacking GEOIP"><meta name="twitter:description" content="Not that long time ago, ap and I did a good play around with GEOIP: ip to country, country to ip mappings, geo locating the IP addresses from the Holy See, etc (yep we've done that). Nothing major, really! We find this topic quite interesting and largely educational, especially around the methodologies and tricks that we have developed in order to find the IP ranges/blocks of entire countries."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fstrategic-hacking-geoip%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/blog/">Blog</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Strategic Hacking GEOIP</h1><div class="date">Fri, 12 Oct 2007 10:52:56 GMT</div><div class="author">by pdp</div><div id="post-content"><p>Not that long time ago, ap and I did a good play around with GEOIP: ip to country, country to ip mappings, geo locating the IP addresses from the Holy See, etc (yep we&#39;ve done that). Nothing major, really! We find this topic quite interesting and largely educational, especially around the methodologies and tricks that we have developed in order to find the IP ranges/blocks of entire countries.</p>
<p>Although we&#39;ve build a quite solid database over the time, we are planning to keep it private and use it for research purposes only. However, if you dig deep into some of our public research <a href="/files/2007/10/country2ip.ppt">materials</a>, you should be able to to create a tiny subset of our database by using some of the described techniques and also <a href="/files/2007/10/create-db.sh">this bash script</a>.</p>
<p><em>You can also download a <a href="/files/2007/10/digest-2007-10-12.zip">database digest</a> created with the bash script above.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/89d4328a0bae76d13017a840f9448096?s=256&amp;d=retro" alt="Dfcnvt"><span class="post-comment-author">Dfcnvt</span><div class="post-comment-content">Now that you have the country of all it's ip address. What about the state in US or perhap the county in state?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/89d4328a0bae76d13017a840f9448096?s=256&amp;d=retro" alt="Dfcnvt"><span class="post-comment-author">Dfcnvt</span><div class="post-comment-content">http://www.maxmind.com/app/city</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">yep, this is the one. although, as I mentioned in the post, the database is not 100% accurate, not to mention the fact that the interesting ranges are simple not even included.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/2fbd3fcfa626bd4301c18cdbd207a7bb?s=256&amp;d=retro" alt="vindic"><span class="post-comment-author">vindic</span><div class="post-comment-content">pdp will you sell this, or make a new service? if you can make more accurate db, then why you dont use it for protection of websites? i will be first in list who will buy it, because is very very usefull</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">vindic, what do you need this for? I mean Maxmind have a free database you can use for most things that come to mind.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/2fbd3fcfa626bd4301c18cdbd207a7bb?s=256&amp;d=retro" alt="vindic"><span class="post-comment-author">vindic</span><div class="post-comment-content">pdp i have theyr's db, have too bins of cc. i am providing payments services and trying protect us for fraud. i am looking for any way or stuff which can more protect ours customers.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d58934255c84ad1da6e10b5dc474fd6f?s=256&amp;d=retro" alt="cybergoth"><span class="post-comment-author">cybergoth</span><div class="post-comment-content">I'm using ripe.net Europe RIRâ€™s db to extract net blocks for entire country. You can check it at  ftp://ftp.ripe.net/pub/stats/ripencc/2007</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">cybergoth, cool... I need to look at this!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/783ced7f61e69c95e312d276ea7b8bae?s=256&amp;d=retro" alt="RHW"><span class="post-comment-author">RHW</span><div class="post-comment-content">This is a cool idea.  I scanned around for about 10 minutes and found about 5 boxes with open ports.  What is the default user/pass for the slingboxes?  I can't find any info on their website.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8c8d38091ac5bee13439a3ed7fa88ab4?s=256&amp;d=retro" alt="ricky"><span class="post-comment-author">ricky</span><div class="post-comment-content">Seems some changes on how the ip database is being held has been made since the last time I ran the script my files come out in the form of

<pre><code>country-11.0.0.0.csv
country-112.63.162.116.csv
country-112.63.162.120.csv
country-112.63.162.148.csv
country-114.0.0.0.csv
country-116.0.0.0.csv
country-116.0.128.0.csv
country-116.0.16.0.csv
country-116.0.24.0.csv
country-116.0.32.0.csv
country-116.0.64.0.csv
country-116.0.64.128.csv
country-116.0.64.192.csv
country-116.0.64.224.csv
country-116.0.64.240.csv
country-116.0.64.64.csv
country-116.0.65.0.csv</code></pre>

If only I had backed them upbefore like I ment to.

./R B</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">ok, I have to look into this. I think that they have changed the positions of the CSV columns. Just rearrange the columns or better yet modify the script to outline these changes.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8c8d38091ac5bee13439a3ed7fa88ab4?s=256&amp;d=retro" alt="Ricky"><span class="post-comment-author">Ricky</span><div class="post-comment-content">Links seem to be broken on this page for the script an ppt file</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">yes, there are tones of bugs laying around since we moved. I will fix this now. thanks for the feedback.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">all fixed now!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8051a7a2ed85308fe45d2b938d7c4cea?s=256&amp;d=retro" alt="Andrew Horton"><span class="post-comment-author">Andrew Horton</span><div class="post-comment-content">I've published a tool that uses this technique and only just found out about your similar research from a post on the full disclosure mailing list.

GeoIPgen is a tool for country to IP resolution written in ruby. It can produce IPs for 1 or a set of countries in ascending or random order, producing unique IPs with low overhead :)

It has proved useful when penetration testing to reverse resolve an entire country in order to discover networks or IPs the client forgets to mention.

It's available here, http://www.morningstarsecurity.com/research/geoipgen</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/0367b81839d31a5fa3d7bea79ef71b9e?s=256&amp;d=retro" alt="pagvac"><span class="post-comment-author">pagvac</span><div class="post-comment-content">@Andrew: thank you for sharing your project with us! please keep us up to date with any significant feature additions to GeoIPgen.

You might also be interested in taking a look at http://www.country2ip.com/</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2021 <a href=""></a>. All rights reserved.</p></footer></body></html>