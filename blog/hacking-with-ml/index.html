<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Hacking with ML</title><meta name="description" content="Let's say that we want to train an ML model to hack web applications. What would that look like in practice? Let's do this thought experiment."><meta property="name" content="Hacking with ML"><meta itemprop="name" content="Hacking with ML"><meta property="description" content="Let's say that we want to train an ML model to hack web applications. What would that look like in practice? Let's do this thought experiment."><meta itemprop="description" content="Let's say that we want to train an ML model to hack web applications. What would that look like in practice? Let's do this thought experiment."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-with-ml%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-with-ml%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/hacking-with-ml/"><meta property="og:title" content="Hacking with ML"><meta property="og:description" content="Let's say that we want to train an ML model to hack web applications. What would that look like in practice? Let's do this thought experiment."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-with-ml%2F?w=1024"><meta name="twitter:title" content="Hacking with ML"><meta name="twitter:description" content="Let's say that we want to train an ML model to hack web applications. What would that look like in practice? Let's do this thought experiment."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-with-ml%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/blog/">Blog</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Hacking with ML</h1><div class="date">Mon Apr 26 2021 16:10:45 GMT+0100 (British Summer Time)</div><div class="author">by pdp</div><div id="post-content"><p>Let&#39;s say that we want to train an ML model to hack web applications. What would that look like in practice? Let&#39;s do this thought experiment.</p>
<p>We first need to define an environment where the agent (the ML model) can operate and essentially learn. In principle, this would necessitate boiling down the process of web hacking into a limited number of inputs that the agent needs to send in some combination and get rewarded for in return (let&#39;s think of this from the perspective of reinforcement learning).</p>
<p>For this thought experiment, let&#39;s consider that the input is just three buttons (think of them as a game controller) which the agent can press to manipulate the environment. The agent will smash the buttons, and in return, it may get some reward for finding a vulnerability or getting pretty close to it (novelty-based reward system).</p>
<p>To make this more interesting, the agent also needs to pick up some environmental heuristics (let&#39;s call these sensors). Let&#39;s keep it simple and concentrate on the URL only. We start by eliminating the domain and the protocol and focus on the URL path and query. Each part of the path can be split into tokens, and each token encoded into a numeric value from a dictionary. The URL query follows the same transformation. Each parameter is encoded into a numeric value from a dictionary, and the query value can be encoded into several parameters representing the type, length, complexity score, etc.</p>
<p>Now we have a vector of values, but we are far from done yet. Let&#39;s imagine that the 3-button controller is used to perform the following operations: button A and B are for moving left and right, and button C is for changing the letter (rotating forward, i.e. D becomes E) under the cursor. This information also needs to be encoded into the vector, so we need a value for the cursor position.</p>
<p>Up to this point, we have an environment (the game), the input, the sensors and some reward system, whatever that may be. The next step is to train the model by allowing the agent to operate inside the environment.</p>
<p>If we let the agent loose, given enough time (infinite monkey theorem), we should start seeing results. In theory, if our model is built to purpose, the agent will not be entirely random, but it will perform actions with some level of intuition available due to the connections in the neural net. However, it is also possible to teach the model by providing good and bad examples. In other words, human input is required to show how to operate in the environment effectively and, as a result, speed up the training process significantly.</p>
<p>And just like that, we might have an ML model that hacks, limited to this specific problem domain. While it may not beat web application scanners in terms of depth, I believe it has a chance of discovering novel hacking techniques as long as they are related to input validation. Anything that requires more complex interactions, such as opening separate sessions, figuring out out-of-band attacks, etc., would significantly increase the number of parameters and complicate the model unless a more generalised learning environment is invented.</p>
</div></div></article><footer id="footer"><p>Copyright &copy; 2022 <a href=""></a>. All rights reserved.</p></footer></body></html>