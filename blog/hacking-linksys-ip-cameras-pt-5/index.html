<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Hacking Linksys IP Cameras (pt 5)</title><meta name="description" content="This article is a continuation of the following GNUCITIZEN articles: pt 1, pt 2, pt 3, pt 4."><meta property="name" content="Hacking Linksys IP Cameras (pt 5)"><meta itemprop="name" content="Hacking Linksys IP Cameras (pt 5)"><meta property="description" content="This article is a continuation of the following GNUCITIZEN articles: pt 1, pt 2, pt 3, pt 4."><meta itemprop="description" content="This article is a continuation of the following GNUCITIZEN articles: pt 1, pt 2, pt 3, pt 4."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-linksys-ip-cameras-pt-5%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-linksys-ip-cameras-pt-5%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/hacking-linksys-ip-cameras-pt-5/"><meta property="og:title" content="Hacking Linksys IP Cameras (pt 5)"><meta property="og:description" content="This article is a continuation of the following GNUCITIZEN articles: pt 1, pt 2, pt 3, pt 4."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-linksys-ip-cameras-pt-5%2F?w=1024"><meta name="twitter:title" content="Hacking Linksys IP Cameras (pt 5)"><meta name="twitter:description" content="This article is a continuation of the following GNUCITIZEN articles: pt 1, pt 2, pt 3, pt 4."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-linksys-ip-cameras-pt-5%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Hacking Linksys IP Cameras (pt 5)</h1><div class="date">Fri, 05 Jun 2009 08:04:55 GMT</div><div class="author">by
pagvac</div><div id="post-content"><p>This article is a continuation of the following GNUCITIZEN articles: <a href="/blog/hacking-linksys-ip-cameras-pt-1/">pt 1</a>, <a href="/blog/hacking-linksys-ip-cameras-pt-2/">pt 2</a>, <a href="/blog/hacking-linksys-ip-cameras-pt-3/">pt 3</a>, <a href="/blog/hacking-linksys-ip-cameras-pt-4/">pt 4</a>.</p>
<h2 id="mounting-the-filesystem-on-your-workstation">Mounting the filesystem on your workstation</h2>
<p>There are many ways to mount the camera&#39;s filesystem using the firmware binary. In this post, we&#39;ll explain one way to mount firmware version v1.00R24 which is the latest available for the WVC54GCA model.</p>
<p>If you were to only use the firmware binary, things could be a bit difficult, as you don&#39;t know the format of the binary at all. However, having the GPL firmware helps a lot as we&#39;ll see next. I emailed Linksys back on Apr 23, 2009 informing them that although the GPL firmware was available on their site for other Linksys products, they hadn&#39;t uploaded the one for the WVC54GCA camera. A few days later, on Apr 27, 2009, Linksys kindly made it available and <a href="http://www.linksysbycisco.com/US/en/supportgplcode">has been available</a> ever since (the file to download is <code>wvc54gca_v1.00R24.tgz</code>).</p>
<p>Thanks to <a href="http://brooknet.no-ip.com/~lex/">Lex Landa</a>&#39;s tips I was able to figure out the parameters required to mount the firmware binary, by analysing the data contained in the <code>./scripts/wvc54gc_usa_english/combine.cfg</code> file which is included with the <a href="http://downloads.linksysbycisco.com/downloads/wvc54gca_v1.00R24,5.tgz">GPL firmware</a>:</p>
<pre><code class="language-ini"><span class="attr">size</span> = <span class="number">00400000</span>
<span class="attr">file</span> = WVC54GCA.bin
<span class="attr">f1_name</span> = loader
<span class="attr">f1_start</span> = <span class="number">00000000</span>
<span class="attr">f2_name</span>=loader.ver
<span class="attr">f2_start</span>=<span class="number">00007</span>FFE
<span class="attr">f3_name</span>=**kernel**
<span class="attr">f3_start</span>=**<span class="number">00020000</span>**
<span class="attr">f4_name</span>=**filesystem**
<span class="attr">f4_start</span>=**<span class="number">000</span>E0000**
<span class="attr">f5_name</span>=PID
<span class="attr">f5_start</span>=<span class="number">003</span>FFFB2</code></pre>
<p>I simply focused on the <code>kernel</code> and <code>filesystem</code> parameters. The previous settings show that then kernel starts at <code>0x20000</code> (131072 bytes / 128 KB), and the filesystem starts at <code>0xE0000</code> (917504 bytes / 896 KB). In order to start <a href="http://en.wikipedia.org/wiki/Dd_(Unix)">dd</a> reading at <code>0xE0000</code>, we need to keep 7 chunks of 131072 bytes. i.e.:<code>7*131072=917504 bytes=0xE0000</code> (the position we want)</p>
<pre><code class="language-bash">$ dd <span class="keyword">if</span>=DYFF08-402-1024.bin bs=**131072** of=fs.img skip=**7**
25+0 records <span class="keyword">in</span>
25+0 records out
3276800 bytes (3.3 MB) copied, 0.019424 s, 169 MB/s</code></pre>
<p>We then verify that our image file is a valid <code>squashfs</code> filesystem:</p>
<pre><code class="language-`bash">$ file fs.img 
fs.img: Squashfs filesystem, little endian, version 3.0, 2216311 bytes, 475 inodes, blocksize: 65536 bytes, created: Fri Nov  9 03:58:52 2007</code></pre>
<p>A finally mount it on our hardrive:</p>
<pre><code class="language-bash">$ sudo mkdir /mnt/<span class="built_in">test</span>
$ sudo mount -t squashfs fs.img /mnt/<span class="built_in">test</span> -o ro,loop
$ ls /mnt/<span class="built_in">test</span>/
bin  dev  etc  lib  mnt  proc  root  sbin  tmp  usr  var</code></pre>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7936ef0dd045abb6e2987ea18d9964cc?s=256&amp;d=retro" alt="josh"><span class="post-comment-author">josh</span><div class="post-comment-content">Here are some pictures of the insides of the Linksys WVC54GCA Webcam along with liks to the data sheets for some of the chips...

http://www.flickr.com/photos/bigjosh/3750837001/in/photostream/

...just to save oneone the time of taking thiers appart. 

-josh</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/0367b81839d31a5fa3d7bea79ef71b9e?s=256&amp;d=retro" alt="pagvac"><span class="post-comment-author">pagvac</span><div class="post-comment-content">sweet, thanks for that josh!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/588eba37270fb74cfbf5769916be6dd6?s=256&amp;d=retro" alt="paul"><span class="post-comment-author">paul</span><div class="post-comment-content">So one you have mounted the bin, cant you edit that to setup some back door to let you in, or better yet to enable telnet???</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/28f059a0c51b50a25e4de146e9834a64?s=256&amp;d=retro" alt="Ricardo"><span class="post-comment-author">Ricardo</span><div class="post-comment-content">I have a question. The camera has a surveilance mode that lets you record event-driven video of up to 5 (yes, five) seconds before/after the event itself. Is there any way to have the camera record something like, maybe 10 minutes worth of video instead of 5 seconds?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d87e8180176a69ad1f937148d38f4663?s=256&amp;d=retro" alt="nick"><span class="post-comment-author">nick</span><div class="post-comment-content">Ricardo,

Unlikely. The device only has 32MB of onboard RAM and a not very powerful processor. To be able to "record" 10 minutes worth of video at any useable resolution and then send that by ftp (forget email due to the size of the video file) would require processing power and RAM that the device just does not have. Best scenario is to use the video stream produced by the device and feed that into a PC running security software that would detect motion and record the event. Such software is available.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/56f904629fb4ecda24ea08d0ee1ac199?s=256&amp;d=retro" alt="Bruno"><span class="post-comment-author">Bruno</span><div class="post-comment-content">You can disassemble the firmware binary and mount the filesystem. Q: can you assemble it back to a valid firmware binary?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/13a615814d6804e1b540a7abd4aa424b?s=256&amp;d=retro" alt="digger"><span class="post-comment-author">digger</span><div class="post-comment-content">Sorry to bother you, but on my side of the planet ftp.linksys.com seems to be broken so I can't find any download source for R22 and R24 releases (both firmware and gpl code). If either of you have them backed up please give me a link, torrent, rapidshare, megaupload ... whatever.

Thanks in advance.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/76f87cf7f843121e20d8c6beb85858bd?s=256&amp;d=retro" alt="valex"><span class="post-comment-author">valex</span><div class="post-comment-content">The ftp site is down, anyone with a stashed copy of the R24 firmware + code ?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5954e66dc983aae37340fc26feb58aae?s=256&amp;d=retro" alt="Luke"><span class="post-comment-author">Luke</span><div class="post-comment-content">Very nice stuff you folks did but little beyond me. So could you help a mere mortal with what I think is a simple question. Would there be a command that would do a warm reboot of the camera (cf the reset to factory defaults). All the pieces seem to be there but I don't know how to do that.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/40fb2a4f6c88ac008a80b3ab235167c3?s=256&amp;d=retro" alt="Paul"><span class="post-comment-author">Paul</span><div class="post-comment-content">The source code wvc54gca_v1.00R24.tgz is there... http://downloads.linksysbycisco.com/downloads/wvc54gca_v1.00R24.tgz</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d87e8180176a69ad1f937148d38f4663?s=256&amp;d=retro" alt="Nick"><span class="post-comment-author">Nick</span><div class="post-comment-content">Bruno,

I had a go at doing this since I wanted hack the root password. However, the problem I had was that I could not generate a squashfs image that was the same size as the same size as the original. I gave up when the new firmware was made available, since seemed to solve the main issue I had with the previous f/w (motion detect ridiculously sensitive). Only problem I have with the camera at the moment is that it won't stay on the wireless network for any length of time. Just drops off and has to be hard reset.

Digger/Valex. Linksys site appears okay at present. Current f/w is Ver.1.1.00 build 02.

Luke. I don't know of a hack to reset the camera. When logged in with admin privs I thought that there was an option to reset it, but unfortunately, my camera is not online at the moment and I cannot get it to come up on the wi-fi network so I cannot check that - sorry.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5954e66dc983aae37340fc26feb58aae?s=256&amp;d=retro" alt="Luke"><span class="post-comment-author">Luke</span><div class="post-comment-content">In case anybody else needs it the command to software reset the camera:
http://ip_address:port/adm/reboot.cgi
The reboot command will respond with a simple OK.

Sometimes the camera blacks-out (there is no image) but you still can access the the built-in webserver. If you are in luck the reboot will restore the image. However if the camera really locks-up (the webserver doesn't respond) you need to unplug the camera.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/32b8d3fea35b14d50c9a1256bbb13b46?s=256&amp;d=retro" alt="Return Privacy"><span class="post-comment-author">Return Privacy</span><div class="post-comment-content">Hi all, I need firmware v1.1.00 build 02 for wvc54gca. Linksys tech support had me update to v1.1.01 build 01 and it totally broke the motion detection recording function. I need the v1.1.00 build 02, that worked fine. I found the problem was a router, I should have never called them. The v1.1.00 build  02 worked great. I did find a copy of v1.00R24 on another site, but that won't work with wpa2, and some other things don't work right. If you have v1.1.00 build 02, please share it with me so I can get this camera working again. Thank you.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/32b8d3fea35b14d50c9a1256bbb13b46?s=256&amp;d=retro" alt="Return Privacy"><span class="post-comment-author">Return Privacy</span><div class="post-comment-content">I found the firmware v1.1.00 build 02 and it fixed all the problems with this camera. Do NOT use the newer v1.1.01 build 01, it breaks the motion detection recording completely! If anyone else wants the download link, it is a german drivers site, here it is:
http://translate.google.com/translate?hl=en&amp;sl=de&amp;u=http://www.treiberupdate.de/treiber-download/download-182342-treiber-LinkSys-WVC54GCAWireless-G.html&amp;ei=LVZxTJHJL4P_8AbF_-T9DA&amp;sa=X&amp;oi=translate&amp;ct=result&amp;resnum=2&amp;ved=0CB0Q7gEwATiWAQ&amp;prev=/search%3Fq%3Dfirmware%2Bwvc54gca%26start%3D150%26hl%3Den%26client%3Dsafari%26sa%3DN%26rls%3Den</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/a74a0f540ba907c625760a318f326162?s=256&amp;d=retro" alt="ryan"><span class="post-comment-author">ryan</span><div class="post-comment-content">hello , 

I am trying to mount this firmware so I can explore the other cgi options available within. Why?

I have a Sercomm wireless IP camera and the commands I HAVE unconvered are very similar to those in this article. Except, my firmware was already updated to prevent the exploits. 

Therefore, if I can mount it and explore the filesystem, I may have luck decoding more cgi commands for my camera ...

If anyone astill has access to or a copy of the firmware source code, I would love to host it publicly for all. All links provided in this comment thread no longer work as of the date of this post. Google turns up nothing. I see the BIN posted, but I need the source code!

Thanks for any help!</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2022 <a href=""></a>. All rights reserved.</p></footer></body></html>