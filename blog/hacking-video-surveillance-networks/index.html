<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Hacking Video Surveillance Networks</title><meta name="description" content="*The usual suspects: George Clooney, Brad Pitt and Matt Damon. The plot: rob a casino. The method:** hijack the vault's security camera video stream and replace it with a static image. &quot;Fiction?&quot; I don't think so."><meta property="name" content="Hacking Video Surveillance Networks"><meta itemprop="name" content="Hacking Video Surveillance Networks"><meta property="description" content="*The usual suspects: George Clooney, Brad Pitt and Matt Damon. The plot: rob a casino. The method:** hijack the vault's security camera video stream and replace it with a static image. &quot;Fiction?&quot; I don't think so."><meta itemprop="description" content="*The usual suspects: George Clooney, Brad Pitt and Matt Damon. The plot: rob a casino. The method:** hijack the vault's security camera video stream and replace it with a static image. &quot;Fiction?&quot; I don't think so."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-video-surveillance-networks%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-video-surveillance-networks%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/hacking-video-surveillance-networks/"><meta property="og:title" content="Hacking Video Surveillance Networks"><meta property="og:description" content="*The usual suspects: George Clooney, Brad Pitt and Matt Damon. The plot: rob a casino. The method:** hijack the vault's security camera video stream and replace it with a static image. &quot;Fiction?&quot; I don't think so."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-video-surveillance-networks%2F?w=1024"><meta name="twitter:title" content="Hacking Video Surveillance Networks"><meta name="twitter:description" content="*The usual suspects: George Clooney, Brad Pitt and Matt Damon. The plot: rob a casino. The method:** hijack the vault's security camera video stream and replace it with a static image. &quot;Fiction?&quot; I don't think so."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-video-surveillance-networks%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Hacking Video Surveillance Networks</h1><div class="date">Wed, 30 Jan 2008 11:05:48 GMT</div><div class="author">by pdp</div><div id="post-content"><p><strong>The usual suspects:</strong> George Clooney, Brad Pitt and Matt Damon. <strong>The plot:</strong> rob a casino. <strong>The method:</strong> hijack the vault&#39;s security camera video stream and replace it with a static image. &quot;Fiction?&quot; I don&#39;t think so.</p>
<p>This post is not going to be about how to hack into the video surveillance networks of your local government but rather about my personal opinion about the current state of security implemented by the latest video technologies. I hope that the post is as entertaining as enlightening and helpful in your work. I also hope that it gives you the edge to go ahead and implement better, more secure surveillance systems that will actually protect whatever needs to be protected.</p>
<p>Over the past week, I&#39;ve been heavily involved with exploring several techniques for attacking IP-based video cameras. Apart from the usual vulnerabilities that you find across these types of embedded devices (XSS, CSRF, Authentication Bypass, Brute force attacks that really work, Overflows, etc.), I&#39;ve come up with some quite interesting observations, which may come as a no-surprise to some of you, but nevertheless they worth to be mentioned as we are often unable to comprehend the simplicity of the matter). So here you go:</p>
<h2 id="the-concept-of-trust-is-fundamentally-broken-">The concept of TRUST is fundamentally broken!</h2>
<p>Simply put, there is no way of knowing whether the camera on the other end is the device that is expected to be. Currently, there is no trust model that is implemented by IP-base video surveillance systems. The attack method is rather simple. Go ahead and disconnect the camera and hook a notebook on its place. Done! The Video surveillance software will never know that the camera has bee replaced by a static video stream produced by another device. &quot;Is that surprising?&quot; I hope not because this is the reality.</p>
<p>The next time you watch a movie where the bad guys replace a video stream from the security surveillance system by hooking a device to the network, count it as a real and very possible hack!</p>
<h2 id="installing-rogue-video-cameras-is-easy-">Installing rogue video cameras is easy!</h2>
<p>Many of the IP-based video surveillance solutions are based on simple discovery protocols such as mDNS and UPnP. Both of them work on multicast addresses. Therefore, it is extremely easy to fake as many cameras as we want.</p>
<p>Here is how to do this. The <code>[register.py](/files/2008/01/register.py)</code> script will register a brand new AXIS 206 camera, while the <code>[server.py](/files/2008/01/server.py)</code> will feed MJPG video stream from an external source. This is how we use them:</p>
<pre><code>register.py **[your mac address here]** &amp;
server.py http://152.1.130.216/mjpg/video.mjpg **# MJP video stream**</code></pre><p>Keep in mind that we can register as many video cameras as we want and as such cause a panic or a simple misdirection. We can also do funky thinks like making the video surveillance system to believe that the camera at the back of the casino is actually the camera installed at the entrance?</p>
<h2 id="barefoot-computer-networks-are-flawed-so-does-ip-based-surveillance-systems">Barefoot computer networks are flawed, so does IP-based surveillance systems</h2>
<p>Computer networks are vulnerable to all sorts of attacks: ARP spoofing/hijacking, rogue DHCP servers, rogue DNS servers, routing issues, subnet hopping, eavesdropping, etc. The list goes on and on. In order to mitigate these problems, we often rely on higher (mostly level 7) encapsulation mechanism that guarantee the integrity of the lower encapsulation levels (think of SSL). IP-based surveillance systems simply does not have these types of security layers yet. They are largely based on the assumption that no one has access to the network where these devices are located. It might be harder to physically access a video network, but it is not impossible. Think about it. Every camera is a potential entry point, no matter how high on wall you will put it. Given the fact that a lot of these video surveillance systems have WiFI these days, the situation becomes even more concerning.</p>
<h2 id="administrative-functions-are-handled-over-ancient-security-mechanisms">Administrative functions are handled over ancient security mechanisms</h2>
<p>All embedded devices can be accessed via their HTTP server with the need of Basic Authorization credentials. Basic Auth is sniff-able and easily reversible-able. This is why it is called <strong>basic</strong>. Moreover, it can be easily used for stealing access credentials of the video surveillance system. For that to work, the attacker needs a fake &quot;credentials-hijacking&quot; camera. The <code>[stealing_server.py](/files/2008/01/stealing_server.py)</code> script part of the PoCs comes into play. This is how we launch the attack:</p>
<pre><code>register.py **[your mac address here]** &amp;
stealing_server.py http://152.1.130.216/mjpg/video.mjpg &quot;AXIS 206&quot; 5 **# MJP video stream, realm AXIS 206, 5 consequent tries**</code></pre><p>Upon execution, the <code>register.py</code> will register a new AXIS 206 camera. Then the <code>stealing_server.py</code> will activate. It won&#39;t take long until the video surveillance software calls for video initialization. At this stage a Baisc Authentication realm will be provided. Since most video surveillance systems provide facilities to store all your camera credentials so that it is easy to manage them all, these credentials will travel to the rouge camera server, where they will be decoded and displayed to the attacker. The chances that the same credentials are used across all devices are pretty high. So, there you go. Now the bad guys have access to all your video resources.</p>
<h2 id="mitigations">Mitigations</h2>
<p>I don&#39;t know where to start really. I guess that when thinking about embedded devices we should really think of something that is extremely flawed. Therefore, they endangers the surrounding clients and the network to which they are connected.</p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c92e0b0cd585bbee9826c9d2bdf4e8b1?s=256&amp;d=retro" alt="pang"><span class="post-comment-author">pang</span><div class="post-comment-content">Don't you mean Ocean's Eleven? We got lots of AXIS cameras in the subway here in Sweden. Really nice cameras. I think they run some kind of linux. You can get telnet running on them anyway. They got a nice API via the web also. Now that I think about it I think AXIS headquarters are located here in Sweden.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">pang, yes AXIS is linux based. In fact, if you have the credentials (often obtained by bruteforce), you can FTP in and look at the file structure.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/f1bb89072d693d5c41cc8b1d8ae30b3a?s=256&amp;d=retro" alt="agent0x0"><span class="post-comment-author">agent0x0</span><div class="post-comment-content">Very good post pdp.  Do you know if using another camera that supports something like 802.1x authentication might help mitigate this risk perhaps?  I think I read somewhere that Cisco IP cameras support this and can be configured more secure then your AXIS types (Cisco will cost you $$$ though..).</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">I guess the 802.1x authentication based mechanism makes a lot more sense, since the port on the switch will be marked as unauthorized, and therefore will be blocked, unless you send the right EIP credentials. However, as far as I am aware, 802.1x is vulnerable to man in the middle attacks (MITM). Please correct me if I am wrong. On another note, if the attacker has a physical access to a camera they <strong>might</strong> be able to read the creds from the device. But definitely, it is a lot better then what AXIS currently has.

The truth is that, like everything else, you have to find the golden balance between security and accessibility and layer the security models in a way that they make sense for the setup you have.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/17cb223cbd50ebed7dee240b45fbf5c3?s=256&amp;d=retro" alt="Ix"><span class="post-comment-author">Ix</span><div class="post-comment-content">Interesting post. This looks like it's almost easier than it is in movieland, which is amusing considering their idea of hacking a Gibson (yeah, that's a reference to the "Hackers" movie for all it's horrible hacking portrayal). Heh, anyways it was interesting to see proof that this is more than do-able in the real world. I know a few family friends have had these types of things set up to watch their small family business while they were on a vacation but one has to wonder if any of the more technical employees set up something like this and held parties in the break room.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c92e0b0cd585bbee9826c9d2bdf4e8b1?s=256&amp;d=retro" alt="pang"><span class="post-comment-author">pang</span><div class="post-comment-content">I believe AXIS cameras has support for 802.1x and even if they didn't I would configure the switch to notice if the camera was unplugged.

AXIS cameras can also be configured to larm if the picture is changed a lot like if you would spraypaint it or something.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/e84708d25a0040efb2469dac1e9cecc3?s=256&amp;d=retro" alt="Jason Macpherson"><span class="post-comment-author">Jason Macpherson</span><div class="post-comment-content">Yep Axis cameras run linux alright.  These things are very Geek/Hacker friendly. You can even enable telnet by editing "/etc/inittab ". and uncommenting the following line: "tnet:35:once:/usr/sbin/telnetd"</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/271ecedbd232e23677ddc1d3956147eb?s=256&amp;d=retro" alt="hackathology"><span class="post-comment-author">hackathology</span><div class="post-comment-content">pdp, this is a very good post. I would like to know how can i be sure if a video cam network is using the IP network when in the first place i don't even have access to the network. I can see the video cam, but there is no way i can guess if it is using the IP network</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">well the easiest way is to try to spot the camera model and check it on the Web. Also observing any network-type infrastructure around it could also lead to the conclusion that it is IP-based. On the other hand, if you have access to the network but you are not sure whether there are some IP-based cameras, simply query for mDNS and UPnP.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/564e44b6b33cc73b9bb444ea8f22694c?s=256&amp;d=retro" alt="marchiner"><span class="post-comment-author">marchiner</span><div class="post-comment-content">Hi citizens...

Since i saw i IP based cam using wireless i started to think about deathentication atacks and please correct if i am wrong but.. its something extremaly easy to be made in wireless word... if you spoof the target MAC andress and got signal force to send the correct packages. 
So... theres any kind of protection against this deauthentication? And what about Broadcast Deauthentication pckts?
If i am right.. and i hope so that iÂ´m wrong.. its easy to confuse any Ip cam  video system based on wireless.

Nice post pdp... keep going! :D</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/0f08a888192208e211a37923ac8927a8?s=256&amp;d=retro" alt="srcasm"><span class="post-comment-author">srcasm</span><div class="post-comment-content">@marchiner,
You are absolutely right.  It's a scary thought but deauths and broadcast deauths are available to anyone to use.  One of the only ways of protecting from is it to contain your radio signals but this seems like a far-fetched idea for most people/companies.  Maybe one day we'll have a system that is a bit more secure.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/bde4f368cbc5fdf084a89343a27294cd?s=256&amp;d=retro" alt="Vasile Bujor"><span class="post-comment-author">Vasile Bujor</span><div class="post-comment-content">Hi,

I am the IT Manager at a division of BMCO Romania - not Barton Marlow Company - . This article it is interesting, congruatulations. I am a surveillance solutions integrator and I use wireless cameras only for amateur use, and budget limited where the costs of mounting cameras exceed budget. For professional installation I only use FTP and patch cord FTP, and one ideea of using shielded cord is that no startreck technology can be used to interferate with the system and hack it. The only way is to phisically cut the wire or the exterior shield and connect. BUT to have acces at this technology it is expensive and the only way to succed is that the instalaltion could be made by some moron that has no knowledge of cable routing.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">interesting... :) never say impossible! most of the hacks happen because of human mistakes.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/06e2f60be2a86df7930248223baea023?s=256&amp;d=retro" alt="axis.hat0r"><span class="post-comment-author">axis.hat0r</span><div class="post-comment-content">very inspiring text, thank you. would be also very great to have a glimpse over the python scripts, anyone still got them?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">yep, updated the post to outline the correct location of the scripts.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/175d679ed8da66d33ee84b3c6f353f75?s=256&amp;d=retro" alt="Bashar"><span class="post-comment-author">Bashar</span><div class="post-comment-content">need to know the device that can be surround the utp cable to get the video inside the cable.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/0c2a5b435597e697920c07b97f51c441?s=256&amp;d=retro" alt="MeTo"><span class="post-comment-author">MeTo</span><div class="post-comment-content">Sheilded cables are not as shielded as most of you amateurs think! I can sit outside your house about 75ft away and see what is on your screen and your keystrokes. I use a small yagi antenna centered on the 1.25Ghz band. Again that is about the center of the bandwidth needed. I'm not going to mention the technique or software. There is enough crap out here without me contribuing.Yes I am a professional and in law enforcement.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2021 <a href=""></a>. All rights reserved.</p></footer></body></html>