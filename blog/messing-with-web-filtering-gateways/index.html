<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Messing With Web Filtering Gateways</title><meta name="description" content="Most of us are familiar with several techniques that allow us to bypass web filtering gateways like CS MIMESweeper."><meta property="name" content="Messing With Web Filtering Gateways"><meta itemprop="name" content="Messing With Web Filtering Gateways"><meta property="description" content="Most of us are familiar with several techniques that allow us to bypass web filtering gateways like CS MIMESweeper."><meta itemprop="description" content="Most of us are familiar with several techniques that allow us to bypass web filtering gateways like CS MIMESweeper."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fmessing-with-web-filtering-gateways%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fmessing-with-web-filtering-gateways%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/messing-with-web-filtering-gateways/"><meta property="og:title" content="Messing With Web Filtering Gateways"><meta property="og:description" content="Most of us are familiar with several techniques that allow us to bypass web filtering gateways like CS MIMESweeper."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fmessing-with-web-filtering-gateways%2F?w=1024"><meta name="twitter:title" content="Messing With Web Filtering Gateways"><meta name="twitter:description" content="Most of us are familiar with several techniques that allow us to bypass web filtering gateways like CS MIMESweeper."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fmessing-with-web-filtering-gateways%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Messing With Web Filtering Gateways</h1><div class="date">Wed, 14 Jan 2009 17:49:26 GMT</div><div class="author">by pagvac</div><div id="post-content"><p>Most of us are familiar with several techniques that allow us to bypass web filtering gateways like <a href="http://www.clearswift.com/products/msw/web_appliance/default.aspx">CS MIMESweeper</a>.</p>
<p>The following are some of them:</p>
<ol>
<li>access the desired site via IP address rather than domain name</li>
<li>access cached content rather than live data. i.e.: using Google&#39;s <code>[cache:](http://216.239.59.132/search?hl=en&amp;q=cache%3Awww.gnucitizen.org%2Fabout%2F&amp;btnG=Google+Search&amp;meta=)</code> command</li>
<li>using proxies. i.e.: anonymouse, Google translator, etc</li>
<li>using alternative connections. i.e.: connecting your laptop online via your mobile/cell phone&#39;s <a href="http://en.wikipedia.org/wiki/High-Speed_Downlink_Packet_Access">HSDPA</a> interface</li>
</ol>
<p>Each method has different advantages and disadvantages. For instance, method #1 only works on servers that do NOT use domain-based virtual hosts, i.e.: shared hosting. The exception to this rule is that the site served by default when requesting the IP-based URL (rather than domain-based), is the one you&#39;re after. You&#39;ll have to use your judgment when deciding which technique is the right one for you.</p>
<p>Whatever the reason may be, there are many legitimate reasons for accessing websites that are blocked by the gateway in question. Personally, when I&#39;m doing on-site pentests, I sometimes need to access useful online resources, which unfortunately are often flagged under the &quot;hacking&quot; category.</p>
<h3 id="another-nifty-trick">Another nifty trick</h3>
<p>There is perhaps a lesser known technique which although does not work against all appliances, it does work even in cases where the web server you want to connect to uses domain-based virtual hosts. I&#39;ve personally seen work on a Clearswift MIMEsweeper environment. <em>Note that it might not work against the latest versions, so please keep this in mind if you can&#39;t replicate this technique!</em></p>
<p>The idea is to sneak the domain name matching the server&#39;s virtual host, while being able to bypass the content filter. As you know, filtering gateways block bad websites based on domain names. For instance, an HTTP request would be inspected to make sure that the requested URL doesn&#39;t contain a black-listed domain name.</p>
<p>Not too long ago I tested a MIMEsweeper appliance and noticed that HTTP requests were only inspected for bad domain names within the URL data, but not within the <code>Host:</code> header, i.e.:</p>
<pre><code>GET http://1.2.3.4/ HTTP/1.1
Host: www.blockedsite.foo
[some headers removed for clarity purposes]</code></pre><p>The previous HTTP request would bypass MIMEsweeper&#39;s filter (not sure if it works on all versions) even if <a href="http://www.blockedsite.foo">www.blockedsite.foo</a> was a black-listed domain. Reason for that is because only the <code>http://</code> URL is being inspected. The remote server would still happily return the website we&#39;re interested in as we have successfully established a TCP connection, and the desired virtual host has been requested.</p>
<p>I put the following steps together to test this technique using Firefox&#39;s <a href="https://addons.mozilla.org/en-US/firefox/addon/967">Modify Headers</a> extension. Please see the attached screenshots for more details:</p>
<ol>
<li>Get the target site&#39;s IP address by using a command line tool such as ping or host, or public websites such as domaintools.com</li>
<li>Fire up Modify Headers</li>
<li>Add a new modify rule (top-left drop-down menu) and enter <code>Host</code> as a name, and the domain name of the site you want to visit as value</li>
<li>Double-click on the new rule so that the red light becomes green (rule is now active)</li>
<li>If the technique worked against your appliance, you should now be able to freely browse the blocked site by entering its corresponding IP address in your browser&#39;s address bar</li>
</ol>
<p><em>And this is one of the many techniques to bypass web filtering gateways.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/9952e3b43008689e3ddc2ab47b4cd5dd?s=256&amp;d=retro" alt="ax0n"><span class="post-comment-author">ax0n</span><div class="post-comment-content">I threw together a 5-part series on bypassing web filters, and I missed some of these. There are indeed a myriad of ways. Some others worth mentioning:

<ul>
<li>Web-Enabled RSS (Google Reader, yahoo pipes, etc)</li>
<li>Out-of-band (EV-DO, Neighboring WiFi, etc)</li>
<li>Web-Enabled Anonymizers (PHP Proxy, Megaproxy)</li>
<li>Wide-open public proxies on Port 80 (e-pr0xy.com for lists of these)</li>
<li>Tunneling (SSH, ICMP, SSL/HTTP)</li>
</ul>

Indeed, it's quite hard to keep people from accessing content that they really, really want to access. Good write-up.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d54bf9796b2987f9047d47794232d184?s=256&amp;d=retro" alt="Adrian Crenshaw"><span class="post-comment-author">Adrian Crenshaw</span><div class="post-comment-content">Thanks for using me as the test subject. :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/564e44b6b33cc73b9bb444ea8f22694c?s=256&amp;d=retro" alt="marchiner"><span class="post-comment-author">marchiner</span><div class="post-comment-content">I know tha the topic is ralated to proxy bypass techinichs, but.. a example of Tunneling is that tool.. UltraSurf

ItÂ´s very usefull when the objectve is to avoid proxy restrictions of urls and you dont have much time to do it yourself.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c402b08cfc1918f5d76c30d941c2ef16?s=256&amp;d=retro" alt="giano"><span class="post-comment-author">giano</span><div class="post-comment-content">In my high school the admins block "internet traffic" using dans guardian to filter http requests. I noticed how I could freely use ftp or ssh so I'm using a couple of "header distorcing proxies" to bypass the filter: one application runs on the pc i'm using at school increasing by one the value of each letter of the first word in the headers ( HTTP -&gt; IUUQ ) and then passing the stream to a remote proxy which shifts the header back ( IUUQ -&gt; HTTP ). The reverse is done for incoming responses.

What do you think about this? Every feedback is welcomed!!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/3ffb881362a4de765416181fe0be6944?s=256&amp;d=retro" alt="Franck Wurtz"><span class="post-comment-author">Franck Wurtz</span><div class="post-comment-content">A good way to surf all days bypassing the webfitering gateway is to used proxy tunneling.

Here is a demonstration : http://blog.f-wurtz.com/?p=65</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7ff0c51f14dcff43b7830c317e0cdba8?s=256&amp;d=retro" alt="huntingknowledge"><span class="post-comment-author">huntingknowledge</span><div class="post-comment-content">Although ISP's and admins configure to filter such websites, data sniffing while filtering out and writing the requests to rawdata file and analysing mechanism can trace the users requesting website in order to block them.

hence i recommend using a trusted Secured anonymous tunneling like gotunnel.com which is encrypted and which cannot be logged for requested websites.

any other ideas as i suspect my ISP sniffing out for the websites i access.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>