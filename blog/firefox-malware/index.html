<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Firefox Malware</title><meta name="description" content="You may have already heard of this, but there is a malware which goes around disguised as a Firefox extension. I have no details regarding the malicious code but to be honest, I am not surprised at all. In fact, I wonder why it took so long for the bad guys to figure that Firefox is an excellent malware delivery platform. Usually they are quicker."><meta property="name" content="Firefox Malware"><meta itemprop="name" content="Firefox Malware"><meta property="description" content="You may have already heard of this, but there is a malware which goes around disguised as a Firefox extension. I have no details regarding the malicious code but to be honest, I am not surprised at all. In fact, I wonder why it took so long for the bad guys to figure that Firefox is an excellent malware delivery platform. Usually they are quicker."><meta itemprop="description" content="You may have already heard of this, but there is a malware which goes around disguised as a Firefox extension. I have no details regarding the malicious code but to be honest, I am not surprised at all. In fact, I wonder why it took so long for the bad guys to figure that Firefox is an excellent malware delivery platform. Usually they are quicker."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirefox-malware%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirefox-malware%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/firefox-malware/"><meta property="og:title" content="Firefox Malware"><meta property="og:description" content="You may have already heard of this, but there is a malware which goes around disguised as a Firefox extension. I have no details regarding the malicious code but to be honest, I am not surprised at all. In fact, I wonder why it took so long for the bad guys to figure that Firefox is an excellent malware delivery platform. Usually they are quicker."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirefox-malware%2F?w=1024"><meta name="twitter:title" content="Firefox Malware"><meta name="twitter:description" content="You may have already heard of this, but there is a malware which goes around disguised as a Firefox extension. I have no details regarding the malicious code but to be honest, I am not surprised at all. In fact, I wonder why it took so long for the bad guys to figure that Firefox is an excellent malware delivery platform. Usually they are quicker."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirefox-malware%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/blog/">Blog</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Firefox Malware</h1><div class="date">Mon, 08 Dec 2008 19:48:37 GMT</div><div class="author">by pdp</div><div id="post-content"><p>You may have already heard of this, but there is a malware which goes around disguised as a Firefox extension. I have no details regarding the malicious code but to be honest, I am not surprised at all. In fact, I wonder why it took so long for the bad guys to figure that Firefox is an excellent malware delivery platform. Usually they are quicker.</p>
<p>A couple of months back, just before <a href="/blog/my-black-hat-talk/">my BlackHat talk</a>, I was planning to launch yet another of my experiments. It was supposed to be part of the my talk under the &quot;4th generation malware&quot; topic. My plan was to smuggle malicious code as a Firefox addon on <code>addons.mozilla.org</code> as a proof that even benign-looking extensions can contain quite catastrophic backdoors. For obvious reasons I did not go with my plan but the task still seams very much possible.</p>
<p>The reason for this is because JavaScript, XML and anything else Firefox is made of, are quite twisted to follow. We are talking about asynchronous calls, events, language peculiarities and what not. Hiding stuff is dead easy especially when most extensions look like an intermingled blob of crap, i.e. jar files, encodings, URL protocols, other types of encapsulations, etc. There are hundreds of ways to obfuscate malicious code and some times you may even look at it and don&#39;t even realize that it is there unless you spend a huge amount of time figuring your way around functions which at first glance may look like not having much of a purpose but at the same time are the key of unlocking the ugly secret. Add some XPCOM into the mix and you have the recipe for a nightmare. I wonder how the Firefox guys are dealing with the addons flooding their doors on a daily basis.  I personally don&#39;t trust them.</p>
<p>Even if Mozilla implements more granular security model for Firefox extension, in a similar fashion to what the Chrome developers are implementing now, it still wont be enough. The ugly truth is that most users will allow the extension to do whatever as long as it gets what it is asked.</p>
<p>The bottom line is that client-side, more specifically web technologies are immensely complicated. They are ridiculously expressive and at the same time nightmare for debugging and as such they make a perfect medium for smuggling some malicious code into. No FUD, just the ugly reality!</p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/be3b138352dc100c9459e612b275b413?s=256&amp;d=retro" alt="mindcorrosive"><span class="post-comment-author">mindcorrosive</span><div class="post-comment-content">How about developing an addon in such a way that a "plausible deniability" to a gaping security hole is possible? What I mean is - someone can create a not-so-obvious gaping security hole, and still claim innocence, if it can easily be attributed to a coding error, not deliberate action. The thing is, you probably might not be able to pull this more than one or two times.. Then again, some products seem to be literally leaking with remotely exploited security holes - VLC first comes to mind..</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">yup, I don't see why it shouldn't work. :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/318a601d968e1f67c5ddcffa691466d7?s=256&amp;d=retro" alt="Dave"><span class="post-comment-author">Dave</span><div class="post-comment-content">As far as I understand, Firefox was not the delivery platform but rather the target of the malware once it had infected the computer by other means.  I don't remember where I read about it.

The malware installed a plugin and named it GreaseMonkey.  The malicious plugin looked for and logged details for over 100 finance websites such as banks, Paypal, Amazon and eBay.

The rest of your post is, of course, still completely accurate.  The other interesting point this raises is that Firefox has enough marketshare to be worth targeting specifically.  It was inevitable, but it has actually happened now.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/37b5ef749ebd516e99541d628fb21311?s=256&amp;d=retro" alt="Morgan Storey"><span class="post-comment-author">Morgan Storey</span><div class="post-comment-content">Maybe Mozilla needs to get all extensions in their source code format and compile/package it themselves, run a quick search using standard looking obfuscation type code and if any is obfuscated deny the code from being compiled/packaged and therefore not listed on the extensions site.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/51a0313201d038e5930a297e60fcfb9b?s=256&amp;d=retro" alt="Mark Mathson"><span class="post-comment-author">Mark Mathson</span><div class="post-comment-content">Nice post pdp. This brings to light something I have thought for a while. What implied trust do you give to a Firefox add-on when you decide to install it?  Quite a bit really.

One thought is a community review process an add-on goes through before publishing live.  Code reviewed, product beta tested and then given a stamp of approval. I know they have the experimental add-ons, maybe tie this idea in.  I don't know. Plus it wouldn't do any good if the 'community' was "in on it" together. ;-)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/564e44b6b33cc73b9bb444ea8f22694c?s=256&amp;d=retro" alt="marchiner"><span class="post-comment-author">marchiner</span><div class="post-comment-content">AVGs that use pro-active defense like "kaspersky" can deal with new malware?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8d3daa448ffede5ac7af1a9ed8d8222a?s=256&amp;d=retro" alt="Krazy_Kaos"><span class="post-comment-author">Krazy_Kaos</span><div class="post-comment-content">Nice post. Personally if I was to do that, I would first make an extension, a clean one. Release it. Wait 1 week. Release an update (still clean) and on the second update... malware (I think they will not check the source so well the 3rd time).</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7fd84280fe952aaad4f184912357cd2c?s=256&amp;d=retro" alt="Mike"><span class="post-comment-author">Mike</span><div class="post-comment-content">So all we know is that there is some add-on, somewhere, that does...something, and that add-on contains <a href="http://www.sophos.net/" rel="nofollow">malware</a>? Yikes. This is like when I watch my local news and they say something like, "Is an everyday product you use in your house SLOWLY KILLING YOU?...FIND OUT AT 11!"  I need more details!!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/f72334114bb599f37f0a40fa2b077b2b?s=256&amp;d=retro" alt="noone"><span class="post-comment-author">noone</span><div class="post-comment-content">i knew it was only a matter of time.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8484f8e8b5b8e90df61251ffcd4d25ee?s=256&amp;d=retro" alt="adamjakab"><span class="post-comment-author">adamjakab</span><div class="post-comment-content">...three years later...

Just to let you know that there is quite a long <a href="https://forums.mozilla.org/addons/viewtopic.php?f=13&amp;t=4453" rel="nofollow">thread</a> going on started off by me asking a silly question about add-ons 'stealing' data from one another. The sad thing is that no one really worried about stuff like full user privileged file system access and friends. You might be interested but really i don't really see much change since pdp's post in the far 2008. I think as long as FF will consider 3rd party add-ons as "integral part of itself" we will always have to watch our backs!</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2022 <a href=""></a>. All rights reserved.</p></footer></body></html>