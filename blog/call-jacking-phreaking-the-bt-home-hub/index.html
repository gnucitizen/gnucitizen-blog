<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Call Jacking - Phreaking the BT Home Hub</title><meta name="description" content="OK, this is a bit of a funny attack - although it could also be used for criminal purposes! After playing with the BT Home Hub for a while (again!), pdp and I discovered that attackers can steal/hijack VoIP calls. Let me explain ..."><meta property="name" content="Call Jacking - Phreaking the BT Home Hub"><meta itemprop="name" content="Call Jacking - Phreaking the BT Home Hub"><meta property="description" content="OK, this is a bit of a funny attack - although it could also be used for criminal purposes! After playing with the BT Home Hub for a while (again!), pdp and I discovered that attackers can steal/hijack VoIP calls. Let me explain ..."><meta itemprop="description" content="OK, this is a bit of a funny attack - although it could also be used for criminal purposes! After playing with the BT Home Hub for a while (again!), pdp and I discovered that attackers can steal/hijack VoIP calls. Let me explain ..."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fcall-jacking-phreaking-the-bt-home-hub%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fcall-jacking-phreaking-the-bt-home-hub%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/call-jacking-phreaking-the-bt-home-hub/"><meta property="og:title" content="Call Jacking - Phreaking the BT Home Hub"><meta property="og:description" content="OK, this is a bit of a funny attack - although it could also be used for criminal purposes! After playing with the BT Home Hub for a while (again!), pdp and I discovered that attackers can steal/hijack VoIP calls. Let me explain ..."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fcall-jacking-phreaking-the-bt-home-hub%2F?w=1024"><meta name="twitter:title" content="Call Jacking - Phreaking the BT Home Hub"><meta name="twitter:description" content="OK, this is a bit of a funny attack - although it could also be used for criminal purposes! After playing with the BT Home Hub for a while (again!), pdp and I discovered that attackers can steal/hijack VoIP calls. Let me explain ..."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fcall-jacking-phreaking-the-bt-home-hub%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/blog/">Blog</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Call Jacking - Phreaking the BT Home Hub</h1><div class="date">Mon, 21 Jan 2008 02:46:53 GMT</div><div class="author">by pagvac</div><div id="post-content"><p>OK, this is a bit of a funny attack - although it could also be used for criminal purposes! After playing with the BT Home Hub for a while (<a href="http://www.google.com/search?q=site%3Agnucitizen.org+bt+home+hub">again!</a>), pdp and I discovered that attackers can steal/hijack VoIP calls. Let me explain ...</p>
<p>In summary, if the victim visits our evil proof-of-concept webpage, his/her browser sends a HTTP request to the BT Home Hub&#39;s web interface. After this, the Home Hub starts a VoIP/telephone connection to the recipient&#39;s phone number specified in the exploit page. This is what the attack looks like: the victim&#39;s VoIP telephone starts ringing and shows an external call message on the LCD screen along with the recipient&#39;s phone number. However, what&#39;s interesting is that from the point of view of the victim, it looks like he/she is receiving a phone call from the number shown on the screen, but in fact he/she is calling that number! &quot;Sweet, simple and effective, just the way we like it at GNUCITIZEN!&quot;</p>
<pre><code>POST http://api.home/cgi/b/_voip_/stats//?ce=1&amp;be=0&amp;l0=-1&amp;l1=-1&amp;name=

0=30&amp;1=**00390669893461**</code></pre><p>Now, this attack will work even if the default admin password has been changed on the BT Home Hub. Reason for this is that the exploit relies on an authentication bypass vulnerability that we have <a href="/blog/bt-home-flub-pwnin-the-bt-home-hub-4">reported</a> a while ago and hasn&#39;t still been fixed by BT! In our original report, we mentioned that the HTTP authentication mechanism can by bypassed by using double slashes in the target URL. Actually, the authentication can also be bypassed with many other characters, but I&#39;ll leave this to the reader to discover.</p>
<p>The following are some attack scenarios in which this vulnerability could be used for:</p>
<ul>
<li>annoyance or prank purposes</li>
<li>advanced phishing attacks in which the victims gets a phone call from &quot;Trusted Bank&quot; after clicking on a link included in the phishing email. The fact that the attacker calls the victim&#39;s phone number would help him/her gain the victim&#39;s trust. <strong>HINT:</strong> &quot;Phishers usually don&#39;t know your phone number!&quot;</li>
<li>toll fraud attacks in which the victim calls one of those very expensive number that allow the bad guys to make good bucks by simply starting the conversation</li>
</ul>
<p>I don&#39;t want to repeat myself, but please remember that from the victim point of view it <em>looks</em> like he is receiving a phone call but in fact he is making/paying for the phone call!</p>
<iframe class="video" src="//www.youtube.com/embed/0V0YZQWYCHI" frameborder="0" allowfullscreen></iframe>

<p>And finally the boring (but needed) testing details: tested on BT Home Hub firmware 6.2.6.B. Only customers using the BT Broadband Talk service are affected by this attack. Other firmware versions are likely to be affected as well, but we have not tested them.</p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef13278c52026df0c2540c9002cc572c?s=256&amp;d=retro" alt="Pope"><span class="post-comment-author">Pope</span><div class="post-comment-content">hi, interesting post. btw, isn't the phone # in the poc from the vatican?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">one way to protect against this type of attack is to be extra conscious about the type of calls you receive/make from your BT VoIP unit. It might be a good idea to consider using extensions such as <a href="http://noscript.net/" rel="nofollow">NoScript</a> if you are a Firefox user.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">I'd like to repeat that although this attack is new, it's based on vulnerabilities we reported to BT several months ago (auth bypass and CSRF especifically). Such vulnerabilities should have been fixed by now. Instead, it appears that BT simply disabled remote assistance on the Home Hub after our first research was published back in October: http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub

<div class="message">Therefore, there is nothing new to report to BT at this point. If BT had fixed all the Home Hub vulnerabilities we reported in the past, this call jacking attack would NOT be possible.</div>

Therefore I consider BT's statement on <a href="http://www.networkworld.com/news/2008/012108-group-points-to-voip-flaw.html?page=2" rel="nofollow">http://www.networkworld.com/news/2008/012108-group-points-to-voip-flaw.html?page=2</a>: <q>Pastor's public disclosure of the flaw on the blog is highly irresponsible</q> very <strong>inappropriate</strong>.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/271ecedbd232e23677ddc1d3956147eb?s=256&amp;d=retro" alt="hackathology"><span class="post-comment-author">hackathology</span><div class="post-comment-content">interesting post. But is 00390669893461 the voip phone number or the LAN line? How did you derive into that number?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5d685a3e2794af005c472b255c59932b?s=256&amp;d=retro" alt="phil_mcracken"><span class="post-comment-author">phil_mcracken</span><div class="post-comment-content">If I blackholed the DNS for api.home on my local machine (and others on the network) in the HOSTS file, surely that would render this attack useless?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/66dd876212314a4403a074db49fd558c?s=256&amp;d=retro" alt="Tim"><span class="post-comment-author">Tim</span><div class="post-comment-content">BT have claimed this attack doesn't work with the firmware they have rolled out at the moment.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8ca5702a8bce4074592692a8f9acc9bb?s=256&amp;d=retro" alt="Ben Tasker"><span class="post-comment-author">Ben Tasker</span><div class="post-comment-content">Either BT have now fixed it, or not all BT Home Hubs are vulnerable. Mine simply asks for the username and password, and then asks again when I hit cancel.

The phone never rings afterwards, I do have BT BroadBand Talk and a BT Home Hub running Version 6.2.6.E</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content"><blockquote>The rollout of the BT Home Hub firmware version 6.2.6.E started on 12 December 2007. It can take several weeks before all BT Home Hubs are upgraded to a new version of the firmware, so please be patient. <a href="http://bt.custhelp.com/cgi-bin/bt.cfg/php/enduser/cci/bt_adp.php?cat_lvl1=346&cat_lvl2=401&cat_lvl3=407&cat_lvl4=751&p_cv=4.751&p_cats=346,401,407,751&p_faqid=9381" rel="nofollow">BT Support & Advice</a></blockquote></div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">@hackathology - 00390669893461 is an international phone number located in the country whose code is 39 (vatican city in this case): http://www.countrycallingcodes.com/Reverse-Lookup.php?calling-code=39

@Tim - they prob. fixed it. We tested it on 6.2.6.B, which was the most udpated firmware we could get at time of testing without being part of FON. I believe that signing up for FON makes your Home Hub upgrade to a newer firmware? Correct me if I'm wrong.

as pdp pointed out, firmware version 6.2.6.E can take several weeks to upgrade and it appears that many users are having problems receiving the new firmware.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b1df4c2b27687c1a0c82b431621e8539?s=256&amp;d=retro" alt="goundoulf"><span class="post-comment-author">goundoulf</span><div class="post-comment-content">The only way to prevent this with ISP gateways is...

projects like http://www.neufbox4.org which aims at creating an alternative and entirely open firmware for the gateway

ISPs usually break the GPL by using free software and not redistributing, and their gateways rely on security by obscurity.

The customer is then dependent on the firmware upgrade from the ISP following the discovery of a vulnerability, and some times it can take ages before it is corrected.

When the community is in charge of an alternative firmware, vulnerabilities are spotted earlier and corrected faster.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/1d95d2324345e3dd2e41d6066cc1b492?s=256&amp;d=retro" alt="David Kierznowski"><span class="post-comment-author">David Kierznowski</span><div class="post-comment-content">Adrian's laugh is always comical :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/271ecedbd232e23677ddc1d3956147eb?s=256&amp;d=retro" alt="hackathology"><span class="post-comment-author">hackathology</span><div class="post-comment-content">thanks Adrian.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/91eb90c2c8e3694a2f8b75390b13e3ef?s=256&amp;d=retro" alt="Avee"><span class="post-comment-author">Avee</span><div class="post-comment-content">This is pretty useful for autodialing stuff from my laptop. Thanks!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">@David - I guess there is something contagious about my laugh? hehehe

@hackathology - you're welcome dude!

@Avee - actually it'd be quite simple to setup a tool that allows you to dial phone numbers from your laptop with a simple HTML.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">It looks like other home hub users who are also running firmware 6.2.6.B have confirmed our VoIP call jacking hack: http://www.digitalspy.co.uk/forums/showthread.php?t=735655&amp;highlight=6.2.6.B</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/80da0ab18ac5ac0cf93dcf19f2699407?s=256&amp;d=retro" alt="Test-Guru"><span class="post-comment-author">Test-Guru</span><div class="post-comment-content">I cannot believe this is true!</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2021 <a href=""></a>. All rights reserved.</p></footer></body></html>