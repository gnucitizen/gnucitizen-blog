<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>OWI - Yet Another Anonymous Point Of Attack</title><meta name="description" content="About a month ago I traveled by train for a pre-sales meeting with a prospective customer. The trip was about two hours long, which would usually mean that it'd be boring. In this case it was different though: I was surprised with free OWI (Onboard Wireless Internet) on the train!"><meta property="name" content="OWI - Yet Another Anonymous Point Of Attack"><meta itemprop="name" content="OWI - Yet Another Anonymous Point Of Attack"><meta property="description" content="About a month ago I traveled by train for a pre-sales meeting with a prospective customer. The trip was about two hours long, which would usually mean that it'd be boring. In this case it was different though: I was surprised with free OWI (Onboard Wireless Internet) on the train!"><meta itemprop="description" content="About a month ago I traveled by train for a pre-sales meeting with a prospective customer. The trip was about two hours long, which would usually mean that it'd be boring. In this case it was different though: I was surprised with free OWI (Onboard Wireless Internet) on the train!"><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fowi-yet-another-anonymous-point-of-attack%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fowi-yet-another-anonymous-point-of-attack%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/owi-yet-another-anonymous-point-of-attack/"><meta property="og:title" content="OWI - Yet Another Anonymous Point Of Attack"><meta property="og:description" content="About a month ago I traveled by train for a pre-sales meeting with a prospective customer. The trip was about two hours long, which would usually mean that it'd be boring. In this case it was different though: I was surprised with free OWI (Onboard Wireless Internet) on the train!"><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fowi-yet-another-anonymous-point-of-attack%2F?w=1024"><meta name="twitter:title" content="OWI - Yet Another Anonymous Point Of Attack"><meta name="twitter:description" content="About a month ago I traveled by train for a pre-sales meeting with a prospective customer. The trip was about two hours long, which would usually mean that it'd be boring. In this case it was different though: I was surprised with free OWI (Onboard Wireless Internet) on the train!"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fowi-yet-another-anonymous-point-of-attack%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">OWI - Yet Another Anonymous Point Of Attack</h1><div>Fri, 04 Jul 2008 09:35:41 GMT</div><div id="post-content"><p>About a month ago I traveled by train for a pre-sales meeting with a prospective customer. The trip was about two hours long, which would usually mean that it&#39;d be boring. In this case it was different though: I was surprised with free OWI (Onboard Wireless Internet) on the train!</p>
<p>Simply connect to the available open (no encryption) wireless access point and you will be redirected to a <a href="http://www.icomera.com/files/portal.jpg">login portal</a>, aka captive portal. Just like any hotspot you find at coffee shops such as Starbucks. However, I was very pleased to find out that users could login as a guest which means that all passengers could go online without paying any additional fee!</p>
<p>Just to make things clear, going online as a guest was a legitimate form of access provided, as opposed to bypassing the security of the captive portal. <em>NO</em> illegal cracking (i.e.: SQL injection without permission) was done whatsoever!</p>
<p>Kudos to the train company that provides the service! The connection wasn&#39;t super fast, but fast enough to be able to check my email, read the news, update my RSS feeds, chat with my buddies, etc ... It was quite reliable though, which is a big plus as I hate being disconnected while I&#39;m on-line (it reminds me of the old days of dial-up Internet access).</p>
<p>A bit of enumeration 101 led me to <a href="http://www.icomera.com/products/ims">learn</a> that:</p>
<ul>
<li>I was connected to to Sweden via a VPN link (mentioned in the whois records of the NATed IP address which you can obtain on <a href="http://www.ipchicken.com">many</a> <a href="http://www.whatismyip.org">sites</a>)</li>
<li>The service provider is a Swedish company called Icomera AB</li>
<li>The data is transferred wirelessly via 3G and satellite connections</li>
<li>All the train coaches are connected to each other in a Onboard Wireless Network (OWN) which is based on Wi-Fi</li>
</ul>
<p>From a security point of view, this technology adds another &quot;anonymous&quot; point of attack to the already-large list. I say &quot;anonymous&quot; (within quotation marks) because there is no such thing as truly anonymous connectivity. However, one thing is true: if the bad guy knows what he is doing, it becomes unfeasible to track the point of attack and the attacker&#39;s identity. i.e.: it&#39;s not worth starting an investigation if the committed crime didn&#39;t lead to a serious profit loss.</p>
<p>From the top of my head, these are some anonymous points of attack that come to mind:</p>
<ul>
<li><strong>unprotected</strong> (i.e.: no encryption) or crackable (i.e.: WEP) wireless access points: these could belong either to a home internet user, or a company</li>
<li><strong>public hotspots</strong> where guest access is allowed on purpose. i..e: hotspots at airports which do not require to purchase time when going online. So there is no need to provide personal details and credit card details for registering a user account</li>
<li><strong>prepaid SIM cards</strong>: in many places like Europe it&#39;s possible to buy pre-paid SIM cards without providing any personal identification. When combined with buying a mobile/cellphone from a <a href="http://www.cex.co.uk">second-hand items shop</a> it becomes even harder to trace the identity of the attacker (but NOT the location as it can be triangulated in the cells architecture)</li>
<li><strong>misconfigured proxies</strong> (HTTP and SOCKS): they would allow anyone to connect via them without username or password. Although some proxies give away the attacker&#39;s IP address within HTTP headers (i.e.: <code>X-Forwarded-For</code>), there are plenty of <a href="http://www.freeproxy.ru/en/free_proxy/info_about_you.htm">sites</a> that check for proxy-added headers that give away the original source IP address</li>
<li><strong>compromised hosts</strong>: we all are familiar with crackers bouncing their connections via compromised hosts (commonly owned via drive-by downloads attacks and browser exploits)</li>
<li><strong>backdoor</strong>/exposed dial-in <strong>modems</strong>: yes, this is very old school (i.e.: wardialing), but there is still some room for exploitation out there. By the way, Wargames 2 (the Dead Code) sucks really bad! (no joke)</li>
</ul>
<p>Although there are tons of ways for attackers to hide their location and identity, somehow I find OWI more scary than most of them. It&#39;s scary because the attacker is always on the move, which might make tracking his location more difficult due to time correlation issues when comparing logs.</p>
<p>I know what you&#39;re thinking: how is this different to the attacker using a stolen 3G Internet card? After all, using a 3G card would also allow the attacker to be constantly changing his geographical location (i.e.: by being inside a moving vehicle). Well, that&#39;s a good point. However, in the case of using OWI the attacker doesn&#39;t need to steal any equipment.</p>
<p>If you think that being on a fast train won&#39;t make tracking the location of the bad guy when a break-in occurs hard enough, how about doing it on a plane at 800 kmph? Yes, that&#39;s right: free Onboard Wireless Internet aka In-flight wireless internet access, will most likely become very common in the future, which adds another anonymous point of attack to our list. Oh dear, remote Internet break-ins from planes, that&#39;s gonna be fun!</p>
</div><div id="post-comments"><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Marchiner"><span>Marchiner</span><div class="post-comment-content">pdp,

<pre><code>On --> Onboard Wireless Internet.

Where -->1. You have open access points.
           -->2. You connect and your browser redirects to a login page.

if -->1.Use something like airodump-ng, and search for MAC  clients associated to the access point.
   -->2. Select of of the MACs and clone it to your interface.
   -->3. Try one dhcp client.
   -->4. If there is no dhcp, just try to snif something and setup right ip config. 

them --> This may grant you access ??</pre></code></div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Felipe"><span>Felipe</span><div class="post-comment-content">Indeed all these anonymous attack points will become an issue. Hotels that offer free WiFi to clients are also just as good. I am staying at a nice hotel in Brussels (there is a NATO conference btw right now) with a nice open and free WiFi that can even be accessed by the guests of the next door competition hotel.

It something ever happens the farthest it can be traced would be to say the hotel, train, plane, etc. The level of granularity that the free provider uses from then on (be able to distinguish that the specific connection belongs to the passenger in place X or Y or to hotel guest in room 333) will not help much either as we come to the same situation as a home open wireless network.

A paradise of anonimity for the new shool ever travelling hacker.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="bluebirch"><span>bluebirch</span><div class="post-comment-content">Security-threw-identity doesn't work. Even if you could remove all anonymous access you would do more harm than good. Journalism needs anonymity for example. And anonymous access on planes? C'mon you need fake passports to get on anonymously and if it gets tracked to the plane there is no way to escape.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Radu"><span>Radu</span><div class="post-comment-content">I don't think this is that much of an issue. Most of these Open Hot-Spots only allow http/https/smtps/imap/im traffic. I know http/https are more than enough for a lot of attacks but even if you identify the source of an attack trough these protocols you might just end up seeing a TOR exit node, so i can't imagine why this is such a serious issue. At least for OWI you might have some actual data to tie to the attacker: credit card purchase of train tickets or, even better, a flight passenger list. Frankly the only alternative to this issue, as far as i can see, is a total lack of anonymity and i don't find that very comforting.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="cedric"><span>cedric</span><div class="post-comment-content">You left out, the trains login portal actually tells you to log in as "guest".  It did the last time I was on the train from KingsCross to Peterborough.

Your right the implementation is from a Swedish firm, but your missing out talking about the routing in depth (network mapping skills) and their interesting proxy provider.

What about the GPS????</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Sandro Gauci"><span>Sandro Gauci</span><div class="post-comment-content">I see it differently. The speed at which the attacker is traveling doesn't really matter. I think that if the attacker is on a train or a plane, then the destination is a known and static one. Once he or she is off the plane or train, that's where he/she can be caught by the local police / mafia / whatever. 

Of course, unless the attacker hijacks the plane or train. But we're not talking about terrorist plots here.. I hope :)</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian 'pagvac' Pastor"><span>Adrian 'pagvac' Pastor</span><div class="post-comment-content">@bluebirch: who needs a fake passport when you're on a plane with more than 500 passengers. The question is: which passenger committed the crime? That's the challenge. But then again, I'm not saying it's impossible to catch the bad guy on the plane. Your point of more than valid.

@Marchiner: this is pagvac, notice the author at bottom :).

I'm aware of MAC cloning for using commercial APs for free. Once you login with a registered account that has Internet time, the system simply identifies you based on your MAC address which can be cloned both on Win and *nix. The only problem with MAC cloning for free Internet access is that you don't want to clone the MAC address of a user that is currently online as it corrupts the network traffic. So Ideally you want to collect a list of MAC addresses of users who have online access, and only clone a given MAC address while its respective user is NOT online.

I've also researched alternative ways (different MAC cloning) to get free Internet at hotels which I presented at a Defcon meeting in London. Perhaps I should upload the slides to GNUCITIZEN!</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">I agree with Adrian. It becomes significantly harder to track the real location where an attack is launched from. If the attacker is not sloppy and has some basic knowledge regarding IT (some of them don't) then s/he can hide her/his tracks to the extend that is no longer feasible to launch a pursuit. Think of FON.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="marchiner"><span>marchiner</span><div class="post-comment-content">Hi Adrian, 

sorry for calling yoy... "pdp".. credits for "pagvac"."Pdp" its a nice guy, but no credits for him now! I just sow the mistake minutes after posting... 

But so...

Let's came back to the topic...

"I've also researched alternative ways (different MAC cloning) to get free Internet at hotels which I presented at a Defcon meeting in London. Perhaps I should upload the slides to GNUCITIZEN!"

Please... post your presentation.. as it possible!  I live to far away from London, so it's hard watch this things. Thank god... Internet exists! :D

Continue ....

This week i had a conversation with some people that represent companies like "3com" and deploy corporative wireless. So... something like:

Wireless Switch + 802.1x + radius... and blah blah blah!

Someone there said about some changes on XP SP3 and Win Vista.

Where 802.1x will become first than layer 2...

but i don't knows if this is true.. i didn't research anything about it yet. But i will do soon. If this is right, "MAC cloning is out" i believe.

Do you know something about it "pagvac" not "pdp"?  :D</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="LonerVamp"><span>LonerVamp</span><div class="post-comment-content">I'm not sure I see much difference from any other wireless hotspot. I don't think I've ever used one that would have been able to find me had I been nearby and doing something naughty. And even if I felt like someone may be watching, I can just up and move. And I have yet to see or even hear of any wireless/hotspot implementation that has resident geeks or IT at hand enough to do anything about whatever I do.

I don't see this as much different from how things were in 2003, but I admit as access becomes more ubiquitous and free, the capability to track malicious activity to a physical person becomes a more apparent challenge.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="TP"><span>TP</span><div class="post-comment-content">Why should anonymously be a bad thing? It's a bit the standard argument if you have nothing to hide you should not fear the new anti-privacy laws and procedures.

Their can be many reasons to be anonymous with out being hacking, cracker or terrorist.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2019 <a href=""></a>. All rights reserved.</p></footer></body></html>