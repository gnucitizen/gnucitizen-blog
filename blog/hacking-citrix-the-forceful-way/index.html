<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Hacking CITRIX - the forceful way</title><meta name="description" content="Yesterday I briefly covered how CITIRX hacking works by performing simple enumeration exercises. Today, I will show you how to drill."><meta property="name" content="Hacking CITRIX - the forceful way"><meta itemprop="name" content="Hacking CITRIX - the forceful way"><meta property="description" content="Yesterday I briefly covered how CITIRX hacking works by performing simple enumeration exercises. Today, I will show you how to drill."><meta itemprop="description" content="Yesterday I briefly covered how CITIRX hacking works by performing simple enumeration exercises. Today, I will show you how to drill."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-citrix-the-forceful-way%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-citrix-the-forceful-way%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/hacking-citrix-the-forceful-way/"><meta property="og:title" content="Hacking CITRIX - the forceful way"><meta property="og:description" content="Yesterday I briefly covered how CITIRX hacking works by performing simple enumeration exercises. Today, I will show you how to drill."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-citrix-the-forceful-way%2F?w=1024"><meta name="twitter:title" content="Hacking CITRIX - the forceful way"><meta name="twitter:description" content="Yesterday I briefly covered how CITIRX hacking works by performing simple enumeration exercises. Today, I will show you how to drill."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fhacking-citrix-the-forceful-way%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Hacking CITRIX - the forceful way</h1><div class="date">Fri, 05 Oct 2007 15:39:03 GMT</div><div class="author">by
<a href="/members/pdp.html">pdp</a></div><div id="post-content"><p><a href="/blog/citrix-owning-the-legitimate-backdoor">Yesterday</a> I briefly covered how CITIRX hacking works by performing simple enumeration exercises. Today, I will show you how to drill.</p>
<p>As ways, I prepared a video that demonstrates the attack in more visual way. BTW, 90% of test I&#39;ve done are subjected this type of attack. It is insane really.</p>
<iframe class="video" src="//www.youtube.com/embed/i_zbObjFnrY" frameborder="0" allowfullscreen></iframe>

<p>In case the video does not work, you can download the high-quality version from over <a href="/files/2007/10/hc02.wmv">here</a>.</p>
<p>I also did some coding as well. The following <a href="/files/2007/10/bforce.js">script</a> can be used to bruteforce the Windows/Netware logon. With a few mods you can make it work for CITRIX SSLs auth as well.</p>
<pre><code>[/files/2007/10/bforce.js](/files/2007/10/bforce.js)

I have [another script](/files/2007/10/connect.js), which I use to fine tune connections - very suitable when you don&#39;t want to deal with ICA but you want to tryout different citrix communication mechanisms and connection options.

[/files/2007/10/connect.js](/files/2007/10/connect.js)</code></pre><p><em>This is it. I hope that you enjoyed the demo.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/2fbd3fcfa626bd4301c18cdbd207a7bb?s=256&amp;d=retro" alt="vindic"><span class="post-comment-author">vindic</span><div class="post-comment-content">amazing again :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d89d5e399fdeaccee6cbb3404979446f?s=256&amp;d=retro" alt="slasher"><span class="post-comment-author">slasher</span><div class="post-comment-content">Hello, first thank you for a great site, it is very nice and informative. I have one remark though, the resolutions of your videos, the text is too small, one can not follow the commands even if the youtube window is maxed.

Thanks.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">slasher, yes... that's why I included the wmv file at the bottom of this article. It should give you a lot better idea of what's going on.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/06153f784be70e3391b07b3582683c0f?s=256&amp;d=retro" alt="Sirw2p"><span class="post-comment-author">Sirw2p</span><div class="post-comment-content">I love the themesong.. is the same that the film "Oceans eleven" yeah.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/54f782b5b57b73514e980457b9c46e3f?s=256&amp;d=retro" alt="radi"><span class="post-comment-author">radi</span><div class="post-comment-content">what about enum.js...? any clues as to where that can be found?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/f8069e4c4dcb95906f6f6e2604bc7677?s=256&amp;d=retro" alt="NIX"><span class="post-comment-author">NIX</span><div class="post-comment-content">radi,

the enum.js can be found in the other article titled <a href="http://www.gnucitizen.org/blog/citrix-owning-the-legitimate-backdoor/" rel="nofollow">CITRIX: Owning the Legitimate Backdoor</a>.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">NIX, thanks... the file can be found over <a href="http://www.gnucitizen.org/blog/citrix-owning-the-legitimate-backdoor/" rel="nofollow">here</a>.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/7d1909093d4a91dbf8656f3517803ae8?s=256&amp;d=retro" alt="radi"><span class="post-comment-author">radi</span><div class="post-comment-content">*hides head in shame* oopps.... sorry about that guys!!! :) my bad i should have read the other article more carefully.....</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ad5ae19eea92e99533f20e6f1946cf43?s=256&amp;d=retro" alt="Anthony D."><span class="post-comment-author">Anthony D.</span><div class="post-comment-content">You should note that you are demonstrating exploiting a poorly implemented security model. When implemented correctly using existing Citrix security features and Microsoft Security Features your attacks would not work at all.

This was an attack against a poorly implemented Citrix environment.

Nice work either way!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Anthony D., yes you are right. The reason I came up with the script is mainly because I wasn't aware of any other CITRIX authentication bruteforcer.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/44edbe0992be2a90b8c4978195af2220?s=256&amp;d=retro" alt="RX8volution"><span class="post-comment-author">RX8volution</span><div class="post-comment-content">pdp : How do you account for domains?  I am working on password "grinding" or brute-force... and don't quite get how to append the Domain name into your script... would be a nice pen-test tool...</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">RX8volution, I forgot to include that. Give me some time and I will come with an updated script, or you can do that yourself if you want to.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Apparently CITRIX has removed the YouTube videos due to a copyright violation. This is strange and the same time not the right way to handle situations like this.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b96d5ce60e7d3b90ce61b23086caf70d?s=256&amp;d=retro" alt="Jonathan"><span class="post-comment-author">Jonathan</span><div class="post-comment-content">It's strange that Citrix should be able to do this. Does your video:

1. breach the copyright of Citrix, or
2. describe a method for illegally circumventing copyright protection?

If not, then perhaps you could file a "counter-take-down" notice to YouTube, as described here: //www.youtube.com/t/dmca_policy.

This approach was famously used by Christopher Knight:
http://theknightshift.blogspot.com/2007/08/viacom-hits-me-with-copyright.html

Keep on hacking!
Jonathan</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Jonathan, thanks. I am not very sure. I guess it has something to do with the CITRIX logo, which appears on the screen when a connection is established.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/6dc7cf0372f3966e266c626486a83ab1?s=256&amp;d=retro" alt="curious mind"><span class="post-comment-author">curious mind</span><div class="post-comment-content">I'm wondering what FREE features Citrix has for deploying apps to the internet in a secure manner. The only thing I could find was the Citrix Secure Gateway 3.0 (is this still supported or maintained?) from which the admin guide and checklist is no longer avaiable so forget about the documentation. 

So as it would seem, you maybe required to purchase a Citrix Access Gateway to secure your Citrix environment am I correct..? If so, this would mean that making Citrix apps available across the web would not be secure out of the box without buying additional hardware.
This is not a statement but more a question I have...</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">curious mind, I have no idea how CITRIX is shipped but I believe that you are on the right track. However, it is up to the administrator to export applications that does not require authentication. In case your ICA is in the DMZ and you have one of these application hanging out in there, then you are in a big trouble. Unfortunately, this is what I see most of the times.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/6dc7cf0372f3966e266c626486a83ab1?s=256&amp;d=retro" alt="curious mind"><span class="post-comment-author">curious mind</span><div class="post-comment-content">pdp, I totally agree...applications without authentication is asking for trouble..but as you showed that even with authentication you're not really safe that's why I hope somebody can answer my  questions..</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/30e31425cc4a2328ad21434199921f8c?s=256&amp;d=retro" alt="xyyzy"><span class="post-comment-author">xyyzy</span><div class="post-comment-content">Where are the videos? seems youtube has removed them.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">check the bottom of the post</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/30e31425cc4a2328ad21434199921f8c?s=256&amp;d=retro" alt="xyyzy"><span class="post-comment-author">xyyzy</span><div class="post-comment-content">thanks pdp, found them</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/1211ecc94ba2e83b71461323c865aa00?s=256&amp;d=retro" alt="jeff"><span class="post-comment-author">jeff</span><div class="post-comment-content">Gone again, the links...</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">back again :) still moving infrastructures...</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/fff012c69b1c07ec184a6bf0dd752499?s=256&amp;d=retro" alt="infoz"><span class="post-comment-author">infoz</span><div class="post-comment-content">What did you do to get the scripts working in XP? They execute fine from cmd, wscript is installed, .net, etc.. but they never launch the Citrix client (which is also installed) for enum, connect or bforce. I can launch an .ica file to the target server with no issues however running the .js files never launch the client. Any help is appreciated!</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2025 <a href=""></a>. All rights reserved.</p></footer></body></html>