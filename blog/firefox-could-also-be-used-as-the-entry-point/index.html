<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Firefox Could Also Be Used As The Entry Point</title><meta name="description" content="From Window Snyder's blog:"><meta property="name" content="Firefox Could Also Be Used As The Entry Point"><meta itemprop="name" content="Firefox Could Also Be Used As The Entry Point"><meta property="description" content="From Window Snyder's blog:"><meta itemprop="description" content="From Window Snyder's blog:"><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirefox-could-also-be-used-as-the-entry-point%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirefox-could-also-be-used-as-the-entry-point%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/firefox-could-also-be-used-as-the-entry-point/"><meta property="og:title" content="Firefox Could Also Be Used As The Entry Point"><meta property="og:description" content="From Window Snyder's blog:"><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirefox-could-also-be-used-as-the-entry-point%2F?w=1024"><meta name="twitter:title" content="Firefox Could Also Be Used As The Entry Point"><meta name="twitter:description" content="From Window Snyder's blog:"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Ffirefox-could-also-be-used-as-the-entry-point%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Firefox Could Also Be Used As The Entry Point</h1><div class="date">Tue, 24 Jul 2007 08:11:45 GMT</div><div class="author">by pdp</div><div id="post-content"><p>From Window Snyder&#39;s <a href="http://blog.mozilla.com/security">blog</a>:</p>
<blockquote>
<p>Over the weekend, we learned about a new scenario that identifies ways that Firefox could also be used as the entry point. While browsing with Firefox, a specially crafted URL could potentially be used to send bad data to another application.</p>
</blockquote>
<blockquote>
<p>We thought this was just a problem with IE. It turns out, it is a problem with Firefox as well. We should have caught this scenario when we fixed the related problem in 2.0.0.5. We believe that defense in depth is the best way to protect people, so we&#39;re investigating it now.</p>
</blockquote>
<blockquote>
<p><a href="http://blog.mozilla.com/security/2007/07/23/related-security-issue-in-url-protocol-handling-on-windows/">Mozilla Security Blog</a></p>
</blockquote>
<p>More information on the issue can be found at <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=389106">https://bugzilla.mozilla.org/show_bug.cgi?id=389106</a>. For those of you who don&#39;t know what this actually means, here is my interpretation:</p>
<p>Every application can register protocol handler to hook on certain types of URLs when executed. Most applications do that just for accessibility purposes. This feature can be abused to launch those applications and send arbitrary commands to them. Depending what type of functionalities the attacked application may have, attackers may or may not be able to gain full access to the underlaying operating system. Here is a simple registry patch that adds a simple protocol handler called <strong>testurl</strong> hooked up to an application located at <code>c:\test.exe</code>:</p>
<pre><code>[HKEY_CLASSES_ROOT\TestURL]
@=URL:Test Protocol
&quot;URL Protocol&quot;=&quot;&quot;
[HKEY_CLASSES_ROOT\TestURL\DefaultIcon]
@=&quot;cmd.exe&quot;
[HKEY_CLASSES_ROOT\TestURL\shell]
[HKEY_CLASSES_ROOT\TestURL\shell\open]
[HKEY_CLASSES_ROOT\TestURL\shell\open\command]
@=&quot;\&quot;c:\\test.exe\&quot; \&quot;%1\&quot;&quot;</code></pre><p><strong>taken from <a href="http://msinfluentials.com/blogs/jesper/archive/2007/07/20/hey-mozilla-quotes-are-not-legal-in-a-url.aspx">Jesper Johansson</a>&#39;s blog</strong></p>
<p>Although the user is warned that an external application is about to be executed, attackers can simply social engineer their way to make the victim approve it. How? For example, use a simple while loop that calls the URL subsequently until the user clicks on the launch button, which obviously will lead to the system being compromised.</p>
<p>Funny enough Firefox can be used to compromise itself. The Firefox application protocol is called <code>FirefoxURL</code>. You can call Firefox and pass values to the <strong><code>-chrome</code></strong> parameter. These values will be evaluated within the context from chrome which has full access to the local system or more precisely the local user. For more information on how to exploit the <code>FirefoxURL</code> protocol visit <a href="http://larholm.com/2007/07/10/internet-explorer-0day-exploit/">Thor Larholm</a>&#39;s blog.</p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Giorgio Maone"><span class="post-comment-author">Giorgio Maone</span><div class="post-comment-content">NoScript at rescue as usual :)

v 1.1.6.06
=====================================================================
x Early protection against URL protocol handling exploitation

--
There's a browser safer than firefox... http://noscript.net</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">yep :) like always</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>