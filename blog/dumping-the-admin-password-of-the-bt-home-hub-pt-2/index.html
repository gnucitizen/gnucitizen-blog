<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Dumping The Admin Password Of The BT Home Hub (pt 2)</title><meta name="description" content="This is just a quick update regarding our previous post which details how to extract the default admin password for the latest firmware of the BT Home Hub (6.2.6.E at time of writing). I recommend you to read the previous post if you have not done so yet."><meta property="name" content="Dumping The Admin Password Of The BT Home Hub (pt 2)"><meta itemprop="name" content="Dumping The Admin Password Of The BT Home Hub (pt 2)"><meta property="description" content="This is just a quick update regarding our previous post which details how to extract the default admin password for the latest firmware of the BT Home Hub (6.2.6.E at time of writing). I recommend you to read the previous post if you have not done so yet."><meta itemprop="description" content="This is just a quick update regarding our previous post which details how to extract the default admin password for the latest firmware of the BT Home Hub (6.2.6.E at time of writing). I recommend you to read the previous post if you have not done so yet."><meta property="image" content="https://www.gnucitizen.org/files/2008/05/bthh_sn_a-162x150.png &quot;BTHH SN A PNG&quot;"><meta itemprop="image" content="https://www.gnucitizen.org/files/2008/05/bthh_sn_a-162x150.png &quot;BTHH SN A PNG&quot;"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/dumping-the-admin-password-of-the-bt-home-hub-pt-2/"><meta property="og:title" content="Dumping The Admin Password Of The BT Home Hub (pt 2)"><meta property="og:description" content="This is just a quick update regarding our previous post which details how to extract the default admin password for the latest firmware of the BT Home Hub (6.2.6.E at time of writing). I recommend you to read the previous post if you have not done so yet."><meta property="og:image" content="https://www.gnucitizen.org/files/2008/05/bthh_sn_a-162x150.png &quot;BTHH SN A PNG&quot;"><meta name="twitter:title" content="Dumping The Admin Password Of The BT Home Hub (pt 2)"><meta name="twitter:description" content="This is just a quick update regarding our previous post which details how to extract the default admin password for the latest firmware of the BT Home Hub (6.2.6.E at time of writing). I recommend you to read the previous post if you have not done so yet."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://www.gnucitizen.org/files/2008/05/bthh_sn_a-162x150.png &quot;BTHH SN A PNG&quot;"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Dumping The Admin Password Of The BT Home Hub (pt 2)</h1><div>Tue, 27 May 2008 09:11:51 GMT</div><div id="post-content"><p>This is just a quick update regarding our <a href="/blog/dumping-the-admin-password-of-the-bt-home-hub">previous post</a> which details how to extract the default admin password for the latest firmware of the BT Home Hub (6.2.6.E at time of writing). I recommend you to read the previous post if you have not done so yet.</p>
<p>The BT Home Hub&#39;s serial number - which is the default admin password - can also be found on UPnP description XML files. If you own a BT Home Hub, just notice the serialNumber tags on <code>http://api.home/upnp/IGD.xml</code> and <code>http://api.home/dslf/IGD.xml</code></p>
<blockquote>
<p>Note that no password is required to access such files, as they&#39;re used for UPnP (authentication-less) operations. Note: UPnP is enabled by default on the BTHH.</p>
</blockquote>
<p>The attack needs to take place either via the Ethernet or the WLAN (Wi-Fi) interface, just like the MDAP attack described in our previous post. Unless of course you use a cross-domain vulnerability such as XSS which allows you to remotely scrape the contents of the description XML files and send them to a third-party site. Remember that the default admin password is simply the serial number with the string &#39;CP&#39; prefixed to it. In other words, if the serial number was <code>0633EHPSL</code>, the default admin password for the Home Hub would be <code>CP0633EHPSL</code>. Enjoy!</p>
<p><strong>UPDATE:</strong> the serial number disclosure reported in this post was originally tested on a BT Home Hub running firmware version 6.2.2.6 (please see screenshots for more information). However, it appears that BT has replaced such information with the Hub&#39;s MAC address in the latest firmware (6.2.6.E at time of writing).</p>
<div class="screen">[![](/files/2008/05/bthh_sn_a-162x150.png "BTHH SN A PNG")](/files/2008/05/bthh_sn_a.png) [![](/files/2008/05/bthh_sn_b-188x150.png "BTHH SN B")](/files/2008/05/bthh_sn_b.png)</div>

<p><em>Since only the latest firmware uses the Hub&#39;s serial number as the default admin password, the reported serial number disclosure via UPnP XML description files is NOT exploitable. Nevertheless, the <a href="/blog/dumping-the-admin-password-of-the-bt-home-hub/">MDAP attack</a> has been verified on the latest firmware and has been confirmed by several users both on the BT Home Hub v1 and v1.5.</em></p>
</div><div id="post-comments"><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="MJW"><span>MJW</span><div class="post-comment-content">I'm on 6.2.6.E and I've checked the IGD.xml file, the Serial Number field shows my MAC code not the serial number. Is this a change in 6.2.6.E?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Stephen"><span>Stephen</span><div class="post-comment-content">On my HH v15 the serialnumber field has the MAC address in it</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Stephen"><span>Stephen</span><div class="post-comment-content">Just to add that I'm on 6.2.6.E (forgot to mention that)</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Stephen"><span>Stephen</span><div class="post-comment-content">Apologies for three posts in a row but I just checked and UPnP is definitely switched off on my HH (I immediately disabled it on reading your initial HH posts some months ago).

Should these files still be available even when UPnP is off? Because they are...</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span>pdp</span><div class="post-comment-content">even when you switch off UPnP the IGD description may still be present.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Stephen"><span>Stephen</span><div class="post-comment-content">Ok. Reading it in detail the upnp/IGD.xml file contains the following:

<pre><code>Device not enabled: UPNP-IGD</code></pre>

So at least it seems to be off. However the dslf/IGD.xml looks like it still offers services - does this mean that even turning off UPnP that one could still utilise the dslf stuff to pwn it?</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="rishi"><span>rishi</span><div class="post-comment-content">Have any flaws been found in the H firmware? Thanks!</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian 'pagvac' Pastor"><span>Adrian 'pagvac' Pastor</span><div class="post-comment-content">The serial number disclosure reported in this post was originally tested on a BT Home Hub running firmware version 6.2.2.6. However, it appears that BT has replaced such information with the Hub's MAC address in the latest firmware (6.2.6.E at time of writing).

Since only the latest firmware uses the Hub's serial number as the default admin password, the reported serial number disclosure via UPnP XML description files is NOT exploitable. 

Nevertheless, the MDAP attack described in our previous post has been verified on the latest firmware and has been confirmed by several users both, on the BT Home Hub v1, and v1.5.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Aaron"><span>Aaron</span><div class="post-comment-content">You can dump the serial number of the HomeHub 6.2.6.E by connecting to the HTTPS port and examining the SSL Certificate... the default OU of the certificate issuer is the serial number of the device...

Hence, the pwndhub I am currently using has just dished out this after I ran a Nessus scan on it...

<pre><code>OU = 0641EHJRR
O = THOMSON
CN = BT Home Hub</code></pre>

Please verify this works for others...</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Stephen"><span>Stephen</span><div class="post-comment-content">I can verify that the OU of the SSL certificate gives the serial number on 6.2.6.E on my HH v1.5

Just point your browser to https://api.home/ and click examine certificate when prompted ;)</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Adrian 'pagvac' Pastor"><span>Adrian 'pagvac' Pastor</span><div class="post-comment-content">We got a winner :) I can confirm this works on the BT Home Hub v1, firmware 6.2.6.E. Good catch Aaron! Any other ideas on how to obtain the Hub's S/N and therefore the default admin password? The more techniques the merrier!

btw, the troubleshooting page - which doesn't require a password to be seen - *used to* include the S/N but BT removed such info in the latest firmware: https://api.home/cgi/b/bttroubleshooting/</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Gary"><span>Gary</span><div class="post-comment-content">You can also get the Serial Number by visiting this page: http://pbteu.bt.motive.com/ElectiveFWUpgradePortal/ and clicking on "Schedule your BT Home Hub upgrade"

or follow the link direct: http://pbteu.bt.motive.com/ElectiveFWUpgradePortal/jsp/Loading.jsp?URL=Schedule.jsp

This has to be done while connected to a HomeHub.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Martin"><span>Martin</span><div class="post-comment-content">Gary, that was perfect. I couldn't get the other methods to work as I didn't realise you had to add on the CP to the start of what was returned.</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="fLaMePr0oF"><span>fLaMePr0oF</span><div class="post-comment-content">Another method for getting the serial number of any BTHH is to download and run the latest BT Home Hub Recovery Tool 6.2.2.6 (can get it here: http://www.josephn.net/download/dl.php?file=bthh_recovery)...  When the tool tries to access the HH and asks for authentication, the serial number will be displayed above the user/pass input fields.

(LoL @ BT for changing password to serial to improve security when serial can be accessed SO easily!)</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pwn-a-cycle"><span>pwn-a-cycle</span><div class="post-comment-content">the link is http://www.josephn.net/download/dl.php?file=bthh_recovery

@fLaMePr0oF - seems you accidently appended a ).. to the url</div></div><div class="post-comment"><img src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Andy"><span>Andy</span><div class="post-comment-content">You can still get the serial. Go to https://api.home View the cert like said, but it's simply the OU- organizational unit above serial number. Add CP to that string, and that's the serial.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2019 <a href=""></a>. All rights reserved.</p></footer></body></html>