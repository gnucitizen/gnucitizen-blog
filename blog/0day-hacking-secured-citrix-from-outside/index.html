<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>0day Hacking Secured CITRIX From Outside</title><meta name="description" content="In the true spirit of GNUCITIZEN half(partial)-disclosure movement, we announce that it is possible to gain user access level on CITRIX. The bug/feature does not rely on any client/server vulnerabilities nor client/server misconfiguration issues. All an attacker needs to do to exploit the weakness is to lure a victim to a malicious website or trick him/her into opening specially crafted ICA files. The attack results into remote command execution inside CITRIX with the access level of the current user."><meta property="name" content="0day Hacking Secured CITRIX From Outside"><meta itemprop="name" content="0day Hacking Secured CITRIX From Outside"><meta property="description" content="In the true spirit of GNUCITIZEN half(partial)-disclosure movement, we announce that it is possible to gain user access level on CITRIX. The bug/feature does not rely on any client/server vulnerabilities nor client/server misconfiguration issues. All an attacker needs to do to exploit the weakness is to lure a victim to a malicious website or trick him/her into opening specially crafted ICA files. The attack results into remote command execution inside CITRIX with the access level of the current user."><meta itemprop="description" content="In the true spirit of GNUCITIZEN half(partial)-disclosure movement, we announce that it is possible to gain user access level on CITRIX. The bug/feature does not rely on any client/server vulnerabilities nor client/server misconfiguration issues. All an attacker needs to do to exploit the weakness is to lure a victim to a malicious website or trick him/her into opening specially crafted ICA files. The attack results into remote command execution inside CITRIX with the access level of the current user."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2F0day-hacking-secured-citrix-from-outside%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2F0day-hacking-secured-citrix-from-outside%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/0day-hacking-secured-citrix-from-outside/"><meta property="og:title" content="0day Hacking Secured CITRIX From Outside"><meta property="og:description" content="In the true spirit of GNUCITIZEN half(partial)-disclosure movement, we announce that it is possible to gain user access level on CITRIX. The bug/feature does not rely on any client/server vulnerabilities nor client/server misconfiguration issues. All an attacker needs to do to exploit the weakness is to lure a victim to a malicious website or trick him/her into opening specially crafted ICA files. The attack results into remote command execution inside CITRIX with the access level of the current user."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2F0day-hacking-secured-citrix-from-outside%2F?w=1024"><meta name="twitter:title" content="0day Hacking Secured CITRIX From Outside"><meta name="twitter:description" content="In the true spirit of GNUCITIZEN half(partial)-disclosure movement, we announce that it is possible to gain user access level on CITRIX. The bug/feature does not rely on any client/server vulnerabilities nor client/server misconfiguration issues. All an attacker needs to do to exploit the weakness is to lure a victim to a malicious website or trick him/her into opening specially crafted ICA files. The attack results into remote command execution inside CITRIX with the access level of the current user."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2F0day-hacking-secured-citrix-from-outside%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">0day Hacking Secured CITRIX From Outside</h1><div class="date">Wed, 10 Oct 2007 15:40:34 GMT</div><div class="author">by
<a href="/members/pdp.html">pdp</a></div><div id="post-content"><p>In the true spirit of GNUCITIZEN half(partial)-disclosure movement, we announce that it is possible to gain user access level on CITRIX. The bug/feature does not rely on any client/server vulnerabilities nor client/server misconfiguration issues. All an attacker needs to do to exploit the weakness is to lure a victim to a malicious website or trick him/her into opening specially crafted ICA files. The attack results into remote command execution inside CITRIX with the access level of the current user.</p>
<p>The success of the attack relies on the fact that the victim is part of a CITRIX ring to which he/she can perform pass-through authentication. Once a connection is instantiated, the victim will unwillingly and transparently login into CITIRIX and perform several commands specified by the attacker. The attacker can simply instruct the remote desktop to download files from a remote TFTP server and execute them locally. Once the attack is performed, the local connection is terminated and the CITRIX session is cleared. No user interaction is required!</p>
<blockquote>
<p>If you manage to re-discover the type of vulnerability outlined in this post, I encourage you to keep it private. Give some time for the folks at CITRIX to react. Currently, I am not aware of any remedy against the attack apart from turning off pass-through authentication. Given CITRIX&#39;s popularity among corporations and big organizations, it is highly recommended to take this warning with extra caution.</p>
</blockquote>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&amp;d=retro" alt="Adrian Pastor"><span class="post-comment-author">Adrian Pastor</span><div class="post-comment-content">Nice work. Let's keep the client-side hacks coming!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/2fbd3fcfa626bd4301c18cdbd207a7bb?s=256&amp;d=retro" alt="vindic"><span class="post-comment-author">vindic</span><div class="post-comment-content">Yes, very nice, thnx for good work ;)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/d21c24ebcd620ac30f876e5a92904a1a?s=256&amp;d=retro" alt="zeridon"><span class="post-comment-author">zeridon</span><div class="post-comment-content">Looks nice,

and also i see a storm brewing ... smth. like the 0day pdf.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/8288f51796514beb3c57314ebcfa5423?s=256&amp;d=retro" alt="rootkid"><span class="post-comment-author">rootkid</span><div class="post-comment-content">Oh bummer. Man, I was investigating the same stuff (citrix that is) at the moment, and somehow you are always a leap ahead. I hate that...:) Anyhow, good work as always. I would really like to have a chat with you someday if you happen to be around (any con you are on this year in europe?). Probably we can share ideas, if you like. 
Cheers.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">rootkid, there is nothing on the horizon for me in europe for the rest of this year. feel free to contact me through!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/cd1b2be4df9002f9cf7f93a8807a642f?s=256&amp;d=retro" alt="hellboy726"><span class="post-comment-author">hellboy726</span><div class="post-comment-content">Nice!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">hellboy726, interesting site you have there! reminds  me of 1998... but I like it.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/3174bb62ad708abe84a3e3cc942af4b6?s=256&amp;d=retro" alt="lol"><span class="post-comment-author">lol</span><div class="post-comment-content">it just seems to be the category clickmyexecutableiwonthurt "exploit". unfortunately we can't patch users.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">no user interaction is required!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/67525f265dc56778e9a1088e29fdb0f2?s=256&amp;d=retro" alt="wekrid"><span class="post-comment-author">wekrid</span><div class="post-comment-content">will this hack also work with csg and cags?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Folk, apparently CITRIX has removed the YouTube videos due to some copyright violation. This is strange and the same time not the right way to handle security advisories. Still haven't got any response from them around the issue and I seriously doubt that this will ever happen. However, I am going to keep the POC private for now and give them a chance to react on the in sensible way.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/271ecedbd232e23677ddc1d3956147eb?s=256&amp;d=retro" alt="hackathology"><span class="post-comment-author">hackathology</span><div class="post-comment-content">Is this the same vulnerability found here?

http://support.citrix.com/article/CTX112589</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/33edf67af751e34ebf717b396f15a657?s=256&amp;d=retro" alt="Major Fukup"><span class="post-comment-author">Major Fukup</span><div class="post-comment-content">One of the reasons why you should always give users on these systems minimum rights.
Does it require a published desktop?
Which virtual channels do you use?

Regards M.F.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">hackathology, nope, it is different. you should be able to figure it out though.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/271ecedbd232e23677ddc1d3956147eb?s=256&amp;d=retro" alt="hackathology"><span class="post-comment-author">hackathology</span><div class="post-comment-content">got it pdp. I found it</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/271ecedbd232e23677ddc1d3956147eb?s=256&amp;d=retro" alt="hackathology"><span class="post-comment-author">hackathology</span><div class="post-comment-content">i found out the clue</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/dc5ab7a20f1a46254d0ebfb38b10b24b?s=256&amp;d=retro" alt="Noob"><span class="post-comment-author">Noob</span><div class="post-comment-content">Question:

If the user does not have pass through enabled, but does have stored credentials in the client- (username, password, domain) - will the attack still work?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">Noob I haven't tested that but it should work in theory.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/bbfcc390c96f01104c2587b0d3a1a8b7?s=256&amp;d=retro" alt="Kaustubh Kumar"><span class="post-comment-author">Kaustubh Kumar</span><div class="post-comment-content">Hi All,
I need help in hacking citrix which can allow me to open websites in the citrix metaframe.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/5b1a9d9d8a038edb1efd2f81db4dc06e?s=256&amp;d=retro" alt="DH"><span class="post-comment-author">DH</span><div class="post-comment-content">Here is the fix, nice job PDP :-D

XenApp 4.5
http://support.citrix.com/article/CTX116954</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2022 <a href=""></a>. All rights reserved.</p></footer></body></html>