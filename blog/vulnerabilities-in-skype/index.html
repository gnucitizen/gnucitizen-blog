<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Vulnerabilities in Skype</title><meta name="description" content="Aviv has already done most of the work but I would like to add a few more notes on the recently reported Skype Cross-site Scripting issue. In general, the issue is pretty much underestimated. The vulnerability is not of a type Cross-site Scripting bug, but mostly a Cross-site Scripting bug on DailyMotion, which results into a Cross-zone Scripting issue within Skype due to the unlocked IE controller Skype makes use of. When a given resource executes within the Local Zone context, all sorts of things are possible like, including but not only, reading/writing files from the local disc and launching executables through the WSH primitives. Which in simple words means a complete 0wnage."><meta property="name" content="Vulnerabilities in Skype"><meta itemprop="name" content="Vulnerabilities in Skype"><meta property="description" content="Aviv has already done most of the work but I would like to add a few more notes on the recently reported Skype Cross-site Scripting issue. In general, the issue is pretty much underestimated. The vulnerability is not of a type Cross-site Scripting bug, but mostly a Cross-site Scripting bug on DailyMotion, which results into a Cross-zone Scripting issue within Skype due to the unlocked IE controller Skype makes use of. When a given resource executes within the Local Zone context, all sorts of things are possible like, including but not only, reading/writing files from the local disc and launching executables through the WSH primitives. Which in simple words means a complete 0wnage."><meta itemprop="description" content="Aviv has already done most of the work but I would like to add a few more notes on the recently reported Skype Cross-site Scripting issue. In general, the issue is pretty much underestimated. The vulnerability is not of a type Cross-site Scripting bug, but mostly a Cross-site Scripting bug on DailyMotion, which results into a Cross-zone Scripting issue within Skype due to the unlocked IE controller Skype makes use of. When a given resource executes within the Local Zone context, all sorts of things are possible like, including but not only, reading/writing files from the local disc and launching executables through the WSH primitives. Which in simple words means a complete 0wnage."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fvulnerabilities-in-skype%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fvulnerabilities-in-skype%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/vulnerabilities-in-skype/"><meta property="og:title" content="Vulnerabilities in Skype"><meta property="og:description" content="Aviv has already done most of the work but I would like to add a few more notes on the recently reported Skype Cross-site Scripting issue. In general, the issue is pretty much underestimated. The vulnerability is not of a type Cross-site Scripting bug, but mostly a Cross-site Scripting bug on DailyMotion, which results into a Cross-zone Scripting issue within Skype due to the unlocked IE controller Skype makes use of. When a given resource executes within the Local Zone context, all sorts of things are possible like, including but not only, reading/writing files from the local disc and launching executables through the WSH primitives. Which in simple words means a complete 0wnage."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fvulnerabilities-in-skype%2F?w=1024"><meta name="twitter:title" content="Vulnerabilities in Skype"><meta name="twitter:description" content="Aviv has already done most of the work but I would like to add a few more notes on the recently reported Skype Cross-site Scripting issue. In general, the issue is pretty much underestimated. The vulnerability is not of a type Cross-site Scripting bug, but mostly a Cross-site Scripting bug on DailyMotion, which results into a Cross-zone Scripting issue within Skype due to the unlocked IE controller Skype makes use of. When a given resource executes within the Local Zone context, all sorts of things are possible like, including but not only, reading/writing files from the local disc and launching executables through the WSH primitives. Which in simple words means a complete 0wnage."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fvulnerabilities-in-skype%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Vulnerabilities in Skype</h1><div class="date">Thu, 17 Jan 2008 21:03:04 GMT</div><div class="author">by pdp</div><div id="post-content"><p><a href="http://aviv.raffon.net/2008/01/17/SkypeCrosszoneScriptingVulnerability.aspx">Aviv</a> has already done most of the work but I would like to add a few more notes on the recently reported <a href="http://seclists.org/fulldisclosure/2008/Jan/0328.html">Skype Cross-site Scripting</a> issue. In general, the issue is pretty much underestimated. The vulnerability is not of a type Cross-site Scripting bug, but mostly a Cross-site Scripting bug on <a href="http://dailymotion.com">DailyMotion</a>, which results into a Cross-zone Scripting issue within Skype due to the unlocked IE controller Skype makes use of. When a given resource executes within the Local Zone context, all sorts of things are possible like, including but not only, reading/writing files from the local disc and launching executables through the WSH primitives. Which in simple words means a complete 0wnage.</p>
<p>The attack vector is a bit convoluted, but very much possible and quite practical. The user simply needs to visit DailyMotion via Skype&#39;s <em>Add video to chat</em> button and stumble upon a movie which contains the Cross-site Scripting vector. This type of scenario can be achieved in several ways but I believe that the most obvious approaches would be to either social engineer the user or spam DailyMotion with hundreds of infected movies that correspond to popular keywords. Aviv pointed out Paris Hilton as an example and I believe that this is a pretty good one.</p>
<p>Both, Aviv and I knew about Skype&#39;s Local Zone sandbox for several months now. Yet, this is the first major vulnerability that clearly shows the dangers of Skype&#39;s model. However, there is also another attack vector, which needs to be kept in mind, although it works only in networks where the attacker can influence the communication (mitm attacks, packet injection on wifi networks, network spoofing attacks, etc.).</p>
<p>I noticed that parts of the Skype traffic go over unencrypted channel. After further investigation, I found out that the unencrypted packets are part of Skype&#39;s ads which are pulled on several places, some of which end up within the unrestricted IE controller. With the help of tools like <a href="http://airpwn.sourceforge.net/Airpwn.html">Airpwn</a> or <a href="http://theta44.org/karma/index.html">Karma</a>, attackers can easily hijack ads and replace them with malicious ones. Upon rendering, a malicious code will execute within unrestricted IE controller and as such will allow the bad guys in. This type of attack is very easy to pull and it requires almost zero preparation.</p>
<p><em>The solution: <strong>lock the Local Zone</strong>. I would recommend not to use Skype on any public HotSpots. Also do not use the <strong>Add video to chat</strong> feature until a patch is released. Keep in mind that Skype is not the only one affected by these kinds of issues.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/a37404362c4adcafe2442489c6c6005f?s=256&amp;d=retro" alt="LiquidIce"><span class="post-comment-author">LiquidIce</span><div class="post-comment-content">There are a few devices that I have seen which cause Windows XP to popup a little tooltip in the task tray saying 'a new device has been detected'. And sometiems when I click on that bubble it opens a webpage. 

I have not been able to reproduce this, and have not seen it occur lately... Was it fixed in a windows update? Does this have anything to do with SSDP? I was wondering if it is possible to craft an SSDP packet that will signal other XP computers on the network to show that tooltip. Some of the devices that I have seen do this are the Infrant Readynas and a DLink wifi router. I've also noticed that Sonos causes Windows Media Player to popup a tooltip sometimes as well asking to allow it to share it's media.

Speaking of sonos... this device runs off upnp. Has anyone here been able to do any interesting things with it?</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">LiquidIce, I think that you commented on the wrong post. This one has nothing to do with UPnP. :)</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/26f5ebbf54db3ebe672dab93260ea647?s=256&amp;d=retro" alt="Chaim Haas"><span class="post-comment-author">Chaim Haas</span><div class="post-comment-content">Skype provides a full description of the vulnerability on its <a href="http://share.skype.com/sites/security/2008/01/skype_cross_zone_scripting_vul.html" rel="nofollow">Security Blog</a> and the steps that have been taken to neutralize the problem so it doesn't affect users.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2021 <a href=""></a>. All rights reserved.</p></footer></body></html>