<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Snippets Of Defense Pt.II</title><meta name="description" content="This article is part of a series of posts about small and easy to understand code fragments you can use on your site for protection against certain kinds of attacks. Also this series is targeted to help you understand better what tricks are used by attackers to break into your site and how to avert them. If you have a Snippet of defense yourself and you want to share it, feel free to contact us."><meta property="name" content="Snippets Of Defense Pt.II"><meta itemprop="name" content="Snippets Of Defense Pt.II"><meta property="description" content="This article is part of a series of posts about small and easy to understand code fragments you can use on your site for protection against certain kinds of attacks. Also this series is targeted to help you understand better what tricks are used by attackers to break into your site and how to avert them. If you have a Snippet of defense yourself and you want to share it, feel free to contact us."><meta itemprop="description" content="This article is part of a series of posts about small and easy to understand code fragments you can use on your site for protection against certain kinds of attacks. Also this series is targeted to help you understand better what tricks are used by attackers to break into your site and how to avert them. If you have a Snippet of defense yourself and you want to share it, feel free to contact us."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fsnippets-of-defense-ptii%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fsnippets-of-defense-ptii%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/snippets-of-defense-ptii/"><meta property="og:title" content="Snippets Of Defense Pt.II"><meta property="og:description" content="This article is part of a series of posts about small and easy to understand code fragments you can use on your site for protection against certain kinds of attacks. Also this series is targeted to help you understand better what tricks are used by attackers to break into your site and how to avert them. If you have a Snippet of defense yourself and you want to share it, feel free to contact us."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fsnippets-of-defense-ptii%2F?w=1024"><meta name="twitter:title" content="Snippets Of Defense Pt.II"><meta name="twitter:description" content="This article is part of a series of posts about small and easy to understand code fragments you can use on your site for protection against certain kinds of attacks. Also this series is targeted to help you understand better what tricks are used by attackers to break into your site and how to avert them. If you have a Snippet of defense yourself and you want to share it, feel free to contact us."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fsnippets-of-defense-ptii%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"><h1><a href="/"></a></h1><p></p></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Snippets Of Defense Pt.II</h1><div class="date">Sat, 13 Oct 2007 07:29:41 GMT</div><div class="author">by mario-heiderich</div><div id="post-content"><p>This article is part of a series of posts about small and easy to understand code fragments you can use on your site for protection against certain kinds of attacks. Also this series is targeted to help you understand better what tricks are used by attackers to break into your site and how to avert them. If you have a Snippet of defense yourself and you want to share it, feel free to <a href="http://www.gnucitizen.org/contact">contact us</a>.</p>
<h2 id="the-snippet-reset-window-name">The snippet - reset window.name</h2>
<p>The <a href="http://developer.mozilla.org/en/docs/DOM:window.name">window.name</a> property is often used for complex XSS attacks because you can fill it with payload on one site and read the contents on another site. Sounds weird? It is! Try setting this property on an arbitrary site with Firebug or something similar, navigate to another site and run <code>alert(name)</code> - you should see the exact text you entered. Since you can also evaluate the contents of name an attacker can load kilobytes of payload into this property, redirect and execute it with <code>eval(name)</code> on the victims site - shortest XSS vector ever.</p>
<p>The more sophisticated the attack method is, the easier it it to protect from. In this case, we just need to overwrite <code>window.name</code> in the header of you applications markup like this - don&#39;t forget to encapsulate the code in script tags:</p>
<pre><code class="language-javascript"><span class="built_in">window</span>.name = <span class="literal">false</span>;</code></pre>
<p><em>I hope that you enjoy the trick. Till the next time.</em></p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Sirw2p"><span class="post-comment-author">Sirw2p</span><div class="post-comment-content">Good advice, many applications are still vulnerable for things like that..

Best.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Jim"><span class="post-comment-author">Jim</span><div class="post-comment-content">But even if you do not filter this attack correctly, I believe proper output encoding (HTML Entitly Encoding) will protect against even this kind of attack.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="clinisbut"><span class="post-comment-author">clinisbut</span><div class="post-comment-content">I don't understand at all what's the possible attack... 'cause the alert(name) doesn't outputs anything to me on firefox 2.07

I'm trying to alert( window.name ) too but a empty alert pops up!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="pdp"><span class="post-comment-author">pdp</span><div class="post-comment-content">first of all you need to set it!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="Mario Heiderich"><span class="post-comment-author">Mario Heiderich</span><div class="post-comment-content">You can use Firebug/the JS console to do this. Just navigate to an arbitrary site, use the console and enter window.name = 'alert("hello ")'. Then navigate to another site and open the console again. Enter eval.name and it'll work.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/#{comment.avatar}?s=256&amp;d=retro" alt="clinisbut"><span class="post-comment-author">clinisbut</span><div class="post-comment-content">Ah... I understand, only lefts find a way to execute that eval(window.name) in the other website isn't it?</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2020 <a href=""></a>. All rights reserved.</p></footer></body></html>