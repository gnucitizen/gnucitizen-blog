<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Google and Wildcard Domains</title><meta name="description" content="Basically, Google allows you to use custom domains for your Google for Applications, Blogspot, Mashup Editor and of course App Engine accounts. I think this is an excellent feature and I use it for several of my domains. Although, some of the Google applications ask you to verify the ownership of the domain you are about to use by instructing you to place a special CNAME record on your nameserver, others don't. They simply assume that if a domain points back to them it must have been authorized by the owner and this is exactly the case with Blogspot."><meta property="name" content="Google and Wildcard Domains"><meta itemprop="name" content="Google and Wildcard Domains"><meta property="description" content="Basically, Google allows you to use custom domains for your Google for Applications, Blogspot, Mashup Editor and of course App Engine accounts. I think this is an excellent feature and I use it for several of my domains. Although, some of the Google applications ask you to verify the ownership of the domain you are about to use by instructing you to place a special CNAME record on your nameserver, others don't. They simply assume that if a domain points back to them it must have been authorized by the owner and this is exactly the case with Blogspot."><meta itemprop="description" content="Basically, Google allows you to use custom domains for your Google for Applications, Blogspot, Mashup Editor and of course App Engine accounts. I think this is an excellent feature and I use it for several of my domains. Although, some of the Google applications ask you to verify the ownership of the domain you are about to use by instructing you to place a special CNAME record on your nameserver, others don't. They simply assume that if a domain points back to them it must have been authorized by the owner and this is exactly the case with Blogspot."><meta property="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fgoogle-and-wildcard-domains%2F?w=1024"><meta itemprop="image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fgoogle-and-wildcard-domains%2F?w=1024"><meta property="og:type" content="website"><meta property="og:url" content="https://www.gnucitizen.org/blog/google-and-wildcard-domains/"><meta property="og:title" content="Google and Wildcard Domains"><meta property="og:description" content="Basically, Google allows you to use custom domains for your Google for Applications, Blogspot, Mashup Editor and of course App Engine accounts. I think this is an excellent feature and I use it for several of my domains. Although, some of the Google applications ask you to verify the ownership of the domain you are about to use by instructing you to place a special CNAME record on your nameserver, others don't. They simply assume that if a domain points back to them it must have been authorized by the owner and this is exactly the case with Blogspot."><meta property="og:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fgoogle-and-wildcard-domains%2F?w=1024"><meta name="twitter:title" content="Google and Wildcard Domains"><meta name="twitter:description" content="Basically, Google allows you to use custom domains for your Google for Applications, Blogspot, Mashup Editor and of course App Engine accounts. I think this is an excellent feature and I use it for several of my domains. Although, some of the Google applications ask you to verify the ownership of the domain you are about to use by instructing you to place a special CNAME record on your nameserver, others don't. They simply assume that if a domain points back to them it must have been authorized by the owner and this is exactly the case with Blogspot."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://s.wordpress.com/mshots/v1/https%3A%2F%2Fwww.gnucitizen.org%2Fblog%2Fgoogle-and-wildcard-domains%2F?w=1024"><link type="text/css" href="/blog.css" rel="stylesheet"><script type="text/javascript" src="/blog.js"></script></head><body><header id="header"></header><nav id="topnav"><ul><li><a href="/">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/files">Files</a></li><li><a href="/about.html">About</a></li></ul></nav><article><div id="content"><h1 class="title">Google and Wildcard Domains</h1><div class="date">Mon, 23 Jun 2008 09:38:59 GMT</div><div class="author">by
<a href="/members/pdp.html">pdp</a></div><div id="post-content"><p>Basically, Google allows you to use custom domains for your Google for Applications, Blogspot, Mashup Editor and of course App Engine accounts. I think this is an excellent feature and I use it for several of my domains. Although, some of the Google applications ask you to verify the ownership of the domain you are about to use by instructing you to place a special CNAME record on your nameserver, others don&#39;t. They simply assume that if a domain points back to them it must have been authorized by the owner and this is exactly the case with Blogspot.</p>
<p>This is a very interesting situation and I must say it can be used for some very nasty phishing and defamation attacks, smear campaigns among other things especially today when <a href="/blog/most-attractive-targets-saas/">most of the businesses move to SaaS</a>. It is interesting, because many companies/organizations, from what I can see when doing some basic queries, are using wildcards to point back to Google. The wildcard domain instructs the nameserver to resolve any random domain to whatever details you specify. In case of Google, nameserver admins simply wildcard to <code>ghs.google.com</code>.</p>
<p>This might seam a good decision from administrative point of view but it is a horrible misconfiguration problem if you think about it. The problem is that as soon as you wildcard to Google&#39;s SaaS, you allow attacker to register subdomains under your domain. For example if we have <code>*.acme.com</code> pointing to <code>ghs.google.com</code> attacker will be able to register <code>blog.acme.com</code> and use that to confuse the crap out of everybody.</p>
<p>This is somewhat a big problem people and you better start taking into consideration the entire system (not just the individual components) more seriously.</p>
</div><div id="post-comments"><p><em>Archived Comments</em></p><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/2f6303f9095f59c14c3097ef4df566f5?s=256&amp;d=retro" alt="kuza55"><span class="post-comment-author">kuza55</span><div class="post-comment-content">I'm of the opinion that wildcards are simple a bad idea for security in general, and pointing them at IP addresses you don't control is just plain stupid.

So have you seriously seen an administrator who thinks it's a good idea to let someone control subdomains that are under their DNS?

The ghs.google.com domain doesn't seem to suffer this problem, however if you were to point the wildcard at a working domain then you are also trusting that that domain does not have xss holes.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/3cead94016ef2136edb79c952ddb9f95?s=256&amp;d=retro" alt="NurBo"><span class="post-comment-author">NurBo</span><div class="post-comment-content">This isn't anything knew Ive seen tricks done to get access to a domain gmail account. Such as @whatever.com you just trick your way into verifying and now you have the a email address with somebodys domain you can do alot of things with just a bit of that. And the image is cool in my book.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/aaf6458b296bd09d5f21a8c05b7f13ac?s=256&amp;d=retro" alt="jtyrrell"><span class="post-comment-author">jtyrrell</span><div class="post-comment-content">I haven't used Blogspot, but from the services I've seen, you must first tell Google the value of the CNAME before creating the record.  If you enter a wildcard into that field, it tells you that *'s aren't allowed.

This is so that ghs.google.com can respond to an HTTP query properly according to the Host: header that the client sends.  If an unknown Host is submitted, Google simply sends back a 404 error.

So you're saying this really isn't the case with Blogspot?  Oversight indeed....</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/de37b9dc788b0268d438591e085e4496?s=256&amp;d=retro" alt="sirdarckcat"><span class="post-comment-author">sirdarckcat</span><div class="post-comment-content">jtyrrell is right, http://help.blogger.com/bin/answer.py?answer=55373

I Notes they say:

You can use this feature with domains (e.g. mysite.com) or subdomains (e.g. name.mysite.com). However, you cannot specify subdirectories (e.g. mysite.com/blog/) or wildcards (e.g. *.mysite.com).

Greetz!!</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/b482000b6e3554ee69d69fddea82cf4e?s=256&amp;d=retro" alt="Albert"><span class="post-comment-author">Albert</span><div class="post-comment-content">Pdp means that if *.acme.com points to Blogspot, you can go to Blogspot and occupy blog.acme.com. The wildcard is entered in the DNS, and not at Blogspot.</div></div><div class="post-comment"><img class="post-comment-avatar" src="//gravatar.com/avatar/993d2a833e69225f9119768f4e58e555?s=256&amp;d=retro" alt="jtyrrell"><span class="post-comment-author">jtyrrell</span><div class="post-comment-content">Right, but Google doesn't have to respond to that hostname.  Through HTTP, they could choose to give you a 404 error, as I'm sure they do.</div></div></div></div></article><footer id="footer"><p>Copyright &copy; 2024 <a href=""></a>. All rights reserved.</p></footer></body></html>